<!DOCTYPE html>












  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">






  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">



















  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=6.5.0" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.5.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.5.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.5.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.5.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '6.5.0',
    sidebar: {"position":"left","display":"hide","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="å‰ç«¯ç”Ÿæ¶¯è®°å½•æ€»ç»“">
<meta name="keywords" content="html,css,javascript,webpack,vue,react,nodejs">
<meta property="og:type" content="website">
<meta property="og:title" content="è€æ">
<meta property="og:url" content="https://cleam.github.io/index.html">
<meta property="og:site_name" content="è€æ">
<meta property="og:description" content="å‰ç«¯ç”Ÿæ¶¯è®°å½•æ€»ç»“">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="è€æ">
<meta name="twitter:description" content="å‰ç«¯ç”Ÿæ¶¯è®°å½•æ€»ç»“">



  <link rel="alternate" href="/atom.xml" title="è€æ" type="application/atom+xml">




  <link rel="canonical" href="https://cleam.github.io/">



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>è€æ</title>
  











  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">è€æ</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">~è·¯æ¼«æ¼«å…¶ä¿®è¿œå…®~</p>
      
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home menu-item-active">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>é¦–é¡µ</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>å…³äº</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>æ ‡ç­¾</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>å½’æ¡£</a>

  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://cleam.github.io/2021/12/08/yum-update-Error-initscripts-conflicts-with/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Cleam Lee">
      <meta itemprop="description" content="å‰ç«¯ç”Ÿæ¶¯è®°å½•æ€»ç»“">
      <meta itemprop="image" content="/uploads/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è€æ">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2021/12/08/yum-update-Error-initscripts-conflicts-with/" class="post-title-link" itemprop="https://cleam.github.io/index.html">ä¸€æ¬¡dockerå®¹å™¨å’Œå®¿ä¸»æœºç½‘ç»œä¸é€šé—®é¢˜è®°å½•</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              
                
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-12-08 18:21:11 / ä¿®æ”¹æ—¶é—´ï¼š20:52:30" itemprop="dateCreated datePublished" datetime="2021-12-08T18:21:11+08:00">2021-12-08</time>
            

            
              

              
            
          </span>

          

          
            
              <span class="post-comments-count">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              
                <a href="/2021/12/08/yum-update-Error-initscripts-conflicts-with/#SOHUCS" itemprop="discussionUrl">
                  <span class="post-meta-item-text">è¯„è®ºæ•°ï¼š</span> <span id="url::https://cleam.github.io/2021/12/08/yum-update-Error-initscripts-conflicts-with/" class="cy_cmt_count" data-xid="2021/12/08/yum-update-Error-initscripts-conflicts-with/" itemprop="commentsCount"></span>
                </a>
              
            
          

          
          

          

          

          

        </span></div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>å‡†å¤‡å¾€dockerå®¹å™¨ä¸­æ–°å¢ä¸€ä¸ªæœåŠ¡Zï¼Œä½†æ˜¯æœåŠ¡Zå¯¹dockerä»¥åŠdocker-composeç‰ˆæœ¬è¦æ±‚è¾ƒé«˜ï¼Œæ‰€ä»¥å†³å®šåšä¸€æ¬¡å‡çº§ã€‚</p>
<h2 id="å‡çº§"><a href="#å‡çº§" class="headerlink" title="å‡çº§"></a>å‡çº§</h2><p>ç®€å•çœ‹äº†ä¸‹ç³»ç»Ÿå‚æ•°ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ uname -r</span><br><span class="line"><span class="comment"># 3.10.0-327.22.2.el7.x86_64</span></span><br><span class="line"></span><br><span class="line">$ uname -a </span><br><span class="line"><span class="comment"># Linux 10-42-1-77 3.10.0-327.22.2.el7.x86_64 #1 SMP Thu Jun 23 17:05:11 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux</span></span><br><span class="line"></span><br><span class="line">$ cat /etc/redhat-release</span><br><span class="line"><span class="comment"># CentOS Linux release 7.2.1511 (Core)</span></span><br></pre></td></tr></table></figure>
<p>è²Œä¼¼å¯ä»¥æ”¯æŒå‡çº§dockerã€‚</p>
<p>äºæ˜¯æˆ‘é¦–å…ˆè¿è¡Œäº†<code>yum update</code> æˆ–è€… <code>yum upgrade</code>ï¼ˆå…·ä½“æ˜¯å“ªä¸ªï¼Œæˆ‘ä¸è®°å¾—äº†ã€‚è¿™ä¸­é—´å¯èƒ½æœ‰errorï¼Œå½“æ—¶æ²¡åœ¨æ„ï¼ŒæœŸåˆæˆ‘ä¹Ÿä¸çŸ¥é“updateå’Œupgradeçš„åŒºåˆ«ï¼‰ã€‚</p>
<p><a href="https://cloud.tencent.com/developer/article/1604418" target="_blank" rel="noopener">yum updateå’Œyum upgradeçš„çœŸæ­£åŒºåˆ«</a>ï¼šâ€œyum updateå’Œyum upgradeçš„åŠŸèƒ½éƒ½æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯å°†éœ€è¦æ›´æ–°çš„packageæ›´æ–°åˆ°æºä¸­çš„æœ€æ–°ç‰ˆã€‚å”¯ä¸€ä¸åŒçš„æ˜¯ï¼Œyum upgradeä¼šåˆ é™¤æ—§ç‰ˆæœ¬çš„packageï¼Œè€Œyum updateåˆ™ä¼šä¿ç•™(obsoletes=0)ã€‚ç”Ÿäº§ç¯å¢ƒä¸­å»ºè®®ä½¿ç”¨yum updateï¼Œé˜²æ­¢å› ä¸ºæ›¿æ¢ï¼Œå¯¼è‡´æ—§çš„è½¯ä»¶åŒ…ä¾èµ–å‡ºç°é—®é¢˜ã€‚â€</p>
<p>ç„¶åæŒ‰ç…§<a href="https://docs.docker.com/engine/install/centos/" target="_blank" rel="noopener">dockerå®˜ç½‘æ•™ç¨‹</a>å‡çº§äº†dockeråˆ°ç‰ˆæœ¬ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ docker --version</span><br><span class="line"><span class="comment"># Docker version 20.10.11, build dea9396</span></span><br></pre></td></tr></table></figure>
<p>æŒ‰ç…§<a href="https://docs.docker.com/compose/install/#upgrading" target="_blank" rel="noopener">æ•™ç¨‹</a>å‡çº§äº†docker-composeåˆ°ç‰ˆæœ¬ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ docker-compose --version</span><br><span class="line"><span class="comment"># docker-compose version 1.29.2, build 5becea4c</span></span><br></pre></td></tr></table></figure>
<h2 id="å‡ºç°é—®é¢˜"><a href="#å‡ºç°é—®é¢˜" class="headerlink" title="å‡ºç°é—®é¢˜"></a>å‡ºç°é—®é¢˜</h2><p>ä¸€åˆ‡é¡ºåˆ©ï¼Œå…´é«˜é‡‡çƒˆçš„å»å°†æ‰€æœ‰ä¹‹å‰çš„dockeræœåŠ¡è¿è¡Œèµ·æ¥ï¼Œè¿è¡Œä¹Ÿä¸€åˆ‡æ­£å¸¸ï¼Œæ— ä»»ä½•æŠ¥é”™ã€‚</p>
<p>ä½†æ˜¯ï¼Œå‘ç°æ‰€æœ‰æœåŠ¡è¿ä¸ä¸Šäº†ï¼ˆæˆ‘ç”¨çš„nginxåšåå‘ä»£ç†ï¼Œè½¬å‘è¯·æ±‚é“dockeræœåŠ¡çš„ï¼‰ï¼Œå½“æ—¶å°±å¾ˆçº³é—·ã€‚</p>
<p>äºæ˜¯æ‰¾è¿ç»´å¸®å¿™æ’æŸ¥ï¼Œç»è¿‡ä¸€é˜µå­æŠ˜è…¾ï¼Œå‘ç°docker IPå’Œå®¿ä¸»æœºIPæœ‰å†²çªäº†ï¼Œäºæ˜¯å°±ä¿®æ”¹dockerç½‘æ®µï¼Œæ”¹å®Œä¹‹åç°è±¡å’Œä¹‹å‰ä¸€æ ·ï¼ŒæœåŠ¡èƒ½æ­£å¸¸å¯åŠ¨ï¼Œå°±æ˜¯è¿ä¸ä¸Šã€‚äºæ˜¯ä¸€ä¸ªä¸€ä¸ªæ’æŸ¥ï¼š</p>
<ul>
<li>å…³é—­é˜²ç«å¢™<code>systemctl stop firewalld</code></li>
<li>IPæ²¡æœ‰å†²çª</li>
<li>dockeræœåŠ¡æ­£å¸¸</li>
<li>nginxæœåŠ¡æ­£å¸¸</li>
<li>è·¯ç”±æ­£å¸¸</li>
<li>â€¦</li>
</ul>
<p>æœ€ç»ˆå‘ç°å‡ ä¸ªé—®é¢˜ï¼š</p>
<ul>
<li>å®¿ä¸»æœºæ— æ³•pingé€šå®¹å™¨IP</li>
<li>å®¹å™¨ä¹Ÿæ— æ³•pingé€šå®¿ä¸»æœºIP</li>
<li>å®¹å™¨æ— æ³•pingé€šdocker0ï¼ˆDocker æœåŠ¡é»˜è®¤ä¼šåˆ›å»ºä¸€ä¸ª docker0 ç½‘æ¡¥ï¼ˆå…¶ä¸Šæœ‰ä¸€ä¸ª docker0 å†…éƒ¨æ¥å£ï¼‰ï¼Œå®ƒåœ¨å†…æ ¸å±‚è¿é€šäº†å…¶ä»–çš„ç‰©ç†æˆ–è™šæ‹Ÿç½‘å¡ï¼Œè¿™å°±å°†æ‰€æœ‰å®¹å™¨å’Œæœ¬åœ°ä¸»æœºéƒ½æ”¾åˆ°åŒä¸€ä¸ªç‰©ç†ç½‘ç»œï¼‰</li>
<li>å®¹å™¨å¯ä»¥pingé€šå¦ä¸€ä¸ªå®¹å™¨</li>
</ul>
<h2 id="è§£å†³é—®é¢˜"><a href="#è§£å†³é—®é¢˜" class="headerlink" title="è§£å†³é—®é¢˜"></a>è§£å†³é—®é¢˜</h2><p>ç»è¿‡2å¤©é—®é¢˜çš„æ’æŸ¥ï¼Œç›´åˆ°æ‰¾åˆ°<a href="https://blog.csdn.net/qq_36059826/article/details/106550332" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a>ï¼Œæ¥ç€æ‰¾åˆ°<a href="https://blog.csdn.net/weixin_42288415/article/details/105366176" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a>ã€‚</p>
<p>åº”è¯¥èƒ½å¤Ÿç¡®å®šé—®é¢˜ï¼šdocker åŠ è½½å†…æ ¸çš„bridge.ko é©±åŠ¨å¼‚å¸¸ï¼Œå¯¼è‡´docker0 ç½‘å¡æ— æ³•è½¬å‘æ•°æ®åŒ…ï¼Œä¹Ÿå°±æ˜¯ç³»ç»Ÿå†…æ ¸çš„ç½‘æ¡¥æ¨¡å—bridge.ko åŠ è½½å¤±è´¥å¯¼è‡´çš„ï¼Œä¸€èˆ¬æƒ…å†µä¸‹è¿™ç§åœºæ™¯çš„ç¡®å¾ˆå°‘è§ã€‚</p>
<p>æ ¹æ®ç½‘ä¸Šçš„è¯´æ³•æ˜¯å‡çº§å†…æ ¸è§£å†³ï¼Œäºæ˜¯æˆ‘æ‰“ç®—<a href="https://www.cnblogs.com/xzkzzz/p/9627658.html" target="_blank" rel="noopener">å‡çº§å†…æ ¸</a>ï¼Œè¿è¡Œï¼š<code>yum update</code>ï¼Œå‘ç°errorï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Error: initscripts conflicts with centos-release-7-2.1511.el7.centos.2.10.x86_64</span><br><span class="line"> You could try using --skip-broken to work around the problem</span><br><span class="line"> You could try running: rpm -Va --nofiles --nodigest</span><br></pre></td></tr></table></figure>
<p>äºæ˜¯åˆç½‘ä¸ŠæŸ¥æ‰¾<a href="https://blog.csdn.net/qq_40928073/article/details/84964782" target="_blank" rel="noopener">ç­”æ¡ˆ</a>ï¼Œå‘ç°æ˜¯yumçš„é…ç½®æ–‡ä»¶é‡Œé¢ç¦æ­¢æ›´æ–°å†…æ ¸ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ cat /etc/yum.conf</span><br><span class="line"><span class="comment"># é‡Œé¢æœ‰è¿™ä¹ˆä¸€è¡Œï¼š</span></span><br><span class="line">exclude=centos-release*</span><br></pre></td></tr></table></figure>
<p>äºæ˜¯æˆ‘æ³¨é‡Šæ‰æ’é™¤å‡çº§å†…æ ¸çš„é‚£ä¸€è¡Œï¼Œç»§ç»­æ›´æ–°yumæºä»“åº“<code>yum update</code>å°±æ²¡æœ‰æŠ¥é”™äº†ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">Installed:</span><br><span class="line">  kernel.x86_64 0:3.10.0-1160.49.1.el7</span><br><span class="line"></span><br><span class="line">Dependency Installed:</span><br><span class="line">  bc.x86_64 0:1.06.95-13.el7</span><br><span class="line"></span><br><span class="line">Updated:</span><br><span class="line">  centos-release.x86_64 0:7-9.2009.1.el7.centos              initscripts.x86_64 0:9.49.53-1.el7_9.1</span><br><span class="line"></span><br><span class="line">Complete!</span><br></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥å°±æ˜¯æŒ‰ç…§<a href="https://www.cnblogs.com/xzkzzz/p/9627658.html" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a>ä¸€æ­¥æ­¥æ“ä½œå‡çº§å†…æ ¸ã€‚</p>
<p>å‡çº§å®Œæˆï¼Œé‡å¯ä¹‹åï¼Œå‘ç°yumæŠ¥é”™ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Cannot open logfile /var/<span class="built_in">log</span>/yum.log</span><br><span class="line">...</span><br><span class="line">[Errno 30] Read-only file system: <span class="string">'/var/cache/yum/x86_64/7/runner_gitlab-runner/repomd.xml.old.tmp'</span></span><br></pre></td></tr></table></figure>
<p>è§£å†³æ–¹æ³•<a href="https://qastack.cn/ubuntu/175739/how-do-i-remount-a-filesystem-as-read-write" target="_blank" rel="noopener">å°†æ–‡ä»¶ç³»ç»Ÿé‡æ–°æŒ‚è½½ä¸ºè¯»/å†™</a>ï¼š<code>mount -o remount, rw /</code>ï¼Œæ³¨æ„â€œ,â€å’Œâ€œrwâ€ä¹‹é—´æœ‰ä¸€ä¸ªç©ºæ ¼ã€‚</p>
<h2 id="æœ€ç»ˆç»“æœ"><a href="#æœ€ç»ˆç»“æœ" class="headerlink" title="æœ€ç»ˆç»“æœ"></a>æœ€ç»ˆç»“æœ</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨ alpine é•œåƒåˆ›å»ºä¸€ä¸ªå®¹å™¨ï¼Œå¹¶è¿›å…¥å®¹å™¨</span></span><br><span class="line">docker run -it --name altest alpine sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»å®¹å™¨å†… ping å®¿ä¸»æœºip</span></span><br><span class="line">ping 10.xx.xx.77 -c 3</span><br><span class="line"></span><br><span class="line">PING 10.xx.xx.77 (10.xx.xx.77): 56 data bytes</span><br><span class="line">64 bytes from 10.xx.xx.77: seq=0 ttl=64 time=0.102 ms</span><br><span class="line">64 bytes from 10.xx.xx.77: seq=1 ttl=64 time=0.097 ms</span><br><span class="line">64 bytes from 10.xx.xx.77: seq=2 ttl=64 time=0.119 ms</span><br><span class="line"></span><br><span class="line">--- 10.xx.xx.77 ping statistics ---</span><br><span class="line">3 packets transmitted, 3 packets received, 0% packet loss</span><br><span class="line">round-trip min/avg/max = 0.097/0.106/0.119 ms</span><br><span class="line"></span><br><span class="line"><span class="comment"># docker0 ip</span></span><br><span class="line">ifconfig docker0 | grep inet</span><br><span class="line">        inet 172.17.0.1  netmask 255.255.0.0  broadcast 172.17.255.255</span><br><span class="line"></span><br><span class="line"><span class="comment"># ping docker0 ä¹Ÿæ˜¯okçš„</span></span><br><span class="line">ping 172.117.0.1 -c 1</span><br><span class="line"></span><br><span class="line">PING 172.117.0.1 (172.117.0.1): 56 data bytes</span><br><span class="line">64 bytes from 172.117.0.1: seq=0 ttl=236 time=173.943 ms</span><br><span class="line"></span><br><span class="line">--- 172.117.0.1 ping statistics ---</span><br><span class="line">1 packets transmitted, 1 packets received, 0% packet loss</span><br><span class="line">round-trip min/avg/max = 173.943/173.943/173.943 ms</span><br></pre></td></tr></table></figure>
<p>ç»ˆäºç½‘ç»œé—®é¢˜è§£å†³äº†ğŸ˜„ã€‚</p>
<h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>ä¸ºäº†é¿å…IPå†²çªï¼Œæœ€ååˆé‡æ–°<a href="https://cloud.tencent.com/developer/article/1470937" target="_blank" rel="noopener">å‚è€ƒè¿™é‡Œ</a>ä¿®æ”¹äº†dockerç½‘æ®µã€‚</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  // "default-address-pools": [&#123;</span><br><span class="line">  //    "base": "192.169.0.1/16",</span><br><span class="line">  //    "size": 24</span><br><span class="line">  //  &#125;],</span><br><span class="line">  "bip":"192.168.0.1/24",</span><br><span class="line">  "data-root": "/data/docker",</span><br><span class="line">  "registry-mirrors": ["https://xxxxx.mirror.aliyuncs.com"]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>é—®é¢˜æ˜¯è§£å†³äº†ï¼Œä½†æ˜¯ä½œä¸ºä¸€ä¸ªå‰ç«¯çš„æˆ‘æ¥è¯´ï¼Œè¿˜æ˜¯æœ‰å¤ªå¤šçŸ¥è¯†ç›²åŒºï¼ŒæœŸé—´é‡åˆ°äº†å¤ªå¤šé˜»ç¢ï¼Œä¸è¿‡è§£å†³ä¹‹åå¾ˆè¸å®ï¼Œå¯¹ç½‘ç»œã€å­ç½‘æ©ç æœ‰äº†æ›´æ·±çš„è®¤è¯†ï¼›å¯¹dockerçš„è®¤è¯†ä¹Ÿæ›´åŠ æ·±åˆ»ã€‚</p>
<p>åœ¨æ’æŸ¥é—®é¢˜æœŸé—´å‘ç°äº†ä¸€äº›å¥½é—®é¢˜å¥½æ–‡ç« ï¼š</p>
<ul>
<li><a href="https://stackoverflow.com/questions/50514275/docker-bridge-conflicts-with-host-network/52374482" target="_blank" rel="noopener">Docker Bridge Conflicts with Host Network</a></li>
<li><a href="https://serverfault.com/questions/916941/configuring-docker-to-not-use-the-172-17-0-0-range/942176" target="_blank" rel="noopener">Configuring Docker to not use the 172.17.0.0 range</a></li>
<li><a href="https://www.cnblogs.com/xiao987334176/p/10049844.html" target="_blank" rel="noopener">Dockerå®¹å™¨è·¨ä¸»æœºé€šä¿¡ä¹‹ï¼šç›´æ¥è·¯ç”±æ–¹å¼</a></li>
<li><a href="https://yeasy.gitbook.io/docker_practice/advanced_network/docker0" target="_blank" rel="noopener">é…ç½® docker0 ç½‘æ¡¥</a></li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://cleam.github.io/2021/12/08/Linuxå‘½ä»¤ä½¿ç”¨è®°å½•/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Cleam Lee">
      <meta itemprop="description" content="å‰ç«¯ç”Ÿæ¶¯è®°å½•æ€»ç»“">
      <meta itemprop="image" content="/uploads/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è€æ">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2021/12/08/Linuxå‘½ä»¤ä½¿ç”¨è®°å½•/" class="post-title-link" itemprop="https://cleam.github.io/index.html">Linuxå‘½ä»¤ä½¿ç”¨è®°å½•</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              
                
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-12-08 11:33:46 / ä¿®æ”¹æ—¶é—´ï¼š11:34:04" itemprop="dateCreated datePublished" datetime="2021-12-08T11:33:46+08:00">2021-12-08</time>
            

            
              

              
            
          </span>

          

          
            
              <span class="post-comments-count">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              
                <a href="/2021/12/08/Linuxå‘½ä»¤ä½¿ç”¨è®°å½•/#SOHUCS" itemprop="discussionUrl">
                  <span class="post-meta-item-text">è¯„è®ºæ•°ï¼š</span> <span id="url::https://cleam.github.io/2021/12/08/Linuxå‘½ä»¤ä½¿ç”¨è®°å½•/" class="cy_cmt_count" data-xid="2021/12/08/Linuxå‘½ä»¤ä½¿ç”¨è®°å½•/" itemprop="commentsCount"></span>
                </a>
              
            
          

          
          

          

          

          

        </span></div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="journalctl"><a href="#journalctl" class="headerlink" title="journalctl"></a>journalctl</h2>
          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://cleam.github.io/2021/12/06/docker-install-update/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Cleam Lee">
      <meta itemprop="description" content="å‰ç«¯ç”Ÿæ¶¯è®°å½•æ€»ç»“">
      <meta itemprop="image" content="/uploads/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è€æ">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2021/12/06/docker-install-update/" class="post-title-link" itemprop="https://cleam.github.io/index.html">centosä¸‹çš„dockerå®‰è£…ä¸å‡çº§</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              
                
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-12-06 10:00:58 / ä¿®æ”¹æ—¶é—´ï¼š10:39:47" itemprop="dateCreated datePublished" datetime="2021-12-06T10:00:58+08:00">2021-12-06</time>
            

            
              

              
            
          </span>

          

          
            
              <span class="post-comments-count">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              
                <a href="/2021/12/06/docker-install-update/#SOHUCS" itemprop="discussionUrl">
                  <span class="post-meta-item-text">è¯„è®ºæ•°ï¼š</span> <span id="url::https://cleam.github.io/2021/12/06/docker-install-update/" class="cy_cmt_count" data-xid="2021/12/06/docker-install-update/" itemprop="commentsCount"></span>
                </a>
              
            
          

          
          

          

          

          

        </span></div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="å‰ææ¡ä»¶"><a href="#å‰ææ¡ä»¶" class="headerlink" title="å‰ææ¡ä»¶"></a>å‰ææ¡ä»¶</h2><ol>
<li>æ“ä½œç³»ç»Ÿè¦æ±‚ï¼š<code>centos &gt;= 7</code></li>
<li>å¸è½½æ—§ç‰ˆæœ¬ï¼š</li>
</ol>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo yum remove docker \</span><br><span class="line">                  docker-client \</span><br><span class="line">                  docker-client-latest \</span><br><span class="line">                  docker-common \</span><br><span class="line">                  docker-latest \</span><br><span class="line">                  docker-latest-logrotate \</span><br><span class="line">                  docker-logrotate \</span><br><span class="line">                  docker-engine</span><br></pre></td></tr></table></figure>
<h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>å®‰è£…æœ‰å¤šç§æ–¹å¼ï¼Œæˆ‘ä»¬é‡‡ç”¨å­˜å‚¨åº“ï¼ˆrepositoryï¼‰æ–¹å¼è¿›è¡Œå®‰è£…ï¼ˆæ–¹ä¾¿æ—¥åè¿›è¡Œæ›´æ–°å‡çº§ï¼‰ï¼Œè¿™ä¹Ÿæ˜¯å®˜æ–¹æ¨èçš„å®‰è£…æ–¹å¼ã€‚</p>
<h3 id="é…ç½®å®‰è£…æº"><a href="#é…ç½®å®‰è£…æº" class="headerlink" title="é…ç½®å®‰è£…æº"></a>é…ç½®å®‰è£…æº</h3><p>åœ¨å®‰è£…ä¹‹å‰ï¼Œéœ€è¦å…ˆé…ç½®å®‰è£…æºï¼š</p>
<ul>
<li>å®˜æ–¹ï¼š<a href="https://download.docker.com/linux/centos/docker-ce.repo" target="_blank" rel="noopener">https://download.docker.com/linux/centos/docker-ce.repo</a></li>
<li>é˜¿é‡Œäº‘ï¼š<a href="http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo" target="_blank" rel="noopener">http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</a></li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install -y yum-utils</span><br><span class="line"></span><br><span class="line">sudo yum-config-manager \</span><br><span class="line">    --add-repo \</span><br><span class="line">    http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br></pre></td></tr></table></figure>
<h3 id="æ­£å¼å®‰è£…"><a href="#æ­£å¼å®‰è£…" class="headerlink" title="æ­£å¼å®‰è£…"></a>æ­£å¼å®‰è£…</h3><ol>
<li>å¦‚æœå¯¹ç‰ˆæœ¬æ²¡è¦æ±‚ï¼Œç›´æ¥å®‰è£…latestç‰ˆæœ¬ï¼š</li>
</ol>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install docker-ce docker-ce-cli containerd.io</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>å¦‚æœéœ€è¦å®‰è£…æŒ‡å®šç‰ˆæœ¬ï¼Œå…ˆåˆ—å‡ºå¯ç”¨ç‰ˆæœ¬ï¼Œç„¶åå†é€‰æ‹©å®‰è£…ï¼š</li>
</ol>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">yum list docker-ce --showduplicates | sort -r</span><br><span class="line"></span><br><span class="line"><span class="comment"># docker-ce.x86_64            3:20.10.9-3.el7                    docker-ce-stable</span></span><br><span class="line"><span class="comment"># docker-ce.x86_64            3:20.10.8-3.el7                    docker-ce-stable</span></span><br><span class="line"><span class="comment"># docker-ce.x86_64            3:20.10.7-3.el7                    docker-ce-stable</span></span><br><span class="line"><span class="comment"># ...</span></span><br></pre></td></tr></table></figure>
<p>æŒ‡å®šç‰ˆæœ¬å®‰è£…</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install docker-ce-&lt;VERSION_STRING&gt; docker-ce-cli-&lt;VERSION_STRING&gt; containerd.io</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>å¯åŠ¨docker</li>
</ol>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl start docker</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>é€šè¿‡è¿è¡Œä¸€ä¸ª<code>hello-world</code>é•œåƒæ¥æ ¡éªŒdockeræ˜¯å¦å®‰è£…æ­£ç¡®</li>
</ol>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo docker run hello-world</span><br></pre></td></tr></table></figure>
<h2 id="å‡çº§docker"><a href="#å‡çº§docker" class="headerlink" title="å‡çº§docker"></a>å‡çº§docker</h2><p>å‡çº§å’Œå®‰è£…æ˜¯ä¸€æ ·çš„æ­¥éª¤ï¼Œåªæ˜¯é€‰æ‹©ä¸åŒçš„ç‰ˆæœ¬è¿›è¡Œå®‰è£…ï¼Œè¯·å…ˆæ‰§è¡Œ<a href="#å‰ææ¡ä»¶">å‰ææ¡ä»¶</a>ã€‚</p>
<h2 id="å…³äºdockeré•œåƒåŠ é€Ÿ"><a href="#å…³äºdockeré•œåƒåŠ é€Ÿ" class="headerlink" title="å…³äºdockeré•œåƒåŠ é€Ÿ"></a>å…³äºdockeré•œåƒåŠ é€Ÿ</h2><p>ç‚¹å‡»æŸ¥çœ‹ï¼š<a href="https://help.aliyun.com/document_detail/60750.html" target="_blank" rel="noopener">é˜¿é‡Œäº‘å®˜æ–¹é•œåƒåŠ é€Ÿ</a></p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://docs.docker.com/engine/install/centos/" target="_blank" rel="noopener">å®˜æ–¹è‹±æ–‡åŸæ–‡</a></p>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://cleam.github.io/2021/10/15/bashå‘½ä»¤å­¦ä¹ ä¹‹sed-awk/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Cleam Lee">
      <meta itemprop="description" content="å‰ç«¯ç”Ÿæ¶¯è®°å½•æ€»ç»“">
      <meta itemprop="image" content="/uploads/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è€æ">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2021/10/15/bashå‘½ä»¤å­¦ä¹ ä¹‹sed-awk/" class="post-title-link" itemprop="https://cleam.github.io/index.html">bashå‘½ä»¤å­¦ä¹ ä¹‹sed/awk</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              
                
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-10-15 15:44:39 / ä¿®æ”¹æ—¶é—´ï¼š19:56:22" itemprop="dateCreated datePublished" datetime="2021-10-15T15:44:39+08:00">2021-10-15</time>
            

            
              

              
            
          </span>

          

          
            
              <span class="post-comments-count">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              
                <a href="/2021/10/15/bashå‘½ä»¤å­¦ä¹ ä¹‹sed-awk/#SOHUCS" itemprop="discussionUrl">
                  <span class="post-meta-item-text">è¯„è®ºæ•°ï¼š</span> <span id="url::https://cleam.github.io/2021/10/15/bashå‘½ä»¤å­¦ä¹ ä¹‹sed-awk/" class="cy_cmt_count" data-xid="2021/10/15/bashå‘½ä»¤å­¦ä¹ ä¹‹sed-awk/" itemprop="commentsCount"></span>
                </a>
              
            
          

          
          

          

          

          

        </span></div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="sed"><a href="#sed" class="headerlink" title="sed"></a>sed</h2><blockquote>
<p>TODO</p>
</blockquote>
<h2 id="awk"><a href="#awk" class="headerlink" title="awk"></a>awk</h2><blockquote>
<p>TODO</p>
</blockquote>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://cleam.github.io/2021/10/15/shellå¸¸ç”¨æ“ä½œæ•´ç†/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Cleam Lee">
      <meta itemprop="description" content="å‰ç«¯ç”Ÿæ¶¯è®°å½•æ€»ç»“">
      <meta itemprop="image" content="/uploads/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è€æ">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2021/10/15/shellå¸¸ç”¨æ“ä½œæ•´ç†/" class="post-title-link" itemprop="https://cleam.github.io/index.html">shellå¸¸ç”¨æ“ä½œæ•´ç†</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              
                
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-10-15 15:21:38 / ä¿®æ”¹æ—¶é—´ï¼š18:12:39" itemprop="dateCreated datePublished" datetime="2021-10-15T15:21:38+08:00">2021-10-15</time>
            

            
              

              
            
          </span>

          

          
            
              <span class="post-comments-count">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              
                <a href="/2021/10/15/shellå¸¸ç”¨æ“ä½œæ•´ç†/#SOHUCS" itemprop="discussionUrl">
                  <span class="post-meta-item-text">è¯„è®ºæ•°ï¼š</span> <span id="url::https://cleam.github.io/2021/10/15/shellå¸¸ç”¨æ“ä½œæ•´ç†/" class="cy_cmt_count" data-xid="2021/10/15/shellå¸¸ç”¨æ“ä½œæ•´ç†/" itemprop="commentsCount"></span>
                </a>
              
            
          

          
          

          

          

          

        </span></div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="shell-ä¸­ç»™å˜é‡è®¾ç½®é»˜è®¤å€¼"><a href="#shell-ä¸­ç»™å˜é‡è®¾ç½®é»˜è®¤å€¼" class="headerlink" title="shell ä¸­ç»™å˜é‡è®¾ç½®é»˜è®¤å€¼"></a>shell ä¸­ç»™å˜é‡è®¾ç½®é»˜è®¤å€¼</h2><p>æ­£å¸¸æ“ä½œï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> [ ! <span class="variable">$1</span> ]; <span class="keyword">then</span></span><br><span class="line">  VAR=<span class="string">'default'</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<p>ä¼˜é›…ç®€æ´æ“ä½œï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å½“å˜é‡aä¸ºnullæ—¶åˆ™var=b</span></span><br><span class="line">var=<span class="variable">$&#123;a-b&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å½“å˜é‡aä¸ºnullæˆ–ä¸ºç©ºå­—ç¬¦ä¸²æ—¶åˆ™var=b</span></span><br><span class="line">var=<span class="variable">$&#123;a:-b&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å½“å‚æ•°1æœªä¼ æˆ–ä¼ äº†ç©ºå­—ç¬¦ä¸²æ—¶åˆ™å˜é‡VARä¸ºé»˜è®¤å€¼ default</span></span><br><span class="line">VAR=<span class="variable">$&#123;1:-default&#125;</span></span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://cleam.github.io/2021/10/15/gitå¸¸ç”¨å‘½ä»¤æ•´ç†/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Cleam Lee">
      <meta itemprop="description" content="å‰ç«¯ç”Ÿæ¶¯è®°å½•æ€»ç»“">
      <meta itemprop="image" content="/uploads/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è€æ">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2021/10/15/gitå¸¸ç”¨å‘½ä»¤æ•´ç†/" class="post-title-link" itemprop="https://cleam.github.io/index.html">gitå¸¸ç”¨æ“ä½œæ•´ç†</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              
                
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-10-15 11:35:05 / ä¿®æ”¹æ—¶é—´ï¼š11:49:18" itemprop="dateCreated datePublished" datetime="2021-10-15T11:35:05+08:00">2021-10-15</time>
            

            
              

              
            
          </span>

          

          
            
              <span class="post-comments-count">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              
                <a href="/2021/10/15/gitå¸¸ç”¨å‘½ä»¤æ•´ç†/#SOHUCS" itemprop="discussionUrl">
                  <span class="post-meta-item-text">è¯„è®ºæ•°ï¼š</span> <span id="url::https://cleam.github.io/2021/10/15/gitå¸¸ç”¨å‘½ä»¤æ•´ç†/" class="cy_cmt_count" data-xid="2021/10/15/gitå¸¸ç”¨å‘½ä»¤æ•´ç†/" itemprop="commentsCount"></span>
                </a>
              
            
          

          
          

          

          

          

        </span></div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="ä»è¿œç¨‹ä»“åº“å…‹éš†æŒ‡å®š-tag-ä»£ç "><a href="#ä»è¿œç¨‹ä»“åº“å…‹éš†æŒ‡å®š-tag-ä»£ç " class="headerlink" title="ä»è¿œç¨‹ä»“åº“å…‹éš†æŒ‡å®š tag ä»£ç "></a>ä»è¿œç¨‹ä»“åº“å…‹éš†æŒ‡å®š tag ä»£ç </h2><p><strong>å¸¸è§„æ“ä½œ</strong>ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä»è¿œç¨‹å…‹éš†</span></span><br><span class="line">$ git <span class="built_in">clone</span> &lt;repository&gt; .</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ‡æ¢åˆ°æŒ‡å®štag</span></span><br><span class="line">$ git checkout tags/&lt;tagname&gt;</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼Œè¿™å°†ä½¿å­˜å‚¨åº“å¤„äºâ€œåˆ†ç¦»å¤´â€çŠ¶æ€ã€‚è¿™æ„å‘³ç€åœ¨æ­¤çŠ¶æ€ä¸‹æ‰€åšçš„ä»»ä½•æäº¤éƒ½ä¸ä¼šå½±å“ä»»ä½•åˆ†æ”¯ã€‚å¦‚æœéœ€è¦ï¼Œå¯ä»¥ä½¿ç”¨-b é€‰é¡¹åˆ›å»ºæ–°åˆ†æ”¯ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ‡æ¢åˆ°æŒ‡å®štagå¹¶æ–°å»ºåˆ†æ”¯</span></span><br><span class="line">$ git checkout tags/&lt;tagname&gt; -b &lt;branchname&gt;</span><br></pre></td></tr></table></figure>
<p><strong>å¿«æ·æ“ä½œ</strong>ï¼šå…‹éš†çš„æ—¶å€™æ·»åŠ <code>-b</code>å‚æ•°æŒ‡å®š tag å³å¯ã€‚</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">clone</span> -b &lt;tagname&gt; &lt;repository&gt; .</span><br></pre></td></tr></table></figure>
<p>ä½†æœ‰æ—¶å€™é¡¹ç›®è¿‡å¤§ï¼Œæˆ‘ä»¬ä¸ºäº†é¿å…æ‹‰å–ï¼ˆfetchï¼‰æ‰€æœ‰åˆ†æ”¯åˆ°æœ¬åœ°ï¼ŒåŠ ä¸Šå‚æ•°ï¼š<code>â€“-single-branch</code>ï¼Œåªæ‹‰å–å½“å‰åˆ†æ”¯ä»£ç ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">clone</span> -b &lt;tagname&gt; â€“single-branch &lt;repository&gt; .</span><br></pre></td></tr></table></figure>
<p>å¦‚æœæˆ‘ä»¬åªéœ€è¦æœ€å 1 æ¡è®°å½•çš„è¯ï¼Œå¯ä»¥ä½¿æ‹‰å–ï¼ˆfetchï¼‰çš„æ•°æ®é‡æ›´å°ï¼ŒåŠ å‚æ•°ï¼š<code>--depth 1</code>ï¼ˆè¯¥å‚æ•°é»˜è®¤å°±æ˜¯<code>â€“-single-branch</code>ï¼‰</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">clone</span> -b &lt;tagname&gt; â€“depth 1 &lt;repository&gt; .</span><br></pre></td></tr></table></figure>
<blockquote>
<p>å‚è€ƒï¼š<a href="https://www.techiedelight.com/clone-specific-tag-with-git/" target="_blank" rel="noopener">Clone a specific tag with Git</a></p>
</blockquote>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://cleam.github.io/2021/10/14/WebæŒ‡æ ‡å­¦ä¹ ï¼ˆabout-Sentryï¼‰/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Cleam Lee">
      <meta itemprop="description" content="å‰ç«¯ç”Ÿæ¶¯è®°å½•æ€»ç»“">
      <meta itemprop="image" content="/uploads/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è€æ">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2021/10/14/WebæŒ‡æ ‡å­¦ä¹ ï¼ˆabout-Sentryï¼‰/" class="post-title-link" itemprop="https://cleam.github.io/index.html">Web æŒ‡æ ‡å­¦ä¹ ï¼ˆabout Sentryï¼‰</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              
                
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-10-14 10:47:08 / ä¿®æ”¹æ—¶é—´ï¼š10:55:44" itemprop="dateCreated datePublished" datetime="2021-10-14T10:47:08+08:00">2021-10-14</time>
            

            
              

              
            
          </span>

          

          
            
              <span class="post-comments-count">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              
                <a href="/2021/10/14/WebæŒ‡æ ‡å­¦ä¹ ï¼ˆabout-Sentryï¼‰/#SOHUCS" itemprop="discussionUrl">
                  <span class="post-meta-item-text">è¯„è®ºæ•°ï¼š</span> <span id="url::https://cleam.github.io/2021/10/14/WebæŒ‡æ ‡å­¦ä¹ ï¼ˆabout-Sentryï¼‰/" class="cy_cmt_count" data-xid="2021/10/14/WebæŒ‡æ ‡å­¦ä¹ ï¼ˆabout-Sentryï¼‰/" itemprop="commentsCount"></span>
                </a>
              
            
          

          
          

          

          

          

        </span></div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="https://web.dev/vitals/" target="_blank" rel="noopener">Web æŒ‡æ ‡</a>æ˜¯ä¸€ç»„ç”± Google å®šä¹‰çš„æŒ‡æ ‡ï¼Œç”¨äºè¡¡é‡å‘ˆç°æ—¶é—´ã€å“åº”æ—¶é—´å’Œå¸ƒå±€åç§»ã€‚æ¯ä¸ªæ•°æ®ç‚¹éƒ½æä¾›æœ‰å…³åº”ç”¨ç¨‹åºæ•´ä½“æ€§èƒ½çš„è§è§£ã€‚</p>
<p>Sentry SDK æ”¶é›† Web æŒ‡æ ‡ä¿¡æ¯ï¼ˆå¦‚æœæµè§ˆå™¨æ”¯æŒçš„è¯ï¼‰å¹¶å°†è¯¥ä¿¡æ¯æ·»åŠ åˆ°å‰ç«¯äº‹åŠ¡ä¸­ã€‚ç„¶åå°†è¿™äº›é‡è¦ä¿¡æ¯æ±‡æ€»åœ¨å‡ ä¸ªå›¾è¡¨ä¸­ï¼Œä»¥ä¾¿å¿«é€Ÿäº†è§£æ¯ä¸ªå‰ç«¯äº‹åŠ¡å¯¹ç”¨æˆ·çš„æ‰§è¡Œæƒ…å†µã€‚</p>
<p><img src="/uploads/post/web-vitals-1.png" alt="Web Vitals çš„å¯è§†åŒ–"></p>
<h2 id="æ ¸å¿ƒ-Web-æŒ‡æ ‡"><a href="#æ ¸å¿ƒ-Web-æŒ‡æ ‡" class="headerlink" title="æ ¸å¿ƒ Web æŒ‡æ ‡"></a>æ ¸å¿ƒ Web æŒ‡æ ‡</h2><p>è¿™äº› Web æŒ‡æ ‡è¢«è°·æ­Œè®¤ä¸ºæ˜¯ç›´æ¥è¡¡é‡ç”¨æˆ·ä½“éªŒçš„æœ€é‡è¦çš„æŒ‡æ ‡ã€‚<a href="https://developers.google.com/search/blog/2020/11/timing-for-page-experience" target="_blank" rel="noopener">Google æŠ¥å‘Šç§°ï¼Œæˆªè‡³ 2021 å¹´ 5 æœˆï¼Œè¿™äº›æŒ‡æ ‡ä¹Ÿä¼šå½±å“ç½‘ç«™çš„æœç´¢æ’å</a>ã€‚</p>
<h3 id="æœ€å¤§çš„å†…å®¹ç»˜åˆ¶-LCP"><a href="#æœ€å¤§çš„å†…å®¹ç»˜åˆ¶-LCP" class="headerlink" title="æœ€å¤§çš„å†…å®¹ç»˜åˆ¶ (LCP)"></a>æœ€å¤§çš„å†…å®¹ç»˜åˆ¶ (LCP)</h3><p><a href="https://web.dev/lcp/" target="_blank" rel="noopener">æœ€å¤§å†…å®¹ç»˜åˆ¶ (LCP)</a>æµ‹é‡æœ€å¤§å†…å®¹å‡ºç°åœ¨è§†å£ä¸­çš„æ¸²æŸ“æ—¶é—´ã€‚è¿™å¯ä»¥æ˜¯æ¥è‡ªæ–‡æ¡£å¯¹è±¡æ¨¡å‹ (DOM) çš„ä»»ä½•å½¢å¼ï¼Œä¾‹å¦‚å›¾åƒï¼ˆimagesï¼‰ã€SVG æˆ–æ–‡æœ¬å—ï¼ˆtext blocksï¼‰ã€‚è§†å£ä¸­æœ€å¤§çš„åƒç´ åŒºåŸŸï¼Œå› æ­¤æœ€ç›´è§‚ã€‚<strong>LCP å¸®åŠ©å¼€å‘äººå‘˜äº†è§£ç”¨æˆ·çœ‹åˆ°é¡µé¢ä¸Šçš„ä¸»è¦å†…å®¹éœ€è¦å¤šé•¿æ—¶é—´ã€‚</strong></p>
<h3 id="é¦–æ¬¡è¾“å…¥å»¶è¿Ÿ-FID"><a href="#é¦–æ¬¡è¾“å…¥å»¶è¿Ÿ-FID" class="headerlink" title="é¦–æ¬¡è¾“å…¥å»¶è¿Ÿ (FID)"></a>é¦–æ¬¡è¾“å…¥å»¶è¿Ÿ (FID)</h3><p><a href="https://web.dev/fid/" target="_blank" rel="noopener">é¦–æ¬¡è¾“å…¥å»¶è¿Ÿ (FID)</a>æµ‹é‡ç”¨æˆ·å°è¯•ä¸è§†å£äº¤äº’æ—¶çš„å“åº”æ—¶é—´ã€‚æ“ä½œå¯èƒ½åŒ…æ‹¬å•å‡»æŒ‰é’®ï¼ˆbuttonï¼‰ã€é“¾æ¥ï¼ˆlinkï¼‰æˆ–å…¶ä»–è‡ªå®šä¹‰ Javascript æ§åˆ¶å™¨ã€‚<strong>FID æä¾›æœ‰å…³åº”ç”¨ç¨‹åºé¡µé¢ä¸ŠæˆåŠŸæˆ–ä¸æˆåŠŸäº¤äº’çš„å…³é”®æ•°æ®ã€‚</strong></p>
<h3 id="ç´¯ç§¯å¸ƒå±€åç§»-CLS"><a href="#ç´¯ç§¯å¸ƒå±€åç§»-CLS" class="headerlink" title="ç´¯ç§¯å¸ƒå±€åç§» (CLS)"></a>ç´¯ç§¯å¸ƒå±€åç§» (CLS)</h3><p><a href="https://web.dev/cls/" target="_blank" rel="noopener">ç´¯ç§¯å¸ƒå±€åç§» (CLS)</a>æ˜¯æ¸²æŸ“è¿‡ç¨‹ä¸­æ¯ä¸ªæ„å¤–å…ƒç´ åç§»çš„å•ä¸ªå¸ƒå±€åç§»åˆ†æ•°çš„æ€»å’Œã€‚æƒ³è±¡ä¸€ä¸‹å¯¼èˆªåˆ°ä¸€ç¯‡æ–‡ç« å¹¶å°è¯•åœ¨é¡µé¢å®ŒæˆåŠ è½½ä¹‹å‰å•å‡»é“¾æ¥ã€‚åœ¨æ‚¨çš„å…‰æ ‡åˆ°è¾¾é‚£é‡Œä¹‹å‰ï¼Œé“¾æ¥å¯èƒ½ç”±äºå›¾åƒæ¸²æŸ“è€Œå‘ä¸‹ç§»åŠ¨ã€‚<strong>CLS åˆ†æ•°ä»£è¡¨äº†ç ´åæ€§å’Œè§†è§‰ä¸ç¨³å®šè½¬å˜çš„ç¨‹åº¦ï¼Œè€Œä¸æ˜¯ä½¿ç”¨æŒç»­æ—¶é—´æ¥è¡¨ç¤ºæ­¤ Web æŒ‡æ ‡ã€‚</strong></p>
<p><img src="/uploads/post/web-vitals-2.png" alt="ç´¯ç§¯å¸ƒå±€åç§»ç¤ºä¾‹"></p>
<p>ä½¿ç”¨å½±å“å’Œè·ç¦»åˆ†æ•°è®¡ç®—æ¯ä¸ªå¸ƒå±€åç§»åˆ†æ•°ã€‚å½±å“åˆ†æ•°æ˜¯å…ƒç´ åœ¨ä¸¤ä¸ªæ¸²æŸ“å¸§ä¹‹é—´å½±å“çš„æ€»å¯è§åŒºåŸŸã€‚è·ç¦»åˆ†æ•°æµ‹é‡å®ƒç›¸å¯¹äºè§†å£ç§»åŠ¨çš„è·ç¦»ã€‚</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Layout Shift Score = Impact Fraction * Distance Fraction</span></span><br><span class="line">å¸ƒå±€åç§»åˆ†æ•° = å½±å“åˆ†æ•° * è·ç¦»åˆ†æ•°</span><br></pre></td></tr></table></figure>
<p>è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ä¸Šé¢çš„ä¾‹å­ï¼Œå®ƒæœ‰ä¸€ä¸ªä¸ç¨³å®šçš„å…ƒç´ â€”â€”æ­£æ–‡å†…å®¹ã€‚å½±å“åˆ†æ•°å¤§çº¦ä¸ºé¡µé¢çš„ <code>50%</code>ï¼Œå¹¶å°†æ­£æ–‡æ–‡æœ¬å‘ä¸‹ç§»åŠ¨ <code>20%</code>ã€‚å¸ƒå±€ç§»ä½å¾—åˆ†ä¸º <code>0.5 * 0.2 = 0.1</code>ã€‚å› æ­¤ï¼ŒCLS ä¸º 0.1ã€‚</p>
<h2 id="å…¶ä»–-Web-æŒ‡æ ‡"><a href="#å…¶ä»–-Web-æŒ‡æ ‡" class="headerlink" title="å…¶ä»– Web æŒ‡æ ‡"></a>å…¶ä»– Web æŒ‡æ ‡</h2><p>è¿™äº› Web æŒ‡æ ‡é€šå¸¸ä¸å¤ªå®¹æ˜“è¢«ç”¨æˆ·çœ‹åˆ°ï¼Œä½†å¯¹äºæ’é™¤æ ¸å¿ƒ Web æŒ‡æ ‡çš„é—®é¢˜å¾ˆæœ‰ç”¨ã€‚</p>
<h3 id="é¦–æ¬¡æ¸²æŸ“ï¼ˆFPï¼‰"><a href="#é¦–æ¬¡æ¸²æŸ“ï¼ˆFPï¼‰" class="headerlink" title="é¦–æ¬¡æ¸²æŸ“ï¼ˆFPï¼‰"></a>é¦–æ¬¡æ¸²æŸ“ï¼ˆFPï¼‰</h3><p>é¦–æ¬¡æ¸²æŸ“ (FP) æµ‹é‡ç¬¬ä¸€ä¸ªåƒç´ å‡ºç°åœ¨è§†å£ä¸­æ‰€éœ€çš„æ—¶é—´ï¼Œå‘ˆç°ä¸å…ˆå‰æ˜¾ç¤ºå†…å®¹ç›¸æ¯”çš„ä»»ä½•è§†è§‰å˜åŒ–ã€‚è¿™å¯ä»¥æ˜¯æ¥è‡ªæ–‡æ¡£å¯¹è±¡æ¨¡å‹ (DOM) çš„ä»»ä½•å½¢å¼ï¼Œä¾‹å¦‚èƒŒæ™¯é¢œè‰²ï¼ˆbackground-colorï¼‰ã€ç”»å¸ƒï¼ˆcanvasï¼‰æˆ–å›¾åƒï¼ˆimageï¼‰ã€‚<strong>FP å¯å¸®åŠ©å¼€å‘äººå‘˜äº†è§£æ¸²æŸ“é¡µé¢æ˜¯å¦å‘ç”Ÿäº†ä»»ä½•æ„å¤–ã€‚</strong></p>
<h3 id="é¦–æ¬¡å†…å®¹ç»˜åˆ¶-FCP"><a href="#é¦–æ¬¡å†…å®¹ç»˜åˆ¶-FCP" class="headerlink" title="é¦–æ¬¡å†…å®¹ç»˜åˆ¶ (FCP)"></a>é¦–æ¬¡å†…å®¹ç»˜åˆ¶ (FCP)</h3><p><a href="https://web.dev/fcp/" target="_blank" rel="noopener">é¦–æ¬¡å†…å®¹ç»˜åˆ¶ (FCP)</a>æµ‹é‡ç¬¬ä¸€ä¸ªå†…å®¹åœ¨è§†å£ä¸­å‘ˆç°çš„æ—¶é—´ã€‚è¿™å¯ä»¥æ˜¯æ¥è‡ªæ–‡æ¡£å¯¹è±¡æ¨¡å‹ (DOM) çš„ä»»ä½•å½¢å¼ï¼Œä¾‹å¦‚å›¾åƒã€SVG æˆ–æ–‡æœ¬å—ã€‚<strong>FCP ç»å¸¸ä¸é¦–æ¬¡æ¸²æŸ“ï¼ˆFPï¼‰é‡å ã€‚FCP å¸®åŠ©å¼€å‘äººå‘˜äº†è§£ç”¨æˆ·åœ¨é¡µé¢ä¸Šçœ‹åˆ°å†…å®¹æ›´æ–°éœ€è¦å¤šé•¿æ—¶é—´ã€‚</strong></p>
<h3 id="é¦–å­—èŠ‚æ—¶é—´-TTFB"><a href="#é¦–å­—èŠ‚æ—¶é—´-TTFB" class="headerlink" title="é¦–å­—èŠ‚æ—¶é—´ (TTFB)"></a>é¦–å­—èŠ‚æ—¶é—´ (TTFB)</h3><p>é¦–å­—èŠ‚æ—¶é—´ï¼ˆTTFBï¼‰æµ‹é‡ç”¨æˆ·æµè§ˆå™¨æ¥æ”¶é¡µé¢å†…å®¹çš„ç¬¬ä¸€ä¸ªå­—èŠ‚æ‰€éœ€çš„æ—¶é—´ã€‚<strong>TTFB å¸®åŠ©å¼€å‘äººå‘˜äº†è§£ä»–ä»¬çš„ç¼“æ…¢æ˜¯ç”±åˆå§‹å“åº”å¼•èµ·çš„è¿˜æ˜¯ç”±äºæ¸²æŸ“é˜»å¡å†…å®¹å¼•èµ·çš„ã€‚</strong></p>
<h2 id="é˜ˆå€¼"><a href="#é˜ˆå€¼" class="headerlink" title="é˜ˆå€¼"></a>é˜ˆå€¼</h2><p>è°·æ­Œå®šä¹‰çš„ä¸‰ä¸ªé˜ˆå€¼ï¼šâ€œ<code>å¥½ï¼ˆGOODï¼‰</code>â€ã€â€œ<code>éœ€è¦æ”¹è¿›ï¼ˆNEEDS IMPROVEMENTï¼‰</code>â€å’Œâ€œ<code>å·®ï¼ˆPOORï¼‰</code>â€ç”¨äºå°†æ•°æ®ç‚¹åˆ†ç±»ä¸ºç»¿è‰²ã€é»„è‰²å’Œçº¢è‰²ï¼Œç”¨äºå¯¹åº”çš„ Web æŒ‡æ ‡ã€‚â€œéœ€è¦æ”¹è¿›ï¼ˆNEEDS IMPROVEMENTï¼‰â€åœ¨ Sentry ä¸­è¢«ç§°ä¸ºâ€œ<code>Meh</code>â€ã€‚</p>
<table>
<thead>
<tr>
<th>Web æŒ‡æ ‡</th>
<th>å¥½</th>
<th>éœ€è¦æ”¹è¿›</th>
<th>å·®</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://docs.sentry.io/product/performance/web-vitals/#largest-contentful-paint-lcp" target="_blank" rel="noopener">æœ€å¤§çš„å†…å®¹ç»˜åˆ¶</a>(LCP)</td>
<td>&lt;= 2.5s</td>
<td>&lt;= 4s</td>
<td>&gt; 4s</td>
</tr>
<tr>
<td><a href="https://docs.sentry.io/product/performance/web-vitals/#first-input-delay-fid" target="_blank" rel="noopener">é¦–æ¬¡è¾“å…¥å»¶è¿Ÿ</a>(FID)</td>
<td>&lt;= 100ms</td>
<td>&lt;= 300ms</td>
<td>&gt; 300ms</td>
</tr>
<tr>
<td><a href="https://docs.sentry.io/product/performance/web-vitals/#cumulative-layout-shift-cls" target="_blank" rel="noopener">ç´¯ç§¯å¸ƒå±€åç§»</a>(CLS)</td>
<td>&lt;= 0.1</td>
<td>&lt;= 0.25</td>
<td>&gt; 0.25</td>
</tr>
<tr>
<td><a href="https://docs.sentry.io/product/performance/web-vitals/#first-paint-fp" target="_blank" rel="noopener">é¦–æ¬¡æ¸²æŸ“</a>(FP)</td>
<td>&lt;= 1s</td>
<td>&lt;= 3s</td>
<td>&gt; 3s</td>
</tr>
<tr>
<td><a href="https://docs.sentry.io/product/performance/web-vitals/#first-contentful-paint-fcp" target="_blank" rel="noopener">é¦–æ¬¡å†…å®¹ç»˜åˆ¶</a>(FCP)</td>
<td>&lt;= 1s</td>
<td>&lt;= 3s</td>
<td>&gt; 3s</td>
</tr>
<tr>
<td><a href="https://docs.sentry.io/product/performance/web-vitals/#time-to-first-byte-ttfb" target="_blank" rel="noopener">é¦–å­—èŠ‚æ—¶é—´</a>(TTFB)</td>
<td>&lt;= 100ms</td>
<td>&lt;= 200ms</td>
<td>&gt; 600ms</td>
</tr>
</tbody>
</table>
<blockquote>
<p>ä¸€äº› Web æŒ‡æ ‡ï¼ˆä¾‹å¦‚ FPã€FCPã€LCP å’Œ TTFBï¼‰æ˜¯ç›¸å¯¹äºäº‹åŠ¡çš„å¼€å§‹è¿›è¡Œæµ‹é‡çš„ã€‚ä¸ä½¿ç”¨å…¶ä»–å·¥å…·ï¼ˆä¾‹å¦‚ Lighthouse ï¼‰ç”Ÿæˆçš„å€¼ç›¸æ¯”ï¼Œå€¼å¯èƒ½ä¼šæœ‰æ‰€ä¸åŒã€‚</p>
</blockquote>
<h2 id="åˆ†å¸ƒç›´æ–¹å›¾"><a href="#åˆ†å¸ƒç›´æ–¹å›¾" class="headerlink" title="åˆ†å¸ƒç›´æ–¹å›¾"></a>åˆ†å¸ƒç›´æ–¹å›¾</h2><p><img src="/uploads/post/web-vitals-3.png" alt="åˆ†å¸ƒç›´æ–¹å›¾"></p>
<p>Web æŒ‡æ ‡ç›´æ–¹å›¾æ˜¾ç¤ºæ•°æ®åˆ†å¸ƒï¼Œå®ƒå¯ä»¥é€šè¿‡æ­ç¤ºå¼‚å¸¸æ¥å¸®åŠ©æ‚¨è¯†åˆ«å’Œè¯Šæ–­å‰ç«¯æ€§èƒ½é—®é¢˜ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå¼‚å¸¸å€¼å°†ä»ç›´æ–¹å›¾ä¸­æ’é™¤ï¼Œä»¥æä¾›æœ‰å…³è¿™äº›ç”Ÿå‘½ä½“å¾çš„æ›´å¤šä¿¡æ¯è§†å›¾ã€‚å¼‚å¸¸å€¼æ˜¯ä½¿ç”¨<a href="https://en.wikipedia.org/wiki/Outlier#Tukey&#39;s_fences" target="_blank" rel="noopener">ä¸Šå¤–æ …æ ï¼ˆupper outer fenceï¼‰</a>ä½œä¸ºä¸Šé™æ¥ç¡®å®šçš„ï¼Œä»»ä½•é«˜äºä¸Šé™çš„æ•°æ®ç‚¹éƒ½è¢«è§†ä¸ºå¼‚å¸¸å€¼ã€‚</p>
<p>æ¯ä¸ª Web æŒ‡æ ‡çš„å‚ç›´æ ‡è®°æ˜¯è§‚å¯Ÿåˆ°çš„æ•°æ®ç‚¹çš„ç¬¬ 75 ä¸ªç™¾åˆ†ä½ã€‚æ¢å¥è¯è¯´ï¼Œ25% çš„è®°å½•å€¼è¶…è¿‡äº†è¯¥æ•°é‡ã€‚</p>
<p>å¦‚æœæ‚¨æ³¨æ„åˆ°ä»»ä½•ç›´æ–¹å›¾ä¸Šçš„æ„Ÿå…´è¶£åŒºåŸŸï¼Œè¯·å•å‡»å¹¶æ‹–åŠ¨æ”¾å¤§è¯¥åŒºåŸŸä»¥è·å¾—æ›´è¯¦ç»†çš„è§†å›¾ã€‚æ‚¨å¯èƒ½è¿˜æƒ³åœ¨ç›´æ–¹å›¾ä¸­æŸ¥çœ‹ä¸äº‹åŠ¡ç›¸å…³çš„æ›´å¤šä¿¡æ¯ã€‚å•å‡»æ‰€é€‰ Web æŒ‡æ ‡ä¸‹æ–¹çš„â€œåœ¨å‘ç°ä¸­æ‰“å¼€ï¼ˆOpen in Discoverï¼‰â€ä»¥æ„å»ºè‡ªå®šä¹‰æŸ¥è¯¢ä»¥è¿›è¡Œè¿›ä¸€æ­¥è°ƒæŸ¥ã€‚æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… <a href="https://docs.sentry.io/product/discover-queries/query-builder/" target="_blank" rel="noopener">Discover Query Builder</a> çš„å®Œæ•´æ–‡æ¡£ã€‚</p>
<p>å¦‚æœæ‚¨å¸Œæœ›æŸ¥çœ‹æ‰€æœ‰å¯ç”¨æ•°æ®ï¼Œè¯·æ‰“å¼€ä¸‹æ‹‰èœå•å¹¶å•å‡»â€œæŸ¥çœ‹å…¨éƒ¨ï¼ˆView Allï¼‰â€ã€‚å•å‡»â€œæŸ¥çœ‹å…¨éƒ¨â€æ—¶ï¼Œæ‚¨å¯èƒ½ä¼šçœ‹åˆ°æç«¯å¼‚å¸¸å€¼ã€‚æ‚¨å¯ä»¥å•å‡»å¹¶æ‹–åŠ¨æ”¾å¤§æŸä¸ªåŒºåŸŸä»¥è·å¾—æ›´è¯¦ç»†çš„è§†å›¾ã€‚</p>
<h2 id="æµè§ˆå™¨æ”¯æŒ"><a href="#æµè§ˆå™¨æ”¯æŒ" class="headerlink" title="æµè§ˆå™¨æ”¯æŒ"></a>æµè§ˆå™¨æ”¯æŒ</h2><table>
<thead>
<tr>
<th>Web æŒ‡æ ‡</th>
<th>Chrome</th>
<th>Edge</th>
<th>Opera</th>
<th>Firefox</th>
<th>Safari</th>
<th>IE</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://docs.sentry.io/product/performance/web-vitals/#largest-contentful-paint-lcp" target="_blank" rel="noopener">æœ€å¤§çš„å†…å®¹ç»˜åˆ¶</a>(LCP)</td>
<td>âœ“</td>
<td>âœ“</td>
<td>âœ“</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="https://docs.sentry.io/product/performance/web-vitals/#first-input-delay-fid" target="_blank" rel="noopener">é¦–æ¬¡è¾“å…¥å»¶è¿Ÿ</a>(FID)</td>
<td>âœ“</td>
<td>âœ“</td>
<td>âœ“</td>
<td>âœ“</td>
<td>âœ“</td>
<td>âœ“</td>
</tr>
<tr>
<td><a href="https://docs.sentry.io/product/performance/web-vitals/#cumulative-layout-shift-cls" target="_blank" rel="noopener">ç´¯ç§¯å¸ƒå±€åç§»</a>(CLS)</td>
<td>âœ“</td>
<td>âœ“</td>
<td>âœ“</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="https://docs.sentry.io/product/performance/web-vitals/#first-paint-fp" target="_blank" rel="noopener">é¦–æ¬¡æ¸²æŸ“</a>(FP)</td>
<td>âœ“</td>
<td>âœ“</td>
<td>âœ“</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="https://docs.sentry.io/product/performance/web-vitals/#first-contentful-paint-fcp" target="_blank" rel="noopener">é¦–æ¬¡å†…å®¹ç»˜åˆ¶</a>(FCP)</td>
<td>âœ“</td>
<td>âœ“</td>
<td>âœ“</td>
<td>âœ“</td>
<td>âœ“</td>
<td></td>
</tr>
<tr>
<td><a href="https://docs.sentry.io/product/performance/web-vitals/#time-to-first-byte-ttfb" target="_blank" rel="noopener">é¦–å­—èŠ‚æ—¶é—´</a>(TTFB)</td>
<td>âœ“</td>
<td>âœ“</td>
<td>âœ“</td>
<td>âœ“</td>
<td>âœ“</td>
<td>âœ“</td>
</tr>
</tbody>
</table>
<blockquote>
<p>åŸæ–‡ï¼š<a href="https://docs.sentry.io/product/performance/web-vitals/" target="_blank" rel="noopener">Web Vitals</a></p>
</blockquote>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://cleam.github.io/2021/10/09/sonarè´¨é‡è§„åˆ™å­¦ä¹ ä¹‹JavaScript/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Cleam Lee">
      <meta itemprop="description" content="å‰ç«¯ç”Ÿæ¶¯è®°å½•æ€»ç»“">
      <meta itemprop="image" content="/uploads/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è€æ">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2021/10/09/sonarè´¨é‡è§„åˆ™å­¦ä¹ ä¹‹JavaScript/" class="post-title-link" itemprop="https://cleam.github.io/index.html">sonarè´¨é‡è§„åˆ™å­¦ä¹ ä¹‹JavaScript</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              
                
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-10-09 18:11:10 / ä¿®æ”¹æ—¶é—´ï¼š18:41:45" itemprop="dateCreated datePublished" datetime="2021-10-09T18:11:10+08:00">2021-10-09</time>
            

            
              

              
            
          </span>

          

          
            
              <span class="post-comments-count">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              
                <a href="/2021/10/09/sonarè´¨é‡è§„åˆ™å­¦ä¹ ä¹‹JavaScript/#SOHUCS" itemprop="discussionUrl">
                  <span class="post-meta-item-text">è¯„è®ºæ•°ï¼š</span> <span id="url::https://cleam.github.io/2021/10/09/sonarè´¨é‡è§„åˆ™å­¦ä¹ ä¹‹JavaScript/" class="cy_cmt_count" data-xid="2021/10/09/sonarè´¨é‡è§„åˆ™å­¦ä¹ ä¹‹JavaScript/" itemprop="commentsCount"></span>
                </a>
              
            
          

          
          

          

          

          

        </span></div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>è¯¥æ–‡æ¡£åˆ—å‡ºäº†æ¯”è¾ƒå®¹æ˜“è¿åã€æ¯”è¾ƒé‡è¦çš„å‡ ä¸ªè§„åˆ™ï¼Œæ›´å¤šè§„åˆ™è¯·æŸ¥çœ‹ï¼š<a href="https://rules.sonarsource.com/javascript" target="_blank" rel="noopener">sonar rules for js</a></p>
<h2 id="ä»£ç æ®µä¸åº”è¢«æ³¨é‡Šæ‰ï¼ˆSections-of-code-should-not-be-commented-outï¼‰"><a href="#ä»£ç æ®µä¸åº”è¢«æ³¨é‡Šæ‰ï¼ˆSections-of-code-should-not-be-commented-outï¼‰" class="headerlink" title="ä»£ç æ®µä¸åº”è¢«æ³¨é‡Šæ‰ï¼ˆSections of code should not be commented outï¼‰"></a>ä»£ç æ®µä¸åº”è¢«æ³¨é‡Šæ‰ï¼ˆ<a href="https://rules.sonarsource.com/javascript/RSPEC-125" target="_blank" rel="noopener">Sections of code should not be commented out</a>ï¼‰</h2><p>ç¨‹åºå‘˜ä¸åº”æ³¨é‡Šæ‰ä»£ç ï¼Œå› ä¸ºå®ƒä¼šä½¿ç¨‹åºè†¨èƒ€å¹¶é™ä½å¯è¯»æ€§ã€‚æœªä½¿ç”¨çš„ä»£ç åº”è¯¥è¢«åˆ é™¤ï¼Œå¦‚æœéœ€è¦ï¼Œå¯ä»¥ä»æºä»£ç æ§åˆ¶å†å²ï¼ˆå¦‚ï¼šGit Historyï¼‰ä¸­æ£€ç´¢ã€‚</p>
<p>æœ‰äº›æƒ…å†µå¯èƒ½ä¼šè¯¯æŠ¥ã€ä¸åˆç†æŠ¥é”™æˆ–è€…æœ¬æ¥å°±æ˜¯æœ‰ç”¨çš„æ³¨é‡Šï¼Œå¯ä»¥è¯•è¯•ä½¿ç”¨<code>//NOSONAR</code>æ¥è§„é¿ï¼š</p>
<p><img src="/uploads/post/js.png" alt="js with sonar warn"></p>
<p>åŠ ä¸Š<code>//NOSONAR</code>ï¼Œsonaræ‰«æä¾¿ä¼šå¿½ç•¥æ‰ï¼Œå°±ä¸ä¼šå†æœ‰è­¦å‘Šï¼š</p>
<p><img src="/uploads/post/js-nosonar.png" alt="js with NOSONAR"></p>
<h2 id="åŠŸèƒ½å‡½æ•°è®¤çŸ¥å¤æ‚åº¦ï¼ˆåœˆå¤æ‚åº¦ï¼‰ä¸åº”å¤ªé«˜ï¼ˆCognitive-Complexity-of-functions-should-not-be-too-highï¼‰"><a href="#åŠŸèƒ½å‡½æ•°è®¤çŸ¥å¤æ‚åº¦ï¼ˆåœˆå¤æ‚åº¦ï¼‰ä¸åº”å¤ªé«˜ï¼ˆCognitive-Complexity-of-functions-should-not-be-too-highï¼‰" class="headerlink" title="åŠŸèƒ½å‡½æ•°è®¤çŸ¥å¤æ‚åº¦ï¼ˆåœˆå¤æ‚åº¦ï¼‰ä¸åº”å¤ªé«˜ï¼ˆCognitive Complexity of functions should not be too highï¼‰"></a>åŠŸèƒ½å‡½æ•°è®¤çŸ¥å¤æ‚åº¦ï¼ˆåœˆå¤æ‚åº¦ï¼‰ä¸åº”å¤ªé«˜ï¼ˆ<a href="https://rules.sonarsource.com/javascript/RSPEC-3776" target="_blank" rel="noopener">Cognitive Complexity of functions should not be too high</a>ï¼‰</h2><p>è®¤çŸ¥å¤æ‚æ€§æ˜¯è¡¡é‡å‡½æ•°æ§åˆ¶æµç†è§£éš¾åº¦çš„æŒ‡æ ‡ã€‚è®¤çŸ¥å¤æ‚åº¦é«˜çš„åŠŸèƒ½å°†éš¾ä»¥ç»´æŠ¤ã€‚è¯¦æƒ…è¯·çœ‹ã€Š<a href="/2021/09/23/cognitive-complexity/" title="è®¤çŸ¥å¤æ‚åº¦ï¼ˆcognitive complexity ï¼‰">è®¤çŸ¥å¤æ‚åº¦ï¼ˆcognitive complexity ï¼‰</a>ã€‹</p>
<h2 id="å˜é‡ä¸åº”è¯¥è¢«éšè—ï¼ˆVariables-should-not-be-shadowedï¼‰"><a href="#å˜é‡ä¸åº”è¯¥è¢«éšè—ï¼ˆVariables-should-not-be-shadowedï¼‰" class="headerlink" title="å˜é‡ä¸åº”è¯¥è¢«éšè—ï¼ˆVariables should not be shadowedï¼‰"></a>å˜é‡ä¸åº”è¯¥è¢«éšè—ï¼ˆ<a href="https://rules.sonarsource.com/javascript/RSPEC-1117" target="_blank" rel="noopener">Variables should not be shadowed</a>ï¼‰</h2><p>é‡å†™æˆ–éšè—åœ¨å¤–éƒ¨ä½œç”¨åŸŸä¸­å£°æ˜çš„å˜é‡ä¼šä¸¥é‡å½±å“ä»£ç çš„å¯è¯»æ€§ï¼Œä»è€Œå½±å“ä»£ç çš„å¯ç»´æŠ¤æ€§ã€‚æ­¤å¤–ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´ç»´æŠ¤äººå‘˜å¼•å…¥ bugï¼Œå› ä¸ºä»–ä»¬è®¤ä¸ºè‡ªå·±åœ¨ä½¿ç”¨æŸä¸€ä¸ªå˜é‡ï¼Œä½†å®é™…ä¸Šåœ¨ä½¿ç”¨å¦ä¸€ä¸ªå˜é‡ã€‚</p>
<h2 id="ä¸‰å…ƒè¿ç®—ç¬¦ä¸åº”è¯¥åµŒå¥—ï¼ˆTernary-operators-should-not-be-nestedï¼‰"><a href="#ä¸‰å…ƒè¿ç®—ç¬¦ä¸åº”è¯¥åµŒå¥—ï¼ˆTernary-operators-should-not-be-nestedï¼‰" class="headerlink" title="ä¸‰å…ƒè¿ç®—ç¬¦ä¸åº”è¯¥åµŒå¥—ï¼ˆTernary operators should not be nestedï¼‰"></a>ä¸‰å…ƒè¿ç®—ç¬¦ä¸åº”è¯¥åµŒå¥—ï¼ˆ<a href="https://rules.sonarsource.com/javascript/RSPEC-3358" target="_blank" rel="noopener">Ternary operators should not be nested</a>ï¼‰</h2><p>ä¸‰å…ƒè¿ç®—ç¬¦åµŒå¥—è™½ç„¶å¯ä»¥è§£å†³é—®é¢˜ï¼Œåˆšå¼€å§‹ç¼–å†™çš„æ—¶å€™çœ‹èµ·æ¥å¯èƒ½å¾ˆæ¸…æ™°ï¼Œä½†æ˜¯éšç€æ—¶é—´å»¶é•¿ä¼šå¢åŠ åæœŸçš„ç»´æŠ¤éš¾åº¦ã€‚</p>
<p>åä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getReadableStatus</span>(<span class="params">job</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> job.isRunning() ? <span class="string">'Running'</span> : job.hasErrors() ? <span class="string">'Failed'</span> : <span class="string">'Succeeded '</span>; <span class="comment">// Noncompliant</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ­£ä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getReadableStatus</span>(<span class="params">job</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (job.isRunning()) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'Running'</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> job.hasErrors() ? <span class="string">'Failed'</span> : <span class="string">'Succeeded'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="åº”åˆ é™¤æœªä½¿ç”¨çš„åˆ†é…ï¼ˆå˜é‡ï¼‰ï¼ˆUnused-assignments-should-be-removedï¼‰"><a href="#åº”åˆ é™¤æœªä½¿ç”¨çš„åˆ†é…ï¼ˆå˜é‡ï¼‰ï¼ˆUnused-assignments-should-be-removedï¼‰" class="headerlink" title="åº”åˆ é™¤æœªä½¿ç”¨çš„åˆ†é…ï¼ˆå˜é‡ï¼‰ï¼ˆUnused assignments should be removedï¼‰"></a>åº”åˆ é™¤æœªä½¿ç”¨çš„åˆ†é…ï¼ˆå˜é‡ï¼‰ï¼ˆ<a href="https://rules.sonarsource.com/javascript/RSPEC-1854" target="_blank" rel="noopener">Unused assignments should be removed</a>ï¼‰</h2><p>å®šä¹‰äº†ä¸€ä¸ªå˜é‡å¹¶å¯¹å…¶è¿›è¡Œäº†èµ‹å€¼æ“ä½œï¼Œä½†å®é™…ä¸Šå´æœªä½¿ç”¨ã€‚å¯èƒ½æ˜¯é”™è¯¯æ“ä½œå¯¼è‡´ï¼ˆæ¯”å¦‚ä»£ç åˆ é”™ï¼‰ï¼Œä¹Ÿå¯èƒ½æ˜¯å¤±è¯¯å¤šå†™äº†ã€‚ä½†æ€»å½’æ˜¯æ— ç”¨çš„ï¼Œå¯ä»¥åˆ é™¤æ‰ã€‚</p>
<p>åä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">i = a + b; <span class="comment">// Noncompliant; calculation result not used before value is overwritten</span></span><br><span class="line">i = compute();</span><br></pre></td></tr></table></figure>
<p>æ­£ä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">i = a + b;</span><br><span class="line">i += compute();</span><br></pre></td></tr></table></figure>
<p>ä¾‹å¤–æƒ…å†µ:</p>
<ul>
<li>åˆå§‹åŒ–å€¼ä¸º<code>-1, 0, 1, null, undefined, [], {}, true, false, &quot;&quot;</code>çš„ä¼šè¢«è¯¥è§„åˆ™å¿½ç•¥</li>
<li>æ­¤è§„åˆ™è¿˜å¿½ç•¥ä½¿ç”¨ rest è¯­æ³•ï¼ˆç”¨äºä»å¯¹è±¡ä¸­æ’é™¤æŸäº›å±æ€§ï¼‰è¿›è¡Œå¯¹è±¡åˆ†è§£æ—¶å£°æ˜çš„å˜é‡</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> &#123; a, b, ...rest &#125; = obj; <span class="comment">// 'a' and 'b' are ok</span></span><br><span class="line">doSomething(rest);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> [x1, x2, x3] = arr; <span class="comment">// but 'x1' is noncompliant, as omitting syntax can be used: "let [, x2, x3] = arr;"</span></span><br><span class="line">doSomething(x2, x3);</span><br></pre></td></tr></table></figure>
<h2 id="â€œfor-ofâ€åº”è¯¥ä¸å¯è¿­ä»£å¯¹è±¡ä¸€èµ·ä½¿ç”¨ï¼ˆâ€œfor-ofâ€-should-be-used-with-Iterablesï¼‰"><a href="#â€œfor-ofâ€åº”è¯¥ä¸å¯è¿­ä»£å¯¹è±¡ä¸€èµ·ä½¿ç”¨ï¼ˆâ€œfor-ofâ€-should-be-used-with-Iterablesï¼‰" class="headerlink" title="â€œfor ofâ€åº”è¯¥ä¸å¯è¿­ä»£å¯¹è±¡ä¸€èµ·ä½¿ç”¨ï¼ˆâ€œfor ofâ€ should be used with Iterablesï¼‰"></a>â€œfor ofâ€åº”è¯¥ä¸å¯è¿­ä»£å¯¹è±¡ä¸€èµ·ä½¿ç”¨ï¼ˆ<a href="https://rules.sonarsource.com/javascript/RSPEC-4138" target="_blank" rel="noopener">â€œfor ofâ€ should be used with Iterables</a>ï¼‰</h2><p>å¦‚æœæ‚¨æœ‰ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ï¼Œä¾‹å¦‚æ•°ç»„ã€é›†åˆæˆ–åˆ—è¡¨ï¼Œåˆ™å¾ªç¯éå†å…¶å€¼çš„æœ€ä½³é€‰æ‹©æ˜¯ for of è¯­æ³•ã€‚ è¿™å¯ä»¥ä½¿ä»£ç çœ‹èµ·æ¥æ›´å¹²å‡€ã€æ¸…æ™°ã€‚</p>
<p>åä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">  <span class="comment">// Noncompliant</span></span><br><span class="line">  <span class="built_in">console</span>.log(arr[i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ­£ä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> value <span class="keyword">of</span> arr) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="åº”åˆ é™¤æœªä½¿ç”¨çš„å±€éƒ¨å˜é‡æˆ–å‡½æ•°ï¼ˆUnused-local-variables-and-functions-should-be-removedï¼‰"><a href="#åº”åˆ é™¤æœªä½¿ç”¨çš„å±€éƒ¨å˜é‡æˆ–å‡½æ•°ï¼ˆUnused-local-variables-and-functions-should-be-removedï¼‰" class="headerlink" title="åº”åˆ é™¤æœªä½¿ç”¨çš„å±€éƒ¨å˜é‡æˆ–å‡½æ•°ï¼ˆUnused local variables and functions should be removedï¼‰"></a>åº”åˆ é™¤æœªä½¿ç”¨çš„å±€éƒ¨å˜é‡æˆ–å‡½æ•°ï¼ˆ<a href="https://rules.sonarsource.com/javascript/RSPEC-1481" target="_blank" rel="noopener">Unused local variables and functions should be removed</a>ï¼‰</h2><p>å¦‚æœå£°æ˜äº†å±€éƒ¨å˜é‡æˆ–å±€éƒ¨å‡½æ•°ä½†æœªä½¿ç”¨ï¼Œåˆ™å®ƒæ˜¯æ­»ä»£ç ï¼Œåº”åˆ é™¤ã€‚ è¿™æ ·åšå°†æé«˜å¯ç»´æŠ¤æ€§ï¼Œå› ä¸ºå¼€å‘äººå‘˜ä¸ä¼šæƒ³çŸ¥é“å˜é‡æˆ–å‡½æ•°çš„ç”¨é€”ã€‚</p>
<p>åä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">numberOfMinutes</span>(<span class="params">hours</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> seconds = <span class="number">0</span>; <span class="comment">// seconds is never used</span></span><br><span class="line">  <span class="keyword">return</span> hours * <span class="number">60</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ­£ä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">numberOfMinutes</span>(<span class="params">hours</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> hours * <span class="number">60</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="å‡½æ•°ä¸åº”æœ‰ç›¸åŒçš„å®ç°ï¼ˆFunctions-should-not-have-identical-implementationsï¼‰"><a href="#å‡½æ•°ä¸åº”æœ‰ç›¸åŒçš„å®ç°ï¼ˆFunctions-should-not-have-identical-implementationsï¼‰" class="headerlink" title="å‡½æ•°ä¸åº”æœ‰ç›¸åŒçš„å®ç°ï¼ˆFunctions should not have identical implementationsï¼‰"></a>å‡½æ•°ä¸åº”æœ‰ç›¸åŒçš„å®ç°ï¼ˆ<a href="https://rules.sonarsource.com/javascript/RSPEC-4144" target="_blank" rel="noopener">Functions should not have identical implementations</a>ï¼‰</h2><p>å½“ä¸¤ä¸ªå‡½æ•°å…·æœ‰ç›¸åŒçš„å®ç°æ—¶ï¼Œè¦ä¹ˆæ˜¯ä¸€ä¸ªé”™è¯¯ï¼ˆæœ‰å…¶ä»–ç”¨é€”ï¼‰ï¼Œè¦ä¹ˆé‡å¤æ˜¯æ•…æ„çš„ï¼Œä½†å¯èƒ½ä¼šä½¿ç»´æŠ¤è€…æ„Ÿåˆ°å›°æƒ‘ã€‚ åœ¨åä¸€ç§æƒ…å†µä¸‹ï¼Œåº”è¯¥é‡æ„ä»£ç ã€‚</p>
<p>åä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">calculateCode</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  doTheThing();</span><br><span class="line">  doOtherThing();</span><br><span class="line">  <span class="keyword">return</span> code;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getName</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// Noncompliant</span></span><br><span class="line">  doTheThing();</span><br><span class="line">  doOtherThing();</span><br><span class="line">  <span class="keyword">return</span> code;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ­£ä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">calculateCode</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  doTheThing();</span><br><span class="line">  doOtherThing();</span><br><span class="line">  <span class="keyword">return</span> code;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getName</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> calculateCode();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ä¸åº”æœ‰ç©ºå‡½æ•°ï¼ˆFunctions-should-not-be-emptyï¼‰"><a href="#ä¸åº”æœ‰ç©ºå‡½æ•°ï¼ˆFunctions-should-not-be-emptyï¼‰" class="headerlink" title="ä¸åº”æœ‰ç©ºå‡½æ•°ï¼ˆFunctions should not be emptyï¼‰"></a>ä¸åº”æœ‰ç©ºå‡½æ•°ï¼ˆ<a href="https://rules.sonarsource.com/javascript/RSPEC-1186" target="_blank" rel="noopener">Functions should not be empty</a>ï¼‰</h2><p>å‡½æ•°æ²¡æœ‰å‡½æ•°ä½“æœ‰å‡ ä¸ªåŸå› ï¼š</p>
<ul>
<li>è¿™æ˜¯ä¸€ä¸ªæ— æ„çš„é—æ¼ï¼Œåº”è¯¥ä¿®å¤ä»¥é˜²æ­¢ç”Ÿäº§ä¸­å‡ºç°æ„å¤–è¡Œä¸ºã€‚</li>
<li>å®ƒå°šæœªæˆ–æ°¸è¿œä¸ä¼šå¾—åˆ°æ”¯æŒã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåº”è¯¥åœ¨è¯¥æœºåˆ¶å¯ç”¨çš„è¯­è¨€ä¸­æŠ›å‡ºå¼‚å¸¸ã€‚</li>
<li>è¯¥æ–¹æ³•æ˜¯ä¸€ä¸ªæœ‰æ„çš„ç©ºç™½è¦†ç›–ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒåµŒå¥—æ³¨é‡Šåº”è§£é‡Šç©ºç™½è¦†ç›–çš„åŸå› ã€‚</li>
</ul>
<p>åä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> foo = <span class="function"><span class="params">()</span> =&gt;</span> &#123;&#125;;</span><br></pre></td></tr></table></figure>
<p>æ­£ä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// This is intentional</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> foo = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  do_something();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="åˆ†é…ï¼ˆçš„å˜é‡ï¼‰ä¸åº”æ˜¯å¤šä½™çš„ï¼ˆAssignments-should-not-be-redundantï¼‰"><a href="#åˆ†é…ï¼ˆçš„å˜é‡ï¼‰ä¸åº”æ˜¯å¤šä½™çš„ï¼ˆAssignments-should-not-be-redundantï¼‰" class="headerlink" title="åˆ†é…ï¼ˆçš„å˜é‡ï¼‰ä¸åº”æ˜¯å¤šä½™çš„ï¼ˆAssignments should not be redundantï¼‰"></a>åˆ†é…ï¼ˆçš„å˜é‡ï¼‰ä¸åº”æ˜¯å¤šä½™çš„ï¼ˆ<a href="https://rules.sonarsource.com/javascript/RSPEC-4165" target="_blank" rel="noopener">Assignments should not be redundant</a>ï¼‰</h2><p>æœ‰äº›å˜é‡åˆ†é…æ˜¯æ²¡å¿…è¦çš„ï¼Œæ‰€ä»¥å¯ä»¥ä¼˜åŒ–æ‰ã€‚</p>
<p>åä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = b;</span><br><span class="line">c = a;</span><br><span class="line">b = c; <span class="comment">// Noncompliant: c and b are already the same</span></span><br></pre></td></tr></table></figure>
<p>æ­£ä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a = b;</span><br><span class="line">c = a;</span><br></pre></td></tr></table></figure>
<h2 id="ä¸åº”åœ¨å­è¡¨è¾¾å¼ä¸­è¿›è¡Œèµ‹å€¼ï¼ˆAssignments-should-not-be-made-from-within-sub-expressionsï¼‰"><a href="#ä¸åº”åœ¨å­è¡¨è¾¾å¼ä¸­è¿›è¡Œèµ‹å€¼ï¼ˆAssignments-should-not-be-made-from-within-sub-expressionsï¼‰" class="headerlink" title="ä¸åº”åœ¨å­è¡¨è¾¾å¼ä¸­è¿›è¡Œèµ‹å€¼ï¼ˆAssignments should not be made from within sub-expressionsï¼‰"></a>ä¸åº”åœ¨å­è¡¨è¾¾å¼ä¸­è¿›è¡Œèµ‹å€¼ï¼ˆ<a href="https://rules.sonarsource.com/javascript/RSPEC-1121" target="_blank" rel="noopener">Assignments should not be made from within sub-expressions</a>ï¼‰</h2><p>å­è¡¨è¾¾å¼ä¸­çš„èµ‹å€¼å¾ˆéš¾è¢«å‘ç°ï¼Œå› æ­¤é™ä½äº†ä»£ç çš„å¯è¯»æ€§ã€‚ ç†æƒ³æƒ…å†µä¸‹ï¼Œå­è¡¨è¾¾å¼ä¸åº”è¯¥æœ‰å‰¯ä½œç”¨ã€‚</p>
<p>åä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ((val = value() &amp;&amp; check())) &#123;</span><br><span class="line">  <span class="comment">// Noncompliant</span></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ­£ä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">val = value();</span><br><span class="line"><span class="keyword">if</span> (val &amp;&amp; check()) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ä¸åº”å£°æ˜å±€éƒ¨å˜é‡ç„¶åç«‹å³è¿”å›æˆ–æŠ›å‡ºï¼ˆLocal-variables-should-not-be-declared-and-then-immediately-returned-or-thrownï¼‰"><a href="#ä¸åº”å£°æ˜å±€éƒ¨å˜é‡ç„¶åç«‹å³è¿”å›æˆ–æŠ›å‡ºï¼ˆLocal-variables-should-not-be-declared-and-then-immediately-returned-or-thrownï¼‰" class="headerlink" title="ä¸åº”å£°æ˜å±€éƒ¨å˜é‡ç„¶åç«‹å³è¿”å›æˆ–æŠ›å‡ºï¼ˆLocal variables should not be declared and then immediately returned or thrownï¼‰"></a>ä¸åº”å£°æ˜å±€éƒ¨å˜é‡ç„¶åç«‹å³è¿”å›æˆ–æŠ›å‡ºï¼ˆ<a href="https://rules.sonarsource.com/javascript/RSPEC-1488" target="_blank" rel="noopener">Local variables should not be declared and then immediately returned or thrown</a>ï¼‰</h2><p>å£°æ˜ä¸€ä¸ªå˜é‡åªæ˜¯ä¸ºäº†ç«‹å³è¿”å›æˆ–æŠ›å‡ºå®ƒæ˜¯ä¸€ç§ä¸å¥½çš„åšæ³•ã€‚</p>
<p>ä¸€äº›å¼€å‘äººå‘˜è®¤ä¸ºè¿™ç§åšæ³•æé«˜äº†ä»£ç çš„å¯è¯»æ€§ï¼Œå› ä¸ºå®ƒä½¿ä»–ä»¬èƒ½å¤Ÿæ˜ç¡®åœ°å‘½åè¿”å›çš„å†…å®¹ã€‚ ç„¶è€Œï¼Œè¿™ä¸ªå˜é‡æ˜¯ä¸€ä¸ªå†…éƒ¨å®ç°ç»†èŠ‚ï¼Œä¸ä¼šæš´éœ²ç»™æ–¹æ³•çš„è°ƒç”¨è€…ã€‚ æ–¹æ³•åç§°åº”è¯¥è¶³ä»¥è®©è°ƒç”¨è€…ç¡®åˆ‡åœ°çŸ¥é“å°†è¿”å›ä»€ä¹ˆã€‚</p>
<p>åä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">computeDurationInMilliseconds</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> duration = ((hours * <span class="number">60</span> + minutes) * <span class="number">60</span> + seconds) * <span class="number">1000</span>;</span><br><span class="line">  <span class="keyword">return</span> duration;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ­£ä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">computeDurationInMilliseconds</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> ((hours * <span class="number">60</span> + minutes) * <span class="number">60</span> + seconds) * <span class="number">1000</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="æ¡ä»¶ç»“æ„ä¸­çš„ä¸¤ä¸ªåˆ†æ”¯ä¸åº”å…·æœ‰å®Œå…¨ç›¸åŒçš„å®ç°ï¼ˆTwo-branches-in-a-conditional-structure-should-not-have-exactly-the-same-implementationï¼‰"><a href="#æ¡ä»¶ç»“æ„ä¸­çš„ä¸¤ä¸ªåˆ†æ”¯ä¸åº”å…·æœ‰å®Œå…¨ç›¸åŒçš„å®ç°ï¼ˆTwo-branches-in-a-conditional-structure-should-not-have-exactly-the-same-implementationï¼‰" class="headerlink" title="æ¡ä»¶ç»“æ„ä¸­çš„ä¸¤ä¸ªåˆ†æ”¯ä¸åº”å…·æœ‰å®Œå…¨ç›¸åŒçš„å®ç°ï¼ˆTwo branches in a conditional structure should not have exactly the same implementationï¼‰"></a>æ¡ä»¶ç»“æ„ä¸­çš„ä¸¤ä¸ªåˆ†æ”¯ä¸åº”å…·æœ‰å®Œå…¨ç›¸åŒçš„å®ç°ï¼ˆ<a href="https://rules.sonarsource.com/javascript/RSPEC-1871" target="_blank" rel="noopener">Two branches in a conditional structure should not have exactly the same implementation</a>ï¼‰</h2><blockquote>
<p>ç±»ä¼¼è§„åˆ™ï¼šæ¡ä»¶ç»“æ„ä¸­çš„æ‰€æœ‰åˆ†æ”¯ä¸åº”å…·æœ‰å®Œå…¨ç›¸åŒçš„å®ç°(<a href="https://rules.sonarsource.com/javascript/RSPEC-3923" target="_blank" rel="noopener">All branches in a conditional structure should not have exactly the same implementation</a>)</p>
</blockquote>
<p>switch è¯­å¥ä¸­çš„ä¸¤ä¸ª case æˆ– if é“¾ä¸­çš„ä¸¤ä¸ªåˆ†æ”¯å…·æœ‰ç›¸åŒçš„å®ç°å……å…¶é‡æ˜¯é‡å¤ä»£ç ï¼Œæœ€åçš„æƒ…å†µæ˜¯ç¼–ç é”™è¯¯ã€‚ å¦‚æœä¸¤ä¸ªå®ä¾‹ç¡®å®éœ€è¦ç›¸åŒçš„é€»è¾‘ï¼Œé‚£ä¹ˆåœ¨ if é“¾ä¸­å®ƒä»¬åº”è¯¥è¢«ç»„åˆï¼Œæˆ–è€…å¯¹äºä¸€ä¸ª switchï¼Œä¸€ä¸ªåº”è¯¥è½åˆ°å¦ä¸€ä¸ªã€‚</p>
<p>åä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> (i) &#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">    doFirstThing();</span><br><span class="line">    doSomething();</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">    doSomethingDifferent();</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">case</span> <span class="number">3</span>: <span class="comment">// ä¸åˆè§„; ä¸case 1çš„å®ç°é‡å¤</span></span><br><span class="line">    doFirstThing();</span><br><span class="line">    doSomething();</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">default</span>:</span><br><span class="line">    doTheRest();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (a &gt;= <span class="number">0</span> &amp;&amp; a &lt; <span class="number">10</span>) &#123;</span><br><span class="line">  doFirstThing();</span><br><span class="line">  doTheThing();</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (a &gt;= <span class="number">10</span> &amp;&amp; a &lt; <span class="number">20</span>) &#123;</span><br><span class="line">  doTheOtherThing();</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (a &gt;= <span class="number">20</span> &amp;&amp; a &lt; <span class="number">50</span>) &#123;</span><br><span class="line">  doFirstThing();</span><br><span class="line">  doTheThing(); <span class="comment">// ä¸åˆè§„; ä¸ç¬¬ä¸€ä¸ªæ¡ä»¶çš„å®ç°é‡å¤</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  doTheRest();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¾‹å¤–æƒ…å†µï¼š</p>
<p>if é“¾ä¸­åŒ…å«å•è¡Œä»£ç çš„å—å°†è¢«å¿½ç•¥ï¼Œå°±åƒ switch è¯­å¥ä¸­åŒ…å«å•è¡Œä»£ç ï¼ˆå¸¦æœ‰æˆ–ä¸å¸¦æœ‰åç»­ä¸­æ–­ï¼‰çš„å—ä¸€æ ·ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (a == <span class="number">1</span>) &#123;</span><br><span class="line">  doSomething(); <span class="comment">// æ²¡é—®é¢˜ï¼Œé€šå¸¸è¿™æ ·åšæ˜¯ä¸ºäº†æé«˜å¯è¯»æ€§</span></span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (a == <span class="number">2</span>) &#123;</span><br><span class="line">  doSomethingElse();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  doSomething();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯è¿™ä¸ªä¾‹å¤–ä¸é€‚ç”¨äº<strong>æ²¡æœ‰ else çš„ if é“¾</strong>ï¼Œæˆ–è€…å½“æ‰€æœ‰åˆ†æ”¯éƒ½å…·æœ‰ç›¸åŒçš„å•è¡Œä»£ç æ—¶<strong>æ²¡æœ‰ default å­å¥çš„ switch</strong>ã€‚ å¦‚æœ if é“¾å¸¦æœ‰ else æˆ–å¸¦æœ‰ default å­å¥çš„ switchï¼Œè§„åˆ™ {rule:javascript:S3923} ä¼šå¼•å‘é”™è¯¯ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (a == <span class="number">1</span>) &#123;</span><br><span class="line">  doSomething(); <span class="comment">// ä¸åˆè§„ï¼Œè¿™å¯èƒ½æ˜¯æ•…æ„çš„ï¼ˆä¹Ÿå¯èƒ½ä¸æ˜¯ï¼‰</span></span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (a == <span class="number">2</span>) &#123;</span><br><span class="line">  doSomething();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ä¸åº”è¯¥åœ¨æ¯”è¾ƒä¸­ä½¿ç”¨å¸ƒå°”å­—é¢é‡ï¼ˆBoolean-literals-should-not-be-used-in-comparisonsï¼‰"><a href="#ä¸åº”è¯¥åœ¨æ¯”è¾ƒä¸­ä½¿ç”¨å¸ƒå°”å­—é¢é‡ï¼ˆBoolean-literals-should-not-be-used-in-comparisonsï¼‰" class="headerlink" title="ä¸åº”è¯¥åœ¨æ¯”è¾ƒä¸­ä½¿ç”¨å¸ƒå°”å­—é¢é‡ï¼ˆBoolean literals should not be used in comparisonsï¼‰"></a>ä¸åº”è¯¥åœ¨æ¯”è¾ƒä¸­ä½¿ç”¨å¸ƒå°”å­—é¢é‡ï¼ˆ<a href="https://rules.sonarsource.com/javascript/RSPEC-1125" target="_blank" rel="noopener">Boolean literals should not be used in comparisons</a>ï¼‰</h2><p>åœ¨æ¯”è¾ƒè¡¨è¾¾å¼ == å’Œ != ä¸­åº”é¿å…ä½¿ç”¨å¸ƒå°”å­—é¢é‡ï¼Œä»¥æé«˜ä»£ç å¯è¯»æ€§ã€‚æ­¤è§„åˆ™è¿˜æŠ¥å‘Šå†—ä½™çš„å¸ƒå°”è¿ç®—ã€‚</p>
<p>åä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> someValue = <span class="string">'0'</span>;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (someValue == <span class="literal">true</span>) &#123;</span><br><span class="line">  <span class="comment">/* ... */</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (someBooleanValue != <span class="literal">true</span>) &#123;</span><br><span class="line">  <span class="comment">/* ... */</span></span><br><span class="line">&#125;</span><br><span class="line">doSomething(!<span class="literal">false</span>);</span><br></pre></td></tr></table></figure>
<p>æ­£ä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (someValue &amp;&amp; someValue != <span class="string">'0'</span>) &#123;</span><br><span class="line">  <span class="comment">/* ... */</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (!someBooleanValue) &#123;</span><br><span class="line">  <span class="comment">/* ... */</span></span><br><span class="line">&#125;</span><br><span class="line">doSomething(<span class="literal">true</span>);</span><br></pre></td></tr></table></figure>
<h2 id="è·³è½¬è¯­å¥ä¸åº”å†—ä½™ï¼ˆJump-statements-should-not-be-redundantï¼‰"><a href="#è·³è½¬è¯­å¥ä¸åº”å†—ä½™ï¼ˆJump-statements-should-not-be-redundantï¼‰" class="headerlink" title="è·³è½¬è¯­å¥ä¸åº”å†—ä½™ï¼ˆJump statements should not be redundantï¼‰"></a>è·³è½¬è¯­å¥ä¸åº”å†—ä½™ï¼ˆ<a href="https://rules.sonarsource.com/javascript/RSPEC-3626" target="_blank" rel="noopener">Jump statements should not be redundant</a>ï¼‰</h2><p>è·³è½¬è¯­å¥ï¼Œä¾‹å¦‚ returnã€break å’Œ continue å¯ä»¥è®©ä½ æ”¹å˜ç¨‹åºæ‰§è¡Œçš„é»˜è®¤æµç¨‹ï¼Œä½†æ˜¯å°†æ§åˆ¶æµå¼•å¯¼åˆ°åŸå§‹æ–¹å‘æ˜¯å¤šä½™çš„ã€‚</p>
<p>åä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">redundantJump</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (x == <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'x == 1'</span>);</span><br><span class="line">    <span class="keyword">return</span>; <span class="comment">// Noncompliant</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ­£ä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">redundantJump</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (x == <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'x == 1'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¾‹å¤–æƒ…å†µï¼š</p>
<ul>
<li>switch è¯­å¥ä¸­çš„ break å’Œ return è¢«å¿½ç•¥ï¼Œå› ä¸ºå®ƒä»¬ç»å¸¸ç”¨äºä¿æŒä¸€è‡´æ€§ã€‚</li>
<li>continue with label ä¹Ÿè¢«å¿½ç•¥ï¼Œå› ä¸ºæ ‡ç­¾é€šå¸¸ç”¨äºæ¸…æ™°èµ·è§ã€‚</li>
<li>æ­¤å¤–ï¼Œå—ä¸­ä½œä¸ºå•ä¸ªè¯­å¥çš„è·³è½¬è¯­å¥ä¹Ÿå°†è¢«å¿½ç•¥ã€‚</li>
</ul>
<h2 id="ä¸åº”ä½¿ç”¨å·²å¼ƒç”¨çš„-APIï¼ˆDeprecated-APIs-should-not-be-usedï¼‰"><a href="#ä¸åº”ä½¿ç”¨å·²å¼ƒç”¨çš„-APIï¼ˆDeprecated-APIs-should-not-be-usedï¼‰" class="headerlink" title="ä¸åº”ä½¿ç”¨å·²å¼ƒç”¨çš„ APIï¼ˆDeprecated APIs should not be usedï¼‰"></a>ä¸åº”ä½¿ç”¨å·²å¼ƒç”¨çš„ APIï¼ˆ<a href="https://rules.sonarsource.com/javascript/RSPEC-1874" target="_blank" rel="noopener">Deprecated APIs should not be used</a>ï¼‰</h2><h2 id="é»˜è®¤å¯¼å‡ºåç§°å’Œæ–‡ä»¶ååº”åŒ¹é…ï¼ˆDefault-export-names-and-file-names-should-matchï¼‰"><a href="#é»˜è®¤å¯¼å‡ºåç§°å’Œæ–‡ä»¶ååº”åŒ¹é…ï¼ˆDefault-export-names-and-file-names-should-matchï¼‰" class="headerlink" title="é»˜è®¤å¯¼å‡ºåç§°å’Œæ–‡ä»¶ååº”åŒ¹é…ï¼ˆDefault export names and file names should matchï¼‰"></a>é»˜è®¤å¯¼å‡ºåç§°å’Œæ–‡ä»¶ååº”åŒ¹é…ï¼ˆ<a href="https://rules.sonarsource.com/javascript/RSPEC-3317" target="_blank" rel="noopener">Default export names and file names should match</a>ï¼‰</h2><p>æŒ‰ç…§æƒ¯ä¾‹ï¼Œåªå¯¼å‡ºä¸€ä¸ªç±»ã€å‡½æ•°æˆ–å¸¸é‡çš„æ–‡ä»¶åº”è¯¥ä»¥è¯¥ç±»ã€å‡½æ•°æˆ–å¸¸é‡å‘½åã€‚ å¦åˆ™å¯èƒ½ä½¿ç»´æŠ¤è€…æ„Ÿåˆ°å›°æƒ‘ã€‚</p>
<p>åä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// file path: myclass.js  -- Noncompliant</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> MyClass;</span><br></pre></td></tr></table></figure>
<p>æ­£ä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// file path: MyClass.js</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> MyClass;</span><br></pre></td></tr></table></figure>
<h2 id="å‡½æ•°åº”è¯¥æ€»æ˜¯è¿”å›åŒæ ·çš„ç±»å‹ï¼ˆFunctions-should-always-return-the-same-typeï¼‰"><a href="#å‡½æ•°åº”è¯¥æ€»æ˜¯è¿”å›åŒæ ·çš„ç±»å‹ï¼ˆFunctions-should-always-return-the-same-typeï¼‰" class="headerlink" title="å‡½æ•°åº”è¯¥æ€»æ˜¯è¿”å›åŒæ ·çš„ç±»å‹ï¼ˆFunctions should always return the same typeï¼‰"></a>å‡½æ•°åº”è¯¥æ€»æ˜¯è¿”å›åŒæ ·çš„ç±»å‹ï¼ˆ<a href="https://rules.sonarsource.com/javascript/RSPEC-3800" target="_blank" rel="noopener">Functions should always return the same type</a>ï¼‰</h2><p>ä¸å¼ºç±»å‹è¯­è¨€ä¸åŒï¼ŒJavaScript ä¸å¼ºåˆ¶å‡½æ•°çš„è¿”å›ç±»å‹ã€‚ è¿™æ„å‘³ç€é€šè¿‡å‡½æ•°çš„ä¸åŒè·¯å¾„å¯ä»¥è¿”å›ä¸åŒç±»å‹çš„å€¼ï¼Œè¿™å¯èƒ½ä¼šè®©ä½¿ç”¨è€…æ„Ÿåˆ°éå¸¸å›°æƒ‘å¹¶ä¸”éš¾ä»¥ç»´æŠ¤ã€‚</p>
<p>åä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Noncompliant</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">a</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (a === <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">3</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ­£ä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">a</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (a === <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¾‹å¤–ï¼šè¿”å› this çš„å‡½æ•°å°†è¢«å¿½ç•¥ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿”å›ç±»å‹ä¸º any çš„è¡¨è¾¾å¼çš„å‡½æ•°å°†è¢«å¿½ç•¥ã€‚</p>
<h2 id="æ²¡ç”¨åˆ°çš„å¼•å…¥åº”è¯¥åˆ é™¤æ‰ï¼ˆUnnecessary-imports-should-be-removedï¼‰"><a href="#æ²¡ç”¨åˆ°çš„å¼•å…¥åº”è¯¥åˆ é™¤æ‰ï¼ˆUnnecessary-imports-should-be-removedï¼‰" class="headerlink" title="æ²¡ç”¨åˆ°çš„å¼•å…¥åº”è¯¥åˆ é™¤æ‰ï¼ˆUnnecessary imports should be removedï¼‰"></a>æ²¡ç”¨åˆ°çš„å¼•å…¥åº”è¯¥åˆ é™¤æ‰ï¼ˆ<a href="https://rules.sonarsource.com/javascript/RSPEC-1128" target="_blank" rel="noopener">Unnecessary imports should be removed</a>ï¼‰</h2><p>æ²¡æœ‰ç†ç”±å¯¼å…¥ä½ ä¸ä½¿ç”¨çš„æ¨¡å—ï¼Œè¿™æ ·åšä¸å¿…è¦åœ°å¢åŠ äº†è´Ÿè½½ã€‚</p>
<p>åä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Noncompliant, A isn't used</span></span><br><span class="line"><span class="keyword">import</span> A <span class="keyword">from</span> <span class="string">'a'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; B1 &#125; <span class="keyword">from</span> <span class="string">'b'</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(B1);</span><br></pre></td></tr></table></figure>
<p>æ­£ä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; B1 &#125; <span class="keyword">from</span> <span class="string">'b'</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(B1);</span><br></pre></td></tr></table></figure>
<h2 id="ä¸åº”ä½¿ç”¨â€œvoidâ€ï¼ˆâ€œvoidâ€-should-not-be-usedï¼‰"><a href="#ä¸åº”ä½¿ç”¨â€œvoidâ€ï¼ˆâ€œvoidâ€-should-not-be-usedï¼‰" class="headerlink" title="ä¸åº”ä½¿ç”¨â€œvoidâ€ï¼ˆâ€œvoidâ€ should not be usedï¼‰"></a>ä¸åº”ä½¿ç”¨â€œvoidâ€ï¼ˆ<a href="https://rules.sonarsource.com/javascript/RSPEC-3735" target="_blank" rel="noopener">â€œvoidâ€ should not be used</a>ï¼‰</h2><p>void è¿ç®—ç¬¦è¯„ä¼°å…¶å‚æ•°å¹¶æ— æ¡ä»¶åœ°è¿”å› undefinedã€‚ å®ƒåœ¨ ECMAScript 5 ä¹‹å‰çš„ç¯å¢ƒä¸­å¾ˆæœ‰ç”¨ï¼Œ undefined å¯ä»¥é‡æ–°åˆ†é…ã€‚ä½†é€šå¸¸ï¼Œå®ƒçš„ä½¿ç”¨ä¼šä½¿ä»£ç æ›´éš¾ç†è§£ã€‚</p>
<p>åä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> doSomething();</span><br></pre></td></tr></table></figure>
<p>æ­£ä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">doSomething();</span><br></pre></td></tr></table></figure>
<p>ä¾‹å¤–ï¼šå½“ä½¿ç”¨ <code>void 0</code> ä»£æ›¿ undefined æ—¶ä¸ä¼šå‡ºç°é—®é¢˜ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (parameter === <span class="keyword">void</span> <span class="number">0</span>) &#123;...&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨ç«‹å³è°ƒç”¨çš„å‡½æ•°è¡¨è¾¾å¼ä¹‹å‰ä½¿ç”¨ void æ—¶ï¼Œä¹Ÿä¸ä¼šå‡ºç°é—®é¢˜ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">   ...</span><br><span class="line">&#125;());</span><br></pre></td></tr></table></figure>
<h2 id="å¸¦æœ‰é»˜è®¤å€¼çš„å‡½æ•°å‚æ•°åº”è¯¥æ”¾åˆ°æœ€åï¼ˆFunction-parameters-with-default-values-should-be-lastï¼‰"><a href="#å¸¦æœ‰é»˜è®¤å€¼çš„å‡½æ•°å‚æ•°åº”è¯¥æ”¾åˆ°æœ€åï¼ˆFunction-parameters-with-default-values-should-be-lastï¼‰" class="headerlink" title="å¸¦æœ‰é»˜è®¤å€¼çš„å‡½æ•°å‚æ•°åº”è¯¥æ”¾åˆ°æœ€åï¼ˆFunction parameters with default values should be lastï¼‰"></a>å¸¦æœ‰é»˜è®¤å€¼çš„å‡½æ•°å‚æ•°åº”è¯¥æ”¾åˆ°æœ€åï¼ˆ<a href="https://rules.sonarsource.com/javascript/RSPEC-1788" target="_blank" rel="noopener">Function parameters with default values should be last</a>ï¼‰</h2><p>ä¸ºå‡½æ•°å‚æ•°å®šä¹‰é»˜è®¤å€¼å¯ä»¥ä½¿å‡½æ•°æ›´æ˜“äºä½¿ç”¨ã€‚é»˜è®¤å‚æ•°å€¼å…è®¸è°ƒç”¨è€…æ ¹æ®éœ€è¦æŒ‡å®šå°½å¯èƒ½å¤šæˆ–å°½å¯èƒ½å°‘çš„å‚æ•°ï¼ŒåŒæ—¶è·å¾—ç›¸åŒçš„åŠŸèƒ½å¹¶æœ€å¤§é™åº¦åœ°å‡å°‘æ ·æ¿(boilerplate)ã€åŒ…è£…å™¨(wrapper)ç±»ä¼¼çš„ä»£ç ã€‚</p>
<p>ä½†æ˜¯æ‰€æœ‰å¸¦é»˜è®¤å€¼çš„å‡½æ•°å‚æ•°éƒ½åº”è¯¥åœ¨æ²¡æœ‰é»˜è®¤å€¼çš„å‡½æ•°å‚æ•°ä¹‹åå£°æ˜ã€‚å¦åˆ™ï¼Œè°ƒç”¨è€…å°±æ— æ³•åˆ©ç”¨é»˜è®¤å€¼ï¼›ä»–ä»¬å¿…é¡»é‡æ–°æŒ‡å®šé»˜è®¤å€¼æˆ–ä¼ é€’ <code>undefined</code> ä»¥â€œè·å–â€éé»˜è®¤å‚æ•°ã€‚</p>
<p>åä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Noncompliant</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">multiply</span>(<span class="params">a = <span class="number">1</span>, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a * b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> x = multiply(<span class="number">42</span>); <span class="comment">// returns NaN as b is undefined</span></span><br></pre></td></tr></table></figure>
<p>æ­£ä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">multiply</span>(<span class="params">b, a = <span class="number">1</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a * b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> x = multiply(<span class="number">42</span>); <span class="comment">// returns 42 as expected</span></span><br></pre></td></tr></table></figure>
<h2 id="ä¸åº”è®¿é—®æˆ–è¿­ä»£ç©ºé›†åˆï¼ˆEmpty-collections-should-not-be-accessed-or-iteratedï¼‰"><a href="#ä¸åº”è®¿é—®æˆ–è¿­ä»£ç©ºé›†åˆï¼ˆEmpty-collections-should-not-be-accessed-or-iteratedï¼‰" class="headerlink" title="ä¸åº”è®¿é—®æˆ–è¿­ä»£ç©ºé›†åˆï¼ˆEmpty collections should not be accessed or iteratedï¼‰"></a>ä¸åº”è®¿é—®æˆ–è¿­ä»£ç©ºé›†åˆï¼ˆ<a href="https://rules.sonarsource.com/javascript/RSPEC-4158" target="_blank" rel="noopener">Empty collections should not be accessed or iterated</a>ï¼‰</h2><p>å½“é›†åˆä¸ºç©ºæ—¶ï¼Œè®¿é—®æˆ–è¿­ä»£å®ƒæ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚ æ— è®ºå¦‚ä½•è¿™æ ·åšè‚¯å®šæ˜¯é”™è¯¯çš„ã€‚</p>
<p>åä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> strings = [];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (strings.includes(<span class="string">"foo"</span>)) &#123; ... &#125;  <span class="comment">// Noncompliant</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (str <span class="keyword">of</span> strings) &#123; ... &#125;  <span class="comment">// Noncompliant</span></span><br><span class="line"></span><br><span class="line">strings.forEach(<span class="function"><span class="params">str</span> =&gt;</span> doSomething(str)); <span class="comment">// Noncompliant</span></span><br></pre></td></tr></table></figure>
<h2 id="å†…ç½®å‡½æ•°çš„å‚æ•°åº”è¯¥ç±»å‹åŒ¹é…ï¼ˆArguments-to-built-in-functions-should-match-documented-typesï¼‰"><a href="#å†…ç½®å‡½æ•°çš„å‚æ•°åº”è¯¥ç±»å‹åŒ¹é…ï¼ˆArguments-to-built-in-functions-should-match-documented-typesï¼‰" class="headerlink" title="å†…ç½®å‡½æ•°çš„å‚æ•°åº”è¯¥ç±»å‹åŒ¹é…ï¼ˆArguments to built-in functions should match documented typesï¼‰"></a>å†…ç½®å‡½æ•°çš„å‚æ•°åº”è¯¥ç±»å‹åŒ¹é…ï¼ˆ<a href="https://rules.sonarsource.com/javascript/RSPEC-3782" target="_blank" rel="noopener">Arguments to built-in functions should match documented types</a>ï¼‰</h2><p>JavaScript è¯­è¨€è§„èŒƒä¸­æŒ‡å®šäº†å†…ç½®å‡½æ•°çš„å‚æ•°ç±»å‹ã€‚ å¯¹è¿™äº›å‡½æ•°çš„è°ƒç”¨åº”ç¬¦åˆè§„å®šçš„ç±»å‹ï¼Œå¦åˆ™ç»“æœå¾ˆå¯èƒ½ä¸æ˜¯é¢„æœŸçš„ï¼Œä¾‹å¦‚ï¼š</p>
<p>åä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> isTooSmall = <span class="built_in">Math</span>.abs(x &lt; <span class="number">0.0042</span>);</span><br></pre></td></tr></table></figure>
<p>æ­£ä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> isTooSmall = <span class="built_in">Math</span>.abs(x) &lt; <span class="number">0.0042</span>;</span><br></pre></td></tr></table></figure>
<h2 id="å†…ç½®å‡½æ•°çš„å‚æ•°åº”è¯¥ç±»å‹åŒ¹é…ï¼ˆBoolean-checks-should-not-be-invertedï¼‰"><a href="#å†…ç½®å‡½æ•°çš„å‚æ•°åº”è¯¥ç±»å‹åŒ¹é…ï¼ˆBoolean-checks-should-not-be-invertedï¼‰" class="headerlink" title="å†…ç½®å‡½æ•°çš„å‚æ•°åº”è¯¥ç±»å‹åŒ¹é…ï¼ˆBoolean checks should not be invertedï¼‰"></a>å†…ç½®å‡½æ•°çš„å‚æ•°åº”è¯¥ç±»å‹åŒ¹é…ï¼ˆ<a href="https://rules.sonarsource.com/javascript/RSPEC-1940" target="_blank" rel="noopener">Boolean checks should not be inverted</a>ï¼‰</h2><p>åè½¬å¸ƒå°”æ¯”è¾ƒå¢åŠ äº†ä¸å¿…è¦çš„ä»£ç å¤æ‚åº¦ã€‚åº”è¯¥è¿›è¡Œç›¸åçš„æ¯”è¾ƒã€‚</p>
<p>åä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!(a === <span class="number">2</span>)) &#123; ... &#125;  <span class="comment">// Noncompliant</span></span><br></pre></td></tr></table></figure>
<p>æ­£ä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (a !== <span class="number">2</span>) &#123; ... &#125;</span><br></pre></td></tr></table></figure>
<h2 id="ä¸åº”å¿½ç•¥æ²¡æœ‰å‰¯ä½œç”¨çš„å‡½æ•°çš„è¿”å›å€¼ï¼ˆReturn-values-from-functions-without-side-effects-should-not-be-ignoredï¼‰"><a href="#ä¸åº”å¿½ç•¥æ²¡æœ‰å‰¯ä½œç”¨çš„å‡½æ•°çš„è¿”å›å€¼ï¼ˆReturn-values-from-functions-without-side-effects-should-not-be-ignoredï¼‰" class="headerlink" title="ä¸åº”å¿½ç•¥æ²¡æœ‰å‰¯ä½œç”¨çš„å‡½æ•°çš„è¿”å›å€¼ï¼ˆReturn values from functions without side effects should not be ignoredï¼‰"></a>ä¸åº”å¿½ç•¥æ²¡æœ‰å‰¯ä½œç”¨çš„å‡½æ•°çš„è¿”å›å€¼ï¼ˆ<a href="https://rules.sonarsource.com/javascript/RSPEC-2201" target="_blank" rel="noopener">Return values from functions without side effects should not be ignored</a>ï¼‰</h2><p>å½“å¯¹å‡½æ•°çš„è°ƒç”¨æ²¡æœ‰ä»»ä½•å‰¯ä½œç”¨æ—¶ï¼Œå¦‚æœç»“æœè¢«å¿½ç•¥ï¼Œè°ƒç”¨çš„æ„ä¹‰ä½•åœ¨ï¼Ÿ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¦ä¹ˆå‡½æ•°è°ƒç”¨æ²¡ç”¨ï¼Œåº”è¯¥åˆ é™¤ï¼Œè¦ä¹ˆæºä»£ç æ²¡æœ‰æŒ‰é¢„æœŸè¿è¡Œã€‚</p>
<p>ä¸ºé˜²æ­¢äº§ç”Ÿä»»ä½•è¯¯æŠ¥ï¼Œæ­¤è§„åˆ™ä»…åœ¨å·²çŸ¥å¯¹è±¡å’ŒåŠŸèƒ½çš„é¢„å®šä¹‰åˆ—è¡¨ä¸Šè§¦å‘é—®é¢˜ã€‚</p>
<p>åä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'hello'</span>.lastIndexOf(<span class="string">'e'</span>); <span class="comment">// Noncompliant</span></span><br></pre></td></tr></table></figure>
<p>æ­£ä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> char = <span class="string">'hello'</span>.lastIndexOf(<span class="string">'e'</span>);</span><br></pre></td></tr></table></figure>
<p>è¿åæ­¤è§„åˆ™çš„ä»£ç ä¸­ï¼Œä½¿ç”¨<code>map</code>è¿›è¡Œå¾ªç¯çš„æƒ…å†µæœ€å¤šï¼Œå¦‚æœä¸éœ€è¦å¾ªç¯è¿”å›å€¼ï¼Œè¯·ä½¿ç”¨<code>forEach</code>ä»£æ›¿ã€‚</p>
<h2 id="ä¸åº”é‡å¤å£°æ˜å˜é‡å’Œå‡½æ•°ï¼ˆVariables-and-functions-should-not-be-redeclaredï¼‰"><a href="#ä¸åº”é‡å¤å£°æ˜å˜é‡å’Œå‡½æ•°ï¼ˆVariables-and-functions-should-not-be-redeclaredï¼‰" class="headerlink" title="ä¸åº”é‡å¤å£°æ˜å˜é‡å’Œå‡½æ•°ï¼ˆVariables and functions should not be redeclaredï¼‰"></a>ä¸åº”é‡å¤å£°æ˜å˜é‡å’Œå‡½æ•°ï¼ˆ<a href="https://rules.sonarsource.com/javascript/RSPEC-2814" target="_blank" rel="noopener">Variables and functions should not be redeclared</a>ï¼‰</h2><p>å®é™…ä¸Šï¼Œå¯ä»¥å¤šæ¬¡ä½¿ç”¨ç›¸åŒçš„ç¬¦å·ä½œä¸ºå˜é‡æˆ–å‡½æ•°ï¼Œä½†è¿™æ ·åšå¯èƒ½ä¼šä½¿ç»´æŠ¤è€…æ„Ÿåˆ°å›°æƒ‘ã€‚æ­¤å¤–ï¼Œè¿™ç§é‡æ–°åˆ†é…å¯èƒ½æ˜¯é”™è¯¯çš„ï¼Œå¼€å‘äººå‘˜æ²¡æœ‰æ„è¯†åˆ°å˜é‡çš„å€¼è¢«æ–°çš„åˆ†é…è¦†ç›–äº†ã€‚</p>
<p>æ­¤è§„åˆ™ä¹Ÿé€‚ç”¨äºå‡½æ•°å‚æ•°ã€‚</p>
<p>åä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="string">'foo'</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>) </span>&#123;&#125; <span class="comment">// Noncompliant</span></span><br><span class="line"><span class="built_in">console</span>.log(a); <span class="comment">// prints "foo"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myFunc</span>(<span class="params">arg</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> arg = <span class="string">'event'</span>; <span class="comment">// Noncompliant, argument value is lost</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fun(); <span class="comment">// prints "bar"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fun</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'foo'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fun(); <span class="comment">// prints "bar"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Noncompliant</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fun</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'bar'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fun(); <span class="comment">// prints "bar"</span></span><br></pre></td></tr></table></figure>
<p>æ­£ä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="string">'foo'</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">otherName</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="built_in">console</span>.log(a);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myFunc</span>(<span class="params">arg</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> newName = <span class="string">'event'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fun(); <span class="comment">// prints "foo"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fun</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  print(<span class="string">'foo'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fun(); <span class="comment">// prints "foo"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">printBar</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  print(<span class="string">'bar'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">printBar(); <span class="comment">// prints "bar"</span></span><br></pre></td></tr></table></figure>
<h2 id="æ•°ç»„æ–¹æ³•çš„å›è°ƒåº”è¯¥æœ‰è¿”å›ï¼ˆreturn-è¯­å¥ï¼‰ï¼ˆCallbacks-of-array-methods-should-have-return-statementsï¼‰"><a href="#æ•°ç»„æ–¹æ³•çš„å›è°ƒåº”è¯¥æœ‰è¿”å›ï¼ˆreturn-è¯­å¥ï¼‰ï¼ˆCallbacks-of-array-methods-should-have-return-statementsï¼‰" class="headerlink" title="æ•°ç»„æ–¹æ³•çš„å›è°ƒåº”è¯¥æœ‰è¿”å›ï¼ˆreturn è¯­å¥ï¼‰ï¼ˆCallbacks of array methods should have return statementsï¼‰"></a>æ•°ç»„æ–¹æ³•çš„å›è°ƒåº”è¯¥æœ‰è¿”å›ï¼ˆreturn è¯­å¥ï¼‰ï¼ˆ<a href="https://rules.sonarsource.com/javascript/RSPEC-3796" target="_blank" rel="noopener">Callbacks of array methods should have return statements</a>ï¼‰</h2><p>JavaScript ä¸­çš„æ•°ç»„æœ‰å‡ ç§ï¼ˆè¿‡æ»¤ã€æ˜ å°„æˆ–æŠ˜å ï¼‰éœ€è¦å›è°ƒçš„æ–¹æ³•ã€‚åœ¨è¿™æ ·çš„å›è°ƒå‡½æ•°ä¸­æ²¡æœ‰ return è¯­å¥å¾ˆå¯èƒ½æ˜¯ä¸€ä¸ªé”™è¯¯ï¼Œå› ä¸ºæ•°ç»„çš„å¤„ç†ä½¿ç”¨äº†å›è°ƒçš„è¿”å›å€¼ã€‚ å¦‚æœæ²¡æœ‰è¿”å›ï¼Œå›è°ƒå°†éšå¼è¿”å› undefinedï¼Œè¿™å¯èƒ½ä¼šå¤±è´¥ã€‚</p>
<p>æ­¤è§„åˆ™é€‚ç”¨äºæ•°ç»„çš„ä»¥ä¸‹æ–¹æ³•ï¼š</p>
<ul>
<li><code>Array.from</code></li>
<li><code>Array.prototype.every</code></li>
<li><code>Array.prototype.filter</code></li>
<li><code>Array.prototype.find</code></li>
<li><code>Array.prototype.findIndex</code></li>
<li><code>Array.prototype.map</code></li>
<li><code>Array.prototype.reduce</code></li>
<li><code>Array.prototype.reduceRight</code></li>
<li><code>Array.prototype.some</code></li>
<li><code>Array.prototype.sort</code></li>
</ul>
<p>åä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>];</span><br><span class="line"><span class="keyword">let</span> merged = arr.reduce(<span class="function"><span class="keyword">function</span> (<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  a.concat(b);</span><br><span class="line">&#125;); <span class="comment">// Noncompliant: No return statement, will result in TypeError</span></span><br></pre></td></tr></table></figure>
<p>æ­£ä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>];</span><br><span class="line"><span class="keyword">let</span> merged = arr.reduce(<span class="function"><span class="keyword">function</span> (<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a.concat(b);</span><br><span class="line">&#125;); <span class="comment">// merged === "abc"</span></span><br></pre></td></tr></table></figure>
<p>è¿åæ­¤è§„åˆ™çš„ä»£ç ä¸­ï¼Œä½¿ç”¨<code>map</code>è¿›è¡Œå¾ªç¯çš„æƒ…å†µæœ€å¤šï¼Œå¦‚æœä¸éœ€è¦å¾ªç¯è¿”å›å€¼ï¼Œè¯·ä½¿ç”¨<code>forEach</code>ä»£æ›¿ã€‚</p>
<h2 id="ä¸¥æ ¼ç›¸ç­‰è¿ç®—ç¬¦ä¸åº”ä¸ä¸åŒç±»å‹ä¸€èµ·ä½¿ç”¨ï¼ˆStrict-equality-operators-should-not-be-used-with-dissimilar-typesï¼‰"><a href="#ä¸¥æ ¼ç›¸ç­‰è¿ç®—ç¬¦ä¸åº”ä¸ä¸åŒç±»å‹ä¸€èµ·ä½¿ç”¨ï¼ˆStrict-equality-operators-should-not-be-used-with-dissimilar-typesï¼‰" class="headerlink" title="ä¸¥æ ¼ç›¸ç­‰è¿ç®—ç¬¦ä¸åº”ä¸ä¸åŒç±»å‹ä¸€èµ·ä½¿ç”¨ï¼ˆStrict equality operators should not be used with dissimilar typesï¼‰"></a>ä¸¥æ ¼ç›¸ç­‰è¿ç®—ç¬¦ä¸åº”ä¸ä¸åŒç±»å‹ä¸€èµ·ä½¿ç”¨ï¼ˆ<a href="https://rules.sonarsource.com/javascript/RSPEC-3403" target="_blank" rel="noopener">Strict equality operators should not be used with dissimilar types</a>ï¼‰</h2><p>ä½¿ç”¨ä¸¥æ ¼ç›¸ç­‰è¿ç®—ç¬¦ <code>===</code> å’Œ <code>!==</code> æ¯”è¾ƒä¸åŒçš„ç±»å‹å°†å§‹ç»ˆè¿”å›ç›¸åŒçš„å€¼ï¼Œåˆ†åˆ«ä¸º <code>false</code> å’Œ <code>true</code>ï¼Œå› ä¸ºåœ¨æ¯”è¾ƒä¹‹å‰æ²¡æœ‰è¿›è¡Œç±»å‹è½¬æ¢ã€‚å› æ­¤ï¼Œè¿™ç§æ¯”è¾ƒæ˜¯é”™è¯¯çš„ã€‚</p>
<p>åä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">8</span>;</span><br><span class="line"><span class="keyword">var</span> b = <span class="string">'8'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Noncompliant; always false</span></span><br><span class="line"><span class="keyword">if</span> (a === b) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ­£ä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">8</span>;</span><br><span class="line"><span class="keyword">var</span> b = <span class="string">'8'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (a == b) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// or</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a = <span class="number">8</span>;</span><br><span class="line"><span class="keyword">var</span> b = <span class="string">'8'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (a === <span class="built_in">Number</span>(b)) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="â€œswitchâ€è¯­å¥åº”è¯¥è‡³å°‘æœ‰-3-ä¸ªâ€œcaseâ€å­å¥ï¼ˆâ€œswitchâ€-statements-should-have-at-least-3-â€œcaseâ€-clausesï¼‰"><a href="#â€œswitchâ€è¯­å¥åº”è¯¥è‡³å°‘æœ‰-3-ä¸ªâ€œcaseâ€å­å¥ï¼ˆâ€œswitchâ€-statements-should-have-at-least-3-â€œcaseâ€-clausesï¼‰" class="headerlink" title="â€œswitchâ€è¯­å¥åº”è¯¥è‡³å°‘æœ‰ 3 ä¸ªâ€œcaseâ€å­å¥ï¼ˆâ€œswitchâ€ statements should have at least 3 â€œcaseâ€ clausesï¼‰"></a>â€œswitchâ€è¯­å¥åº”è¯¥è‡³å°‘æœ‰ 3 ä¸ªâ€œcaseâ€å­å¥ï¼ˆ<a href="https://rules.sonarsource.com/javascript/RSPEC-1301" target="_blank" rel="noopener">â€œswitchâ€ statements should have at least 3 â€œcaseâ€ clauses</a>ï¼‰</h2><p>å½“åŒä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼æœ‰è®¸å¤šä¸åŒçš„æƒ…å†µæ—¶ï¼Œswitch è¯­å¥å¾ˆæœ‰ç”¨ã€‚ä½†æ˜¯ï¼Œå¯¹äºä¸€ä¸¤ç§æƒ…å†µï¼Œä½¿ç”¨ if è¯­å¥ä¼šä½¿ä»£ç æ›´å…·å¯è¯»æ€§ã€‚</p>
<p>åä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> (variable) &#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">    doSomething();</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">default</span>:</span><br><span class="line">    doSomethingElse();</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ­£ä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (variable == <span class="number">0</span>) &#123;</span><br><span class="line">  doSomething();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  doSomethingElse();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="åº”ä½¿ç”¨é›†åˆå’Œæ•°ç»„å†…å®¹ï¼ˆCollection-and-array-contents-should-be-usedï¼‰"><a href="#åº”ä½¿ç”¨é›†åˆå’Œæ•°ç»„å†…å®¹ï¼ˆCollection-and-array-contents-should-be-usedï¼‰" class="headerlink" title="åº”ä½¿ç”¨é›†åˆå’Œæ•°ç»„å†…å®¹ï¼ˆCollection and array contents should be usedï¼‰"></a>åº”ä½¿ç”¨é›†åˆå’Œæ•°ç»„å†…å®¹ï¼ˆ<a href="https://rules.sonarsource.com/javascript/RSPEC-4030" target="_blank" rel="noopener">Collection and array contents should be used</a>ï¼‰</h2><p>å½“ä¸€ä¸ªé›†åˆè¢«å¡«å……ä½†å®ƒçš„å†…å®¹ä»æœªè¢«ä½¿ç”¨æ—¶ï¼Œé‚£ä¹ˆå®ƒè‚¯å®šæ˜¯æŸç§é”™è¯¯ã€‚è¦ä¹ˆé‡æ„ä½¿é›†åˆå˜å¾—æ¯«æ— æ„ä¹‰ï¼Œè¦ä¹ˆç¼ºå°‘è®¿é—®æƒé™ã€‚</p>
<p>å½“é™¤äº†æ·»åŠ æˆ–åˆ é™¤å€¼çš„æ–¹æ³•ä¹‹å¤–æ²¡æœ‰å¯¹é›†åˆè°ƒç”¨ä»»ä½•æ–¹æ³•æ—¶ï¼Œæ­¤è§„åˆ™ä¼šå¼•å‘é—®é¢˜ã€‚</p>
<p>åä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getLength</span>(<span class="params">a, b, c</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> strings = []; <span class="comment">// Noncompliant</span></span><br><span class="line">  strings.push(a);</span><br><span class="line">  strings.push(b);</span><br><span class="line">  strings.push(c);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> a.length + b.length + c.length;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ­£ä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getLength</span>(<span class="params">a, b, c</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a.length + b.length + c.length;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="è·³è½¬è¯­å¥ä¸åº”è¯¥æ˜¯å¤šä½™çš„ï¼ˆJump-statements-should-not-be-redundantï¼‰"><a href="#è·³è½¬è¯­å¥ä¸åº”è¯¥æ˜¯å¤šä½™çš„ï¼ˆJump-statements-should-not-be-redundantï¼‰" class="headerlink" title="è·³è½¬è¯­å¥ä¸åº”è¯¥æ˜¯å¤šä½™çš„ï¼ˆJump statements should not be redundantï¼‰"></a>è·³è½¬è¯­å¥ä¸åº”è¯¥æ˜¯å¤šä½™çš„ï¼ˆ<a href="https://rules.sonarsource.com/javascript/RSPEC-3626" target="_blank" rel="noopener">Jump statements should not be redundant</a>ï¼‰</h2><p>è·³è½¬è¯­å¥ï¼Œä¾‹å¦‚ <code>return</code>ã€<code>break</code> å’Œ <code>continue</code> å¯ä»¥è®©ä½ æ”¹å˜ç¨‹åºæ‰§è¡Œçš„é»˜è®¤æµç¨‹ï¼Œä½†æ˜¯å°†æ§åˆ¶æµå¼•å¯¼åˆ°åŸå§‹æ–¹å‘çš„è·³è½¬è¯­å¥æ˜¯å¤šä½™çš„ã€‚</p>
<p>åä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">redundantJump</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (x == <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'x == 1'</span>);</span><br><span class="line">    <span class="keyword">return</span>; <span class="comment">// Noncompliant</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ­£ä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">redundantJump</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (x == <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'x == 1'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¾‹å¤–ï¼š</p>
<p><code>switch</code> è¯­å¥ä¸­çš„ <code>break</code> å’Œ <code>return</code> è¢«å¿½ç•¥ï¼Œå› ä¸ºå®ƒä»¬ç»å¸¸ç”¨äºä¿æŒä¸€è‡´æ€§ã€‚ <code>continue</code> with label ä¹Ÿä¼šè¢«å¿½ç•¥ï¼Œå› ä¸ºæ ‡ç­¾é€šå¸¸ç”¨äºæ¸…æ™°èµ·è§ã€‚ æ­¤å¤–ï¼Œå—ä¸­ä½œä¸ºå•ä¸ªè¯­å¥çš„è·³è½¬è¯­å¥ä¹Ÿå°†è¢«å¿½ç•¥ã€‚</p>
<h2 id="â€œawaitâ€ä¸åº”è¯¥è¢«é‡å¤ä½¿ç”¨ï¼ˆâ€œawaitâ€-should-not-be-used-redundantlyï¼‰"><a href="#â€œawaitâ€ä¸åº”è¯¥è¢«é‡å¤ä½¿ç”¨ï¼ˆâ€œawaitâ€-should-not-be-used-redundantlyï¼‰" class="headerlink" title="â€œawaitâ€ä¸åº”è¯¥è¢«é‡å¤ä½¿ç”¨ï¼ˆâ€œawaitâ€ should not be used redundantlyï¼‰"></a>â€œawaitâ€ä¸åº”è¯¥è¢«é‡å¤ä½¿ç”¨ï¼ˆ<a href="https://rules.sonarsource.com/javascript/RSPEC-4326" target="_blank" rel="noopener">â€œawaitâ€ should not be used redundantly</a>ï¼‰</h2><p>å¼‚æ­¥å‡½æ•°æ€»æ˜¯å°†è¿”å›å€¼åŒ…è£…åœ¨ Promise ä¸­ã€‚ å› æ­¤ï¼Œä½¿ç”¨ <code>return await</code> æ˜¯å¤šä½™çš„ã€‚</p>
<p>åä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">await</span> foo(); <span class="comment">// Noncompliant</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ­£ä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="keyword">return</span> foo();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="â€œawaitâ€ä¸åº”è¯¥è¢«é‡å¤ä½¿ç”¨ï¼ˆNon-empty-statements-should-change-control-flow-or-have-at-least-one-side-effectï¼‰"><a href="#â€œawaitâ€ä¸åº”è¯¥è¢«é‡å¤ä½¿ç”¨ï¼ˆNon-empty-statements-should-change-control-flow-or-have-at-least-one-side-effectï¼‰" class="headerlink" title="â€œawaitâ€ä¸åº”è¯¥è¢«é‡å¤ä½¿ç”¨ï¼ˆNon-empty statements should change control flow or have at least one side-effectï¼‰"></a>â€œawaitâ€ä¸åº”è¯¥è¢«é‡å¤ä½¿ç”¨ï¼ˆ<a href="https://rules.sonarsource.com/javascript/RSPEC-905" target="_blank" rel="noopener">Non-empty statements should change control flow or have at least one side-effect</a>ï¼‰</h2><p>ä»»ä½•æ²¡æœ‰å‰¯ä½œç”¨ä¸”ä¸ä¼šå¯¼è‡´æ§åˆ¶æµæ”¹å˜çš„è¯­å¥ï¼ˆç©ºè¯­å¥é™¤å¤–ï¼Œè¿™æ„å‘³ç€è¯­å¥åªåŒ…å«ä¸€ä¸ªåˆ†å·;ï¼‰é€šå¸¸ä¼šæŒ‡ç¤ºç¼–ç¨‹é”™è¯¯ï¼Œå› æ­¤åº”è¯¥é‡æ„ã€‚</p>
<p>åä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a == <span class="number">1</span>; <span class="comment">// Noncompliant; was assignment intended?</span></span><br><span class="line"><span class="keyword">var</span> msg = <span class="string">"Hello, "</span></span><br><span class="line">  <span class="string">"World!"</span>; <span class="comment">// Noncompliant; have we forgotten '+' operator on previous line?</span></span><br></pre></td></tr></table></figure>
<h2 id="ç›¸å…³çš„â€œif-else-ifâ€è¯­å¥ä¸åº”å…·æœ‰ç›¸åŒçš„æ¡ä»¶ï¼ˆRelated-â€œif-else-ifâ€-statements-should-not-have-the-same-conditionï¼‰"><a href="#ç›¸å…³çš„â€œif-else-ifâ€è¯­å¥ä¸åº”å…·æœ‰ç›¸åŒçš„æ¡ä»¶ï¼ˆRelated-â€œif-else-ifâ€-statements-should-not-have-the-same-conditionï¼‰" class="headerlink" title="ç›¸å…³çš„â€œif/else ifâ€è¯­å¥ä¸åº”å…·æœ‰ç›¸åŒçš„æ¡ä»¶ï¼ˆRelated â€œif/else ifâ€ statements should not have the same conditionï¼‰"></a>ç›¸å…³çš„â€œif/else ifâ€è¯­å¥ä¸åº”å…·æœ‰ç›¸åŒçš„æ¡ä»¶ï¼ˆ<a href="https://rules.sonarsource.com/javascript/RSPEC-905" target="_blank" rel="noopener">Related â€œif/else ifâ€ statements should not have the same condition</a>ï¼‰</h2><p>ä»ä¸Šåˆ°ä¸‹è¯„ä¼° <code>if/else if</code> è¯­å¥é“¾ã€‚ æœ€å¤šåªä¼šæ‰§è¡Œä¸€ä¸ªåˆ†æ”¯ï¼šç¬¬ä¸€ä¸ªæ¡ä»¶ä¸ºçœŸçš„åˆ†æ”¯ã€‚</p>
<p>å› æ­¤ï¼Œå¤åˆ¶æ¡ä»¶ä¼šè‡ªåŠ¨å¯¼è‡´æ­»ä»£ç ã€‚é€šå¸¸ï¼Œè¿™æ˜¯ç”±äºå¤åˆ¶/ç²˜è´´é”™è¯¯é€ æˆçš„ã€‚å……å…¶é‡åªæ˜¯æ­»ä»£ç ï¼Œæœ€ç³Ÿç³•çš„æ˜¯ï¼Œå®ƒæ˜¯ä¸€ä¸ªé”™è¯¯ï¼Œåœ¨ç»´æŠ¤ä»£ç æ—¶å¯èƒ½ä¼šå¼•å‘æ›´å¤šé”™è¯¯ï¼Œæ˜¾ç„¶å®ƒå¯èƒ½å¯¼è‡´æ„å¤–è¡Œä¸ºã€‚</p>
<p>è¯·æ³¨æ„ï¼Œæ­¤è§„åˆ™è¦æ±‚ Node.js åœ¨åˆ†ææœŸé—´å¯ç”¨ã€‚</p>
<p>åä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (param == <span class="number">1</span>)</span><br><span class="line">  openWindow();</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (param == <span class="number">2</span>)</span><br><span class="line">  closeWindow();</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (param == <span class="number">1</span>)  <span class="comment">// Noncompliant</span></span><br><span class="line">  moveWindowToTheBackground();</span><br></pre></td></tr></table></figure>
<p>æ­£ä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (param == <span class="number">1</span>)</span><br><span class="line">  openWindow();</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (param == <span class="number">2</span>)</span><br><span class="line">  closeWindow();</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (param == <span class="number">3</span>)</span><br><span class="line">  moveWindowToTheBackground();</span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://cleam.github.io/2021/09/23/cognitive-complexity/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Cleam Lee">
      <meta itemprop="description" content="å‰ç«¯ç”Ÿæ¶¯è®°å½•æ€»ç»“">
      <meta itemprop="image" content="/uploads/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è€æ">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2021/09/23/cognitive-complexity/" class="post-title-link" itemprop="https://cleam.github.io/index.html">è®¤çŸ¥å¤æ‚åº¦ï¼ˆcognitive complexity ï¼‰</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              
                
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-09-23 09:44:30 / ä¿®æ”¹æ—¶é—´ï¼š19:51:25" itemprop="dateCreated datePublished" datetime="2021-09-23T09:44:30+08:00">2021-09-23</time>
            

            
              

              
            
          </span>

          

          
            
              <span class="post-comments-count">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              
                <a href="/2021/09/23/cognitive-complexity/#SOHUCS" itemprop="discussionUrl">
                  <span class="post-meta-item-text">è¯„è®ºæ•°ï¼š</span> <span id="url::https://cleam.github.io/2021/09/23/cognitive-complexity/" class="cy_cmt_count" data-xid="2021/09/23/cognitive-complexity/" itemprop="commentsCount"></span>
                </a>
              
            
          

          
          

          

          

          

        </span></div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>2021 å¹´ 4 æœˆ 5 æ—¥ï¼Œ1.5 ç‰ˆæœ¬</p>
</blockquote>
<h2 id="æ‘˜è¦"><a href="#æ‘˜è¦" class="headerlink" title="æ‘˜è¦"></a>æ‘˜è¦</h2><p>åœˆå¤æ‚åº¦ï¼ˆCyclomatic Complexityï¼‰æœ€åˆè¢«è¡¨è¿°ä¸ºå¯¹æ¨¡å—æ§åˆ¶æµçš„â€œå¯æµ‹è¯•æ€§å’Œå¯ç»´æŠ¤æ€§â€çš„åº¦é‡ã€‚ è™½ç„¶å®ƒæ“…é•¿æµ‹é‡å‰è€…ï¼Œä½†å…¶åŸºç¡€æ•°å­¦æ¨¡å‹åœ¨äº§ç”Ÿæµ‹é‡åè€…çš„å€¼æ–¹é¢å¹¶ä¸ä»¤äººæ»¡æ„ã€‚æœ¬ç™½çš®ä¹¦æè¿°äº†ä¸€ç§æ–°æŒ‡æ ‡ï¼Œå®ƒæ‰“ç ´äº†ä½¿ç”¨æ•°å­¦æ¨¡å‹æ¥è¯„ä¼°ä»£ç çš„æ–¹å¼ï¼Œä»¥å¼¥è¡¥åœˆå¤æ‚åº¦çš„ç¼ºç‚¹ï¼Œå¹¶äº§ç”Ÿä¸€ç§æ›´å‡†ç¡®åœ°åæ˜ ç†è§£éš¾åº¦çš„åº¦é‡æŒ‡æ ‡ï¼Œä»è€Œæ›´å‡†ç¡®åœ°åæ˜ ç»´æŠ¤æ–¹æ³•ã€ç±»å’Œåº”ç”¨ç¨‹åºçš„ç›¸å¯¹éš¾åº¦ã€‚</p>
<h2 id="æœ¯è¯­è§£é‡Š"><a href="#æœ¯è¯­è§£é‡Š" class="headerlink" title="æœ¯è¯­è§£é‡Š"></a>æœ¯è¯­è§£é‡Š</h2><p>è™½ç„¶è®¤çŸ¥å¤æ‚åº¦æ˜¯ä¸€ç§ä¸è¯­è¨€æ— å…³çš„åº¦é‡æ ‡å‡†ï¼Œå®ƒåŒæ ·é€‚ç”¨äºæ–‡ä»¶ï¼ˆfilesï¼‰å’Œç±»ï¼ˆclassesï¼‰ï¼Œä»¥åŠæ–¹æ³•ï¼ˆmethodsï¼‰ã€è¿‡ç¨‹ï¼ˆproceduresï¼‰ã€å‡½æ•°ï¼ˆfunctionsï¼‰ç­‰ï¼Œä½†ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œä½¿ç”¨äº†é¢å‘å¯¹è±¡çš„æœ¯è¯­â€œ<code>ç±»ï¼ˆclassï¼‰</code>â€å’Œâ€œ<code>æ–¹æ³•ï¼ˆmethodï¼‰</code>â€ã€‚</p>
<h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>Thomas J. McCabe çš„åœˆå¤æ‚åº¦é•¿æœŸä»¥æ¥ä¸€ç›´æ˜¯è¡¡é‡æ–¹æ³•æ§åˆ¶æµå¤æ‚åº¦çš„äº‹å®æ ‡å‡†ã€‚å®ƒæœ€åˆçš„ç›®çš„æ˜¯â€œè¯†åˆ«éš¾ä»¥æµ‹è¯•æˆ–ç»´æŠ¤çš„è½¯ä»¶æ¨¡å—â€[1]ï¼Œä½†è™½ç„¶å®ƒå‡†ç¡®è®¡ç®—äº†å®Œå…¨è¦†ç›–ä¸€ä¸ªæ–¹æ³•æ‰€éœ€çš„æœ€å°‘æµ‹è¯•ç”¨ä¾‹æ•°ï¼Œä½†å®ƒå¹¶ä¸æ˜¯ä¸€ä¸ªä»¤äººæ»¡æ„çš„å¯ç†è§£æ€§åº¦é‡ã€‚è¿™æ˜¯å› ä¸ºå…·æœ‰ç›¸åŒåœˆå¤æ‚åº¦çš„æ–¹æ³•ä¸ä¸€å®šç»™ç»´æŠ¤è€…å¸¦æ¥ç›¸åŒçš„éš¾åº¦ï¼Œå¯¼è‡´æµ‹é‡é€šè¿‡é«˜ä¼°æŸäº›ç»“æ„è€Œä½ä¼°å…¶ä»–ç»“æ„çš„â€œå‡è±¡â€ã€‚</p>
<p>åŒæ—¶ï¼Œåœˆå¤æ‚åº¦ä¸å†æ˜¯å…¨é¢çš„ã€‚å®ƒäº 1976 å¹´åœ¨ Fortran ç¯å¢ƒä¸­åˆ¶å®šï¼Œä¸åŒ…æ‹¬ç°ä»£è¯­è¨€ç»“æ„ï¼Œå¦‚<code>try/catch</code>å’Œ<code>lambdas</code>ã€‚</p>
<p>æœ€åï¼Œå› ä¸ºæ¯ä¸ªæ–¹æ³•çš„æœ€å°åœˆå¤æ‚åº¦åˆ†æ•°ä¸º 1ï¼Œæ‰€ä»¥ä¸å¯èƒ½çŸ¥é“ä»»ä½•å…·æœ‰é«˜èšåˆåœˆå¤æ‚åº¦çš„ç»™å®šç±»æ˜¯å±äºå¤§å‹çš„ã€æ˜“äºç»´æŠ¤çš„ç±»è¿˜æ˜¯å…·æœ‰å¤æ‚æ§åˆ¶æµçš„å°ç±»ã€‚é™¤äº†<code>ç±»çº§åˆ«</code>ä¹‹å¤–ï¼Œäººä»¬æ™®éè®¤ä¸ºåº”ç”¨ç¨‹åºçš„åœˆå¤æ‚åº¦åˆ†æ•°ä¸å…¶ä»£ç è¡Œæ€»æ•°ç›¸å…³ã€‚æ¢å¥è¯è¯´ï¼Œåœˆå¤æ‚åº¦åœ¨<code>æ–¹æ³•çº§åˆ«</code>ä¹‹ä¸Šå‡ ä¹æ²¡æœ‰ç”¨å¤„ã€‚</p>
<p>ä½œä¸ºè¿™äº›é—®é¢˜çš„è¡¥æ•‘æªæ–½ï¼Œè®¤çŸ¥å¤æ‚åº¦ï¼ˆCognitive Complexityï¼‰å·²è¢«åˆ¶å®šäºè§£å†³ç°ä»£è¯­è¨€ç»“æ„ï¼Œå¹¶åœ¨ç±»å’Œåº”ç”¨ç¨‹åºçº§åˆ«äº§ç”Ÿæœ‰æ„ä¹‰çš„å€¼ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œå®ƒè„±ç¦»äº†åŸºäºæ•°å­¦æ¨¡å‹è¯„ä¼°ä»£ç çš„å®è·µï¼Œå› æ­¤å®ƒå¯ä»¥äº§ç”Ÿä¸ç¨‹åºå‘˜å¯¹ç†è§£è¿™äº›æµç¨‹æ‰€éœ€çš„å¿ƒç†æˆ–è®¤çŸ¥ç›¸å¯¹åº”çš„æ§åˆ¶æµè¯„ä¼°ã€‚</p>
<h2 id="ä¸¾ä¾‹è¯´æ˜"><a href="#ä¸¾ä¾‹è¯´æ˜" class="headerlink" title="ä¸¾ä¾‹è¯´æ˜"></a>ä¸¾ä¾‹è¯´æ˜</h2><p>ä»¥å®ƒæ—¨åœ¨è§£å†³çš„é—®é¢˜ä¸ºä¾‹ï¼Œå¼€å§‹è®¨è®ºè®¤çŸ¥å¤æ‚æ€§æ˜¯å¾ˆæœ‰ç”¨çš„ã€‚ ä»¥ä¸‹ä¸¤ç§æ–¹æ³•å…·æœ‰ç›¸åŒçš„åœˆå¤æ‚åº¦ï¼Œä½†åœ¨å¯ç†è§£æ€§æ–¹é¢å´æˆªç„¶ä¸åŒã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç¤ºä¾‹1ï¼š</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sumOfPrimes</span><span class="params">(<span class="keyword">int</span> max)</span> </span>&#123; <span class="comment">// +1</span></span><br><span class="line">  <span class="keyword">int</span> total = <span class="number">0</span>;</span><br><span class="line">  OUT: <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= max; ++i) &#123; <span class="comment">// +1</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">2</span>; j &lt; i; ++j) &#123; <span class="comment">// +1</span></span><br><span class="line">      <span class="keyword">if</span> (i % j == <span class="number">0</span>) &#123; <span class="comment">// +1</span></span><br><span class="line">        <span class="keyword">continue</span> OUT;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    total += i;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> total;</span><br><span class="line">&#125; <span class="comment">// Cyclomatic Complexity 4</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¤ºä¾‹2ï¼š</span></span><br><span class="line"><span class="function">String <span class="title">getWords</span><span class="params">(<span class="keyword">int</span> number)</span> </span>&#123; <span class="comment">// +1</span></span><br><span class="line">  <span class="keyword">switch</span> (number) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>: <span class="comment">// +1</span></span><br><span class="line">      <span class="keyword">return</span> <span class="string">"one"</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>: <span class="comment">// +1</span></span><br><span class="line">      <span class="keyword">return</span> <span class="string">"a couple"</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3</span>: <span class="comment">// +1</span></span><br><span class="line">      <span class="keyword">return</span> â€œa fewâ€;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="string">"lots"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="comment">// Cyclomatic Complexity 4</span></span><br></pre></td></tr></table></figure>
<p><strong>åœˆå¤æ‚åº¦ï¼ˆCyclomatic Complexityï¼‰</strong>åº•å±‚çš„æ•°å­¦æ¨¡å‹èµ‹äºˆè¿™ä¸¤ç§æ–¹æ³•åŒç­‰çš„æƒé‡ï¼Œä½†ä»ç›´è§‚ä¸Šçœ‹ï¼Œ<code>sumOfPrimes</code>çš„æ§åˆ¶æµç¨‹æ¯”<code>getWords</code>çš„æ§åˆ¶æµç¨‹æ›´éš¾ç†è§£ã€‚ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ<strong>è®¤çŸ¥å¤æ‚åº¦ï¼ˆCognitive Complexityï¼‰</strong>æ”¾å¼ƒä½¿ç”¨æ•°å­¦æ¨¡å‹æ¥è¯„ä¼°æ§åˆ¶æµï¼Œè½¬è€Œä½¿ç”¨ä¸€ç»„ç®€å•çš„è§„åˆ™å°†ç¨‹åºå‘˜çš„ç›´è§‰è½¬åŒ–ä¸ºæ•°å­—ã€‚</p>
<h2 id="ï¼ˆè¡¡é‡ï¼‰åŸºæœ¬æ ‡å‡†å’Œæ–¹æ³•"><a href="#ï¼ˆè¡¡é‡ï¼‰åŸºæœ¬æ ‡å‡†å’Œæ–¹æ³•" class="headerlink" title="ï¼ˆè¡¡é‡ï¼‰åŸºæœ¬æ ‡å‡†å’Œæ–¹æ³•"></a>ï¼ˆè¡¡é‡ï¼‰åŸºæœ¬æ ‡å‡†å’Œæ–¹æ³•</h2><p>è®¤çŸ¥å¤æ‚åº¦åˆ†æ•°æ ¹æ®ä¸‰ä¸ªåŸºæœ¬è§„åˆ™è¿›è¡Œè¯„ä¼°ï¼š</p>
<ol>
<li><strong>å¿½ç•¥</strong>å…è®¸å°†å¤šä¸ªè¯­å¥æ˜“äºç†è§£åœ°<strong>ç®€å†™</strong>æˆä¸€ä¸ªçš„æƒ…å†µ</li>
<li>åœ¨ä»£ç çº¿æ€§æµç¨‹ä¸­çš„æ¯ä¸€æ¬¡ä¸­æ–­éƒ½å¢åŠ ï¼ˆ+1ï¼‰ï¼ˆå¤æ‚åº¦ï¼‰</li>
<li>æ–­æµç»“æ„åµŒå¥—æ—¶å¢åŠ ï¼ˆå¤æ‚åº¦ï¼‰</li>
</ol>
<p>æ­¤å¤–ï¼Œå¤æ‚æ€§åˆ†æ•°ç”±å››ç§ä¸åŒç±»å‹çš„å¢é‡ç»„æˆï¼š</p>
<p>A. åµŒå¥—ï¼ˆNestingï¼‰ - è¯„ä¼°åœ¨å½¼æ­¤å†…éƒ¨åµŒå¥—æ§åˆ¶æµç»“æ„<br>B. ç»“æ„åŒ–ï¼ˆStructuralï¼‰ - å¯¹å—åµŒå¥—å¢é‡å½±å“å¹¶å¢åŠ åµŒå¥—è®¡æ•°çš„æ§åˆ¶æµç»“æ„è¿›è¡Œè¯„ä¼°<br>C. åŸºæœ¬ï¼ˆFundamentalï¼‰ - è¯„ä¼°ä¸å—åµŒå¥—å¢é‡çº¦æŸçš„è¯­å¥<br>D. æ··åˆï¼ˆHybridï¼‰ - å¯¹ä¸å—åµŒå¥—å¢é‡å½±å“ä½†ç¡®å®å¢åŠ åµŒå¥—è®¡æ•°çš„æ§åˆ¶æµç»“æ„è¿›è¡Œè¯„ä¼°</p>
<p>è™½ç„¶å¢é‡çš„ç±»å‹åœ¨æ•°å­¦ä¸Šæ²¡æœ‰åŒºåˆ« - æ¯ä¸ªå¢é‡éƒ½ä¼šåœ¨æœ€ç»ˆåˆ†æ•°ä¸Š+1 - åŒºåˆ†æ­£åœ¨è®¡ç®—çš„ç‰¹å¾ç±»åˆ«å¯ä»¥æ›´å®¹æ˜“åœ°ç†è§£åµŒå¥—å¢é‡é€‚ç”¨å’Œä¸é€‚ç”¨çš„åœ°æ–¹ã€‚</p>
<p>è¿™äº›è§„åˆ™åŠå…¶èƒŒåçš„åŸåˆ™å°†åœ¨ä»¥ä¸‹å„èŠ‚ä¸­è¿›ä¸€æ­¥è¯¦è¿°ã€‚</p>
<h2 id="å¿½ç•¥ç®€å†™"><a href="#å¿½ç•¥ç®€å†™" class="headerlink" title="å¿½ç•¥ç®€å†™"></a>å¿½ç•¥ç®€å†™</h2><p>åˆ¶å®šè®¤çŸ¥å¤æ‚åº¦çš„ä¸€ä¸ªæŒ‡å¯¼åŸåˆ™æ˜¯å®ƒåº”è¯¥æ¿€åŠ±è‰¯å¥½çš„ç¼–ç å®è·µã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒåº”è¯¥å¿½ç•¥æˆ–å¿½ç•¥ä½¿ä»£ç æ›´å…·å¯è¯»æ€§çš„åŠŸèƒ½ã€‚</p>
<p>æ–¹æ³•ç»“æ„æœ¬èº«å°±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ã€‚å°†ä»£ç åˆ†è§£æˆæ–¹æ³•å…è®¸æ‚¨å°†å¤šä¸ªè¯­å¥å‹ç¼©æˆä¸€ä¸ªå•ä¸€çš„ã€ä»¤äººå›å‘³çš„å‘½åè°ƒç”¨ï¼Œå³â€œç®€å†™â€å®ƒã€‚å› æ­¤ï¼Œæ–¹æ³•çš„è®¤çŸ¥å¤æ‚åº¦ä¸ä¼šå¢åŠ ã€‚</p>
<p>è®¤çŸ¥å¤æ‚åº¦è¿˜å¿½ç•¥äº†åœ¨è®¸å¤šè¯­è¨€ä¸­å‘ç°çš„ç©ºåˆå¹¶è¿ç®—ç¬¦ï¼ŒåŒæ ·æ˜¯å› ä¸ºå®ƒä»¬å…è®¸å°†å¤šè¡Œä»£ç ç®€å†™ä¸ºä¸€è¡Œã€‚ ä¾‹å¦‚ï¼Œä»¥ä¸‹ä¸¤ä¸ªä»£ç ç¤ºä¾‹æ‰§è¡Œç›¸åŒçš„æ“ä½œï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç¤ºä¾‹1ï¼š</span></span><br><span class="line">MyObj myObj = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (a != <span class="keyword">null</span>) &#123;</span><br><span class="line">   myObj = a.myObj;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ç¤ºä¾‹2ï¼š</span></span><br><span class="line">MyObj myObj = a?.myObj;</span><br></pre></td></tr></table></figure>
<p>ç¤ºä¾‹ 1 çš„å«ä¹‰éœ€è¦ä¸€ç‚¹æ—¶é—´æ¥å¤„ç†ï¼Œè€Œä¸€æ—¦æ‚¨ç†è§£äº†ç©ºåˆå¹¶è¯­æ³•ï¼Œç¤ºä¾‹ 2 çš„å«ä¹‰å°±ä¼šç«‹å³æ¸…æ™°ã€‚ å‡ºäºè¿™ä¸ªåŸå› ï¼Œè®¤çŸ¥å¤æ‚åº¦ä¼šå¿½ç•¥ç©ºåˆå¹¶è¿ç®—ç¬¦ã€‚</p>
<h2 id="çº¿æ€§æµä¸­æ–­çš„å¢é‡ï¼ˆIncrement-for-breaks-in-the-linear-flowï¼‰"><a href="#çº¿æ€§æµä¸­æ–­çš„å¢é‡ï¼ˆIncrement-for-breaks-in-the-linear-flowï¼‰" class="headerlink" title="çº¿æ€§æµä¸­æ–­çš„å¢é‡ï¼ˆIncrement for breaks in the linear flowï¼‰"></a>çº¿æ€§æµä¸­æ–­çš„å¢é‡ï¼ˆIncrement for breaks in the linear flowï¼‰</h2><p>è®¤çŸ¥å¤æ‚åº¦çš„å¦ä¸€ä¸ªæŒ‡å¯¼åŸåˆ™æ˜¯ï¼Œï¼ˆä»ä¸Šåˆ°ä¸‹ã€ä»å·¦åˆ°å³çš„æ­£å¸¸çº¿æ€§æµç¨‹ä¸­çš„ï¼‰ç ´åæ€§ä»£ç ç»“æ„ä¼šå¢åŠ ç»´æŠ¤äººå‘˜çš„ç†è§£éš¾åº¦ã€‚ä¸ºäº†æ‰¿è®¤è¿™ç§é¢å¤–çš„åŠªåŠ›ï¼Œè®¤çŸ¥å¤æ‚åº¦è¯„ä¼°äº†ä»¥ä¸‹æ–¹é¢çš„ç»“æ„å¢é‡ï¼š</p>
<ul>
<li>å¾ªç¯ï¼š<code>for, while, do while, ...</code></li>
<li>æ¡ä»¶ï¼š<code>ä¸‰å…ƒè¿ç®—ç¬¦ã€if, #if, #ifdef, ...</code></li>
</ul>
<p>è¯„ä¼°æ··åˆå¢é‡ï¼š</p>
<ul>
<li><code>else if, elif, else, â€¦</code></li>
</ul>
<p>å®ƒæ²¡æœ‰è¯„ä¼°è¿™äº›ç»“æ„çš„åµŒå¥—å¢é‡ï¼Œå› ä¸ºåœ¨é˜…è¯»<code>if</code>æ—¶å·²ç»è®¡ç®—äº†è®¤çŸ¥æˆæœ¬ã€‚ï¼ˆNo nesting increment is assessed for these structures because the mental cost has already been paid when reading the if.ï¼‰</p>
<p>å¯¹äºä¹ æƒ¯äº†åœˆå¤æ‚åº¦çš„äººæ¥è¯´ï¼Œè¿™äº›å¢é‡ç›®æ ‡ä¼¼ä¹å¾ˆç†Ÿæ‚‰ã€‚æ­¤å¤–ï¼Œè®¤çŸ¥å¤æ‚åº¦ä¹Ÿä¼šå¢åŠ ï¼š</p>
<p><strong>Catches</strong>ï¼š</p>
<p><code>catch</code>å’Œ<code>if</code>ä¸€æ ·ä»£è¡¨æ§åˆ¶æµä¸­çš„ä¸€ç§åˆ†æ”¯ã€‚å› æ­¤ï¼Œæ¯ä¸ª<code>catch</code>å­å¥éƒ½ä¼šå¯¼è‡´è®¤çŸ¥å¤æ‚åº¦çš„å¢åŠ ã€‚è¯·æ³¨æ„ï¼Œæ— è®º<code>catch</code>åˆ°å¤šå°‘å¼‚å¸¸ï¼Œ<code>catch</code>éƒ½åªä¼šä¸ºè®¤çŸ¥å¤æ‚åº¦å¢åŠ  1 åˆ†ã€‚<code>try</code>å’Œ<code>finally</code>å—è¢«å®Œå…¨å¿½ç•¥ã€‚</p>
<p><strong>Switches</strong>ï¼š</p>
<p>ä¸€ä¸ª<code>switch</code>å’Œå®ƒæ‰€æœ‰çš„<code>case</code>ç»„åˆåœ¨ä¸€èµ·ä¼šäº§ç”Ÿä¸€ä¸ªå•ä¸€çš„ç»“æ„å¢é‡ã€‚</p>
<p>åœ¨åœˆå¤æ‚åº¦ä¸‹ï¼Œ<code>switch</code>è¢«è§†ä¸º<code>if-else if é“¾</code>çš„æ¨¡æ‹Ÿã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>switch</code>ä¸­çš„æ¯ç§æƒ…å†µéƒ½ä¼šå¯¼è‡´å¢é‡ï¼Œå› ä¸ºå®ƒä¼šå¯¼è‡´æ§åˆ¶æµçš„æ•°å­¦æ¨¡å‹ä¸­å‡ºç°åˆ†æ”¯ã€‚</p>
<p>ä½†æ˜¯ä»ç»´æŠ¤è€…çš„è§’åº¦æ¥çœ‹ï¼Œä¸€ä¸ª<code>switch</code> â€”â€” å°†å•ä¸ªå˜é‡ä¸ä¸€ç»„æ˜ç¡®å‘½åçš„æ–‡å­—å€¼è¿›è¡Œæ¯”è¾ƒ â€”â€” æ¯” <code>if-else if é“¾</code>æ›´å®¹æ˜“ç†è§£ï¼Œå› ä¸ºåè€…å¯ä»¥ä½¿ç”¨ä»»æ„æ•°é‡çš„å˜é‡å’Œå€¼è¿›è¡Œä»»æ„æ•°é‡çš„æ¯”è¾ƒã€‚</p>
<p>ç®€è€Œè¨€ä¹‹ï¼Œ<code>if-else if é“¾</code>ï¼ˆç»“æ„çš„ä»£ç ï¼‰å¿…é¡»ä»”ç»†é˜…è¯»ï¼Œè€Œ<code>switch</code>é€šå¸¸å¯ä»¥ä¸€ç›®äº†ç„¶ã€‚</p>
<p><strong>Sequences of logical operatorsï¼ˆé€»è¾‘è¿ç®—ç¬¦åºåˆ—ï¼‰</strong>ï¼š</p>
<p>å‡ºäºç±»ä¼¼çš„åŸå› ï¼Œè®¤çŸ¥å¤æ‚åº¦ä¸ä¼šå› æ¯ä¸ªäºŒå…ƒé€»è¾‘è¿ç®—ç¬¦è€Œå¢åŠ ã€‚ç›¸åï¼Œå®ƒè¯„ä¼°æ¯ä¸ªäºŒå…ƒé€»è¾‘è¿ç®—ç¬¦åºåˆ—çš„åŸºæœ¬å¢é‡ã€‚ ä¾‹å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç¤ºä¾‹1ï¼š</span></span><br><span class="line">a &amp;&amp; b</span><br><span class="line">a &amp;&amp; b &amp;&amp; c &amp;&amp; d</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¤ºä¾‹2ï¼š</span></span><br><span class="line">a || b</span><br><span class="line">a || b || c || d</span><br></pre></td></tr></table></figure>
<p>ç†è§£ä¸Šè¿° 2 ä¸ªç¤ºä¾‹ä¸­çš„ç¬¬äºŒè¡Œå¹¶ä¸æ¯”ç†è§£ç¬¬ä¸€è¡Œéš¾ã€‚ å¦ä¸€æ–¹é¢ï¼Œç†è§£ä»¥ä¸‹ä¸¤è¡Œå´æœ‰æ˜¾ç€å·®å¼‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a &amp;&amp; b &amp;&amp; c &amp;&amp; d</span><br><span class="line">a || b &amp;&amp; c || d</span><br></pre></td></tr></table></figure>
<p>å› ä¸ºæ··åˆè¿ç®—ç¬¦ä½¿å¸ƒå°”è¡¨è¾¾å¼å˜å¾—æ›´åŠ éš¾ä»¥ç†è§£ï¼Œå› æ­¤å¯¹äºç±»ä¼¼è¿ç®—ç¬¦çš„æ¯ä¸ªæ–°åºåˆ—ï¼Œè®¤çŸ¥å¤æ‚åº¦éƒ½ä¼šå¢åŠ ã€‚ ä¾‹å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (a         <span class="comment">// +1 for `if`</span></span><br><span class="line">  &amp;&amp; b &amp;&amp; c   <span class="comment">// +1</span></span><br><span class="line">  || d || e   <span class="comment">// +1</span></span><br><span class="line">  &amp;&amp; f)       <span class="comment">// +1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (a         <span class="comment">// +1 for `if`</span></span><br><span class="line">  &amp;&amp;          <span class="comment">// +1</span></span><br><span class="line">  !(b &amp;&amp; c))  <span class="comment">// +1</span></span><br></pre></td></tr></table></figure>
<p>è™½ç„¶è®¤çŸ¥å¤æ‚åº¦ä¸ºç›¸å¯¹äºåœˆå¤æ‚åº¦çš„ç±»ä¼¼è¿ç®—ç¬¦æä¾›äº†â€œæŠ˜æ‰£â€ï¼Œä½†å®ƒç¡®å®ä¼šå¢åŠ æ‰€æœ‰äºŒè¿›åˆ¶å¸ƒå°”è¿ç®—ç¬¦åºåˆ—ï¼Œä¾‹å¦‚å˜é‡èµ‹å€¼ã€æ–¹æ³•è°ƒç”¨å’Œè¿”å›è¯­å¥ä¸­çš„è¿ç®—ç¬¦ã€‚</p>
<p><strong>Recursionï¼ˆé€’å½’ï¼‰</strong>ï¼š</p>
<p>ä¸åœˆå¤æ‚åº¦ä¸åŒï¼Œæ— è®ºæ˜¯ç›´æ¥çš„è¿˜æ˜¯é—´æ¥çš„ï¼Œè®¤çŸ¥å¤æ‚åº¦ä¸ºé€’å½’å¾ªç¯ä¸­çš„æ¯ä¸ªæ–¹æ³•æ·»åŠ ä¸€ä¸ªåŸºæœ¬å¢é‡ã€‚ è¿™ä¸ªå†³å®šæœ‰ä¸¤ä¸ªåŠ¨æœºã€‚ é¦–å…ˆï¼Œé€’å½’ä»£è¡¨ä¸€ç§â€œå…ƒå¾ªç¯â€ï¼Œå¹¶ä¸”å¾ªç¯çš„è®¤çŸ¥å¤æ‚åº¦é€’å¢ã€‚å…¶æ¬¡ï¼Œè®¤çŸ¥å¤æ‚åº¦æ˜¯å…³äºä¼°è®¡ç†è§£ä¸€ä¸ªæ–¹æ³•çš„æ§åˆ¶æµçš„ç›¸å¯¹éš¾åº¦ï¼Œç”šè‡³ä¸€äº›ç»éªŒä¸°å¯Œçš„ç¨‹åºå‘˜ä¹Ÿå‘ç°é€’å½’éš¾ä»¥ç†è§£ã€‚</p>
<p><strong>Jumps to labelsï¼ˆè·³è½¬æ ‡ç­¾ï¼‰</strong>ï¼š</p>
<p><code>goto</code>ä¸ºè®¤çŸ¥å¤æ‚åº¦æ·»åŠ äº†ä¸€ä¸ªåŸºæœ¬å¢é‡ï¼Œå°±åƒ<code>break</code>æˆ–<code>continue</code>åˆ°æ ‡ç­¾å’Œå…¶ä»–å¤šçº§è·³è½¬ï¼Œä¾‹å¦‚<code>break</code>æˆ–<code>continue</code>åˆ°æŸäº›è¯­è¨€ä¸­çš„æ•°å­—ã€‚ä½†æ˜¯å› ä¸ºæå‰è¿”å›é€šå¸¸å¯ä»¥ä½¿ä»£ç æ›´æ¸…æ™°ï¼Œæ‰€ä»¥å…¶ä»–è·³è½¬æˆ–æå‰é€€å‡ºä¸ä¼šå¯¼è‡´å¢é‡ã€‚</p>
<h2 id="åµŒå¥—æ–­æµç»“æ„çš„å¢é‡ï¼ˆIncrement-for-nested-flow-break-structuresï¼‰"><a href="#åµŒå¥—æ–­æµç»“æ„çš„å¢é‡ï¼ˆIncrement-for-nested-flow-break-structuresï¼‰" class="headerlink" title="åµŒå¥—æ–­æµç»“æ„çš„å¢é‡ï¼ˆIncrement for nested flow-break structuresï¼‰"></a>åµŒå¥—æ–­æµç»“æ„çš„å¢é‡ï¼ˆIncrement for nested flow-break structuresï¼‰</h2><p>ä»ç›´è§‰ä¸Šçœ‹ï¼Œäº”ä¸ª if å’Œ for ç»“æ„çš„çº¿æ€§ç³»åˆ—æ¯”è¿ç»­åµŒå¥—çš„äº”ä¸ªç›¸åŒçš„ç»“æ„æ›´å®¹æ˜“ç†è§£ï¼Œæ— è®ºé€šè¿‡æ¯ä¸ªç³»åˆ—çš„æ‰§è¡Œè·¯å¾„çš„æ•°é‡å¦‚ä½•ã€‚ ç”±äºè¿™ç§åµŒå¥—å¢åŠ äº†ç†è§£ä»£ç çš„å¿ƒç†éœ€æ±‚ï¼Œå› æ­¤è®¤çŸ¥å¤æ‚åº¦è¯„ä¼°äº†å®ƒçš„åµŒå¥—å¢é‡ã€‚</p>
<p>å…·ä½“æ¥è¯´ï¼Œæ¯æ¬¡å¯¼è‡´ç»“æ„æˆ–æ··åˆå¢é‡çš„ç»“æ„åµŒå¥—åœ¨å¦ä¸€ä¸ªè¿™æ ·çš„ç»“æ„ä¸­æ—¶ï¼Œæ¯ä¸ªåµŒå¥—çº§åˆ«éƒ½ä¼šæ·»åŠ ä¸€ä¸ªåµŒå¥—å¢é‡ã€‚ä¾‹å¦‚ï¼Œåœ¨ä»¥ä¸‹ç¤ºä¾‹ä¸­ï¼Œæ–¹æ³•æœ¬èº«æˆ–<code>try</code>æ²¡æœ‰åµŒå¥—å¢é‡ï¼Œå› ä¸ºè¿™ä¸¤ç§ç»“æ„éƒ½ä¸ä¼šå¯¼è‡´ç»“æ„æ€§å¢é‡æˆ–æ··åˆå¢é‡ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">myMethod</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (condition1) &#123; <span class="comment">// +1</span></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123; <span class="comment">// +2 (nesting=1)</span></span><br><span class="line">        <span class="keyword">while</span> (condition2) &#123; â€¦ &#125; <span class="comment">// +3 (nesting=2)</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (ExcepType1 | ExcepType2 e) &#123; <span class="comment">// +1</span></span><br><span class="line">    <span class="keyword">if</span> (condition2) &#123; â€¦ &#125; <span class="comment">// +2 (nesting=1)</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="comment">// Cognitive Complexity 9</span></span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯ï¼Œ<code>ifã€forã€while å’Œ catch</code>ç»“æ„éƒ½å—ç»“æ„å’ŒåµŒå¥—å¢é‡çš„å½±å“ã€‚</p>
<p>æ­¤å¤–ï¼Œè™½ç„¶é¡¶çº§æ–¹æ³•è¢«å¿½ç•¥ï¼Œå¹¶ä¸” lambdasã€åµŒå¥—æ–¹æ³•å’Œç±»ä¼¼åŠŸèƒ½æ²¡æœ‰ç»“æ„å¢é‡ï¼Œä½†å½“åµŒå¥—åœ¨å…¶ä»–ç±»ä¼¼æ–¹æ³•çš„ç»“æ„ä¸­æ—¶ï¼Œè¿™äº›æ–¹æ³•ç¡®å®ä¼šå¢åŠ åµŒå¥—çº§åˆ«ï¼š</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">myMethod2</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">  Runnable r = () -&gt; &#123; <span class="comment">// +0 (but nesting level is now 1)</span></span><br><span class="line">    <span class="keyword">if</span> (condition1) &#123; â€¦ &#125; <span class="comment">// +2 (nesting=1)</span></span><br><span class="line">  &#125;;</span><br><span class="line">&#125; <span class="comment">// Cognitive Complexity 2</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#if DEBUG // +1 for if</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">myMethod2</span> <span class="params">()</span> </span>&#123; <span class="comment">// +0 (nesting level is still 0)</span></span><br><span class="line">  Runnable r = () -&gt; &#123; <span class="comment">// +0 (but nesting level is now 1)</span></span><br><span class="line">    <span class="keyword">if</span> (condition1) &#123; â€¦ &#125; <span class="comment">// +3 (nesting=2)</span></span><br><span class="line">  &#125;;</span><br><span class="line">&#125; <span class="comment">// Cognitive Complexity 4</span></span><br><span class="line">#endif</span><br></pre></td></tr></table></figure>
<h2 id="å½±å“"><a href="#å½±å“" class="headerlink" title="å½±å“"></a>å½±å“</h2><p>åˆ¶å®šè®¤çŸ¥å¤æ‚åº¦çš„ä¸»è¦ç›®æ ‡æ˜¯è®¡ç®—æ›´å‡†ç¡®åœ°åæ˜ æ–¹æ³•çš„ç›¸å¯¹å¯ç†è§£æ€§çš„æ–¹æ³•åˆ†æ•°ï¼Œå…¶æ¬¡è¦ç›®æ ‡æ˜¯è§£å†³ç°ä»£è¯­è¨€ç»“æ„å¹¶äº§ç”Ÿåœ¨æ–¹æ³•å±‚é¢ä¸Šæœ‰ä»·å€¼çš„æŒ‡æ ‡ã€‚æ˜¾ç„¶ï¼Œè§£å†³ç°ä»£è¯­è¨€ç»“æ„çš„ç›®æ ‡å·²ç»å®ç°ã€‚ä¸‹é¢æ£€æŸ¥å¦å¤–ä¸¤ä¸ªç›®æ ‡ã€‚</p>
<h3 id="ç›´è§‚çš„â€œæ­£ç¡®â€å¤æ‚åº¦åˆ†æ•°ï¼ˆIntuitively-â€˜rightâ€™-complexity-scoresï¼‰"><a href="#ç›´è§‚çš„â€œæ­£ç¡®â€å¤æ‚åº¦åˆ†æ•°ï¼ˆIntuitively-â€˜rightâ€™-complexity-scoresï¼‰" class="headerlink" title="ç›´è§‚çš„â€œæ­£ç¡®â€å¤æ‚åº¦åˆ†æ•°ï¼ˆIntuitively â€˜rightâ€™ complexity scoresï¼‰"></a>ç›´è§‚çš„â€œæ­£ç¡®â€å¤æ‚åº¦åˆ†æ•°ï¼ˆIntuitively â€˜rightâ€™ complexity scoresï¼‰</h3><p>è¿™ä¸ªè®¨è®ºä»ä¸€å¯¹å…·æœ‰ç›¸åŒåœˆå¤æ‚åº¦ä½†æ˜æ˜¾ä¸åŒçš„å¯ç†è§£æ€§çš„æ–¹æ³•å¼€å§‹ã€‚ ç°åœ¨æ˜¯æ—¶å€™é‡æ–°æ£€æŸ¥è¿™äº›æ–¹æ³•å¹¶è®¡ç®—å®ƒä»¬çš„è®¤çŸ¥å¤æ‚æ€§åˆ†æ•°äº†ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sumOfPrimes</span><span class="params">(<span class="keyword">int</span> max)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> total = <span class="number">0</span>;</span><br><span class="line">  OUT: <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= max; ++i) &#123; <span class="comment">// +1</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">2</span>; j &lt; i; ++j) &#123; <span class="comment">// +2</span></span><br><span class="line">      <span class="keyword">if</span> (i % j == <span class="number">0</span>) &#123; <span class="comment">// +3</span></span><br><span class="line">        <span class="keyword">continue</span> OUT; <span class="comment">// +1</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    total += i;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> total;</span><br><span class="line">&#125; <span class="comment">// Cognitive Complexity 7</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">String <span class="title">getWords</span><span class="params">(<span class="keyword">int</span> number)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">switch</span> (number) &#123; <span class="comment">// +1</span></span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="string">"one"</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="string">"a couple"</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">      <span class="keyword">return</span> â€œa fewâ€;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="string">"lots"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="comment">// Cognitive Complexity 1</span></span><br></pre></td></tr></table></figure>
<p>è®¤çŸ¥å¤æ‚åº¦ç®—æ³•ä¸ºè¿™ä¸¤ç§æ–¹æ³•ç»™å‡ºäº†æ˜æ˜¾ä¸åŒçš„åˆ†æ•°ï¼Œè¿™äº›åˆ†æ•°æ›´èƒ½åæ˜ å®ƒä»¬çš„ç›¸å¯¹å¯ç†è§£æ€§ã€‚</p>
<h3 id="é«˜äºæ–¹æ³•çº§åˆ«çš„æœ‰ä»·å€¼çš„æŒ‡æ ‡ï¼ˆMetrics-that-are-valuable-above-the-method-levelï¼‰"><a href="#é«˜äºæ–¹æ³•çº§åˆ«çš„æœ‰ä»·å€¼çš„æŒ‡æ ‡ï¼ˆMetrics-that-are-valuable-above-the-method-levelï¼‰" class="headerlink" title="é«˜äºæ–¹æ³•çº§åˆ«çš„æœ‰ä»·å€¼çš„æŒ‡æ ‡ï¼ˆMetrics that are valuable above the method levelï¼‰"></a>é«˜äºæ–¹æ³•çº§åˆ«çš„æœ‰ä»·å€¼çš„æŒ‡æ ‡ï¼ˆMetrics that are valuable above the method levelï¼‰</h3><p>æ­¤å¤–ï¼Œç”±äºè®¤çŸ¥å¤æ‚åº¦ä¸ä¼šå› æ–¹æ³•ç»“æ„è€Œå¢åŠ ï¼Œå› æ­¤èšåˆæ•°å­—å˜å¾—æœ‰ç”¨ã€‚ç°åœ¨ï¼Œæ‚¨å¯ä»¥é€šè¿‡ç®€å•åœ°æ¯”è¾ƒå®ƒä»¬çš„åº¦é‡å€¼æ¥åŒºåˆ†åŸŸç±»ï¼ˆå…·æœ‰å¤§é‡ç®€å•çš„<code>getter</code>å’Œ<code>setter</code>çš„ç±»ï¼‰å’ŒåŒ…å«å¤æ‚æ§åˆ¶æµçš„ç±»ä¹‹é—´çš„åŒºåˆ«ã€‚å› æ­¤ï¼Œè®¤çŸ¥å¤æ‚åº¦æˆä¸ºè¡¡é‡ç±»å’Œåº”ç”¨ç¨‹åºç›¸å¯¹å¯ç†è§£æ€§çš„å·¥å…·ã€‚</p>
<h2 id="æ€»ç»“ï¼ˆConclusionï¼‰"><a href="#æ€»ç»“ï¼ˆConclusionï¼‰" class="headerlink" title="æ€»ç»“ï¼ˆConclusionï¼‰"></a>æ€»ç»“ï¼ˆConclusionï¼‰</h2><p>ç¼–å†™å’Œç»´æŠ¤ä»£ç çš„è¿‡ç¨‹æ˜¯äººå·¥è¿‡ç¨‹ã€‚å®ƒä»¬çš„è¾“å‡ºå¿…é¡»ç¬¦åˆæ•°å­¦æ¨¡å‹ï¼Œä½†å®ƒä»¬æœ¬èº«å¹¶ä¸é€‚åˆæ•°å­¦æ¨¡å‹ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæ•°å­¦æ¨¡å‹ä¸è¶³ä»¥è¯„ä¼°å®ƒä»¬æ‰€éœ€çš„åŠªåŠ›ã€‚</p>
<p>è®¤çŸ¥å¤æ‚åº¦æ‰“ç ´äº†ä½¿ç”¨æ•°å­¦æ¨¡å‹æ¥è¯„ä¼°è½¯ä»¶å¯ç»´æŠ¤æ€§çš„åšæ³•ã€‚å®ƒä»<strong>åœˆå¤æ‚åº¦</strong>è®¾å®šçš„å…ˆä¾‹å¼€å§‹ï¼Œä½†ä½¿ç”¨äººç±»åˆ¤æ–­æ¥è¯„ä¼°åº”è¯¥å¦‚ä½•è®¡ç®—ç»“æ„ï¼Œå¹¶å†³å®šåº”è¯¥å°†ä»€ä¹ˆæ·»åŠ åˆ°æ•´ä¸ªæ¨¡å‹ä¸­ã€‚å› æ­¤ï¼Œå®ƒäº§ç”Ÿçš„æ–¹æ³•å¤æ‚æ€§åˆ†æ•°è®©ç¨‹åºå‘˜è§‰å¾—æ¯”ä»¥å‰çš„æ¨¡å‹æ›´å…¬å¹³çš„å¯ç†è§£æ€§ç›¸å¯¹è¯„ä¼°ã€‚æ­¤å¤–ï¼Œç”±äºè®¤çŸ¥å¤æ‚åº¦ä¸æ”¶å–æ–¹æ³•çš„â€œå…¥é—¨æˆæœ¬â€ï¼Œå› æ­¤å®ƒä¸ä»…åœ¨æ–¹æ³•çº§åˆ«ï¼Œè€Œä¸”åœ¨ç±»å’Œåº”ç”¨ç¨‹åºçº§åˆ«éƒ½ä¼šäº§ç”Ÿæ›´å…¬å¹³çš„ç›¸å¯¹è¯„ä¼°ã€‚</p>
<blockquote>
<p>[1] Thomas J. McCabe, â€œA Complexity Measureâ€, IEEE Transactions on Software Engineering, Vol. SE-2, No. 4, December 1976</p>
</blockquote>
<h2 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h2><p>ä¸€ä¸ª YUI çš„ js ç¤ºä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">save: <span class="function"><span class="keyword">function</span> (<span class="params">options, callback</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> self = <span class="keyword">this</span>;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> options === <span class="string">'function'</span>) &#123;  <span class="comment">// +1</span></span><br><span class="line">    callback = options;</span><br><span class="line">    options = &#123;&#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  options || (options = &#123;&#125;); <span class="comment">// +1</span></span><br><span class="line">  self._validate(self.toJSON(), <span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123; <span class="comment">// +2 (nesting = 1)</span></span><br><span class="line">      callback &amp;&amp; callback.call(<span class="literal">null</span>, err); <span class="comment">// +1</span></span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    self.sync(</span><br><span class="line">      self.isNew() ? <span class="string">'create'</span> : <span class="string">'update'</span>, <span class="comment">// +2 (nesting = 1)</span></span><br><span class="line">      options,</span><br><span class="line">      <span class="function"><span class="keyword">function</span> (<span class="params">err, response</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> facade = &#123;</span><br><span class="line">            options: options,</span><br><span class="line">            response: response,</span><br><span class="line">          &#125;,</span><br><span class="line">          parsed;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123; <span class="comment">// +3 (nesting = 2)</span></span><br><span class="line">          facade.error = err;</span><br><span class="line">          facade.src = <span class="string">'save'</span>;</span><br><span class="line">          self.fire(EVT_ERROR, facade);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; <span class="comment">// +1</span></span><br><span class="line">          <span class="keyword">if</span> (!self._saveEvent) &#123; <span class="comment">// +4 (nesting = 3)</span></span><br><span class="line">            self._saveEvent = self.publish(EVT_SAVE, &#123;</span><br><span class="line">              preventable: <span class="literal">false</span>,</span><br><span class="line">            &#125;);</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span> (response) &#123; <span class="comment">// +4 (nesting = 3)</span></span><br><span class="line">            parsed = facade.parsed = self._parse(response);</span><br><span class="line">            self.setAttrs(parsed, options);</span><br><span class="line">          &#125;</span><br><span class="line">          self.changed = &#123;&#125;;</span><br><span class="line">          self.fire(EVT_SAVE, facade);</span><br><span class="line">        &#125;</span><br><span class="line">        callback &amp;&amp; callback.apply(<span class="literal">null</span>, <span class="built_in">arguments</span>); <span class="comment">// +1</span></span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> self;</span><br><span class="line">&#125; <span class="comment">// total complexity = 20</span></span><br></pre></td></tr></table></figure>
<h2 id="é™„å½•-Aï¼šCompensating-Usages"><a href="#é™„å½•-Aï¼šCompensating-Usages" class="headerlink" title="é™„å½• Aï¼šCompensating Usages"></a>é™„å½• Aï¼šCompensating Usages</h2><blockquote>
<p>todoâ€¦</p>
</blockquote>
<h2 id="é™„å½•-Bï¼šSpecificationï¼ˆæ ‡å‡†ï¼‰"><a href="#é™„å½•-Bï¼šSpecificationï¼ˆæ ‡å‡†ï¼‰" class="headerlink" title="é™„å½• Bï¼šSpecificationï¼ˆæ ‡å‡†ï¼‰"></a>é™„å½• Bï¼šSpecificationï¼ˆæ ‡å‡†ï¼‰</h2><p>æœ¬èŠ‚çš„ç›®çš„æ˜¯ç®€è¦åˆ—ä¸¾å¢åŠ è®¤çŸ¥å¤æ‚åº¦çš„ç»“æ„å’Œæƒ…å†µï¼Œä½†é™„å½• A ä¸­åˆ—å‡ºçš„ä¾‹å¤–æƒ…å†µé™¤å¤–ã€‚è¿™æ˜¯ä¸€ä¸ªå…¨é¢çš„åˆ—è¡¨ï¼Œè€Œä¸æ˜¯è¯¦å°½æ— é—çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä¸€ç§è¯­è¨€å¯¹å…³é”®å­—æœ‰ä¸€ä¸ªéå…¸å‹çš„æ‹¼å†™ï¼Œä¾‹å¦‚<code>elif</code>å’Œ<code>else if</code>ï¼Œè¿™é‡Œçš„çœç•¥å¹¶ä¸æ˜¯ä¸ºäº†ä»è§„èŒƒä¸­çœç•¥å®ƒã€‚</p>
<h3 id="B1-å¢é‡"><a href="#B1-å¢é‡" class="headerlink" title="B1. å¢é‡"></a>B1. å¢é‡</h3><p>ä»¥ä¸‹å„é¡¹éƒ½æœ‰ä¸€ä¸ªå¢é‡ï¼š</p>
<ul>
<li><code>if</code>, <code>else if</code>, <code>else</code>, <code>ä¸‰å…ƒè¿ç®—ç¬¦</code></li>
<li><code>switch</code></li>
<li><code>for</code>, <code>foreach</code></li>
<li><code>while</code>, <code>do while</code></li>
<li><code>catch</code></li>
<li><code>goto LABEL</code>, <code>break LABEL</code>, <code>continue LABEL</code>, <code>break NUMBER</code>, <code>continue NUMBER</code></li>
<li>äºŒå…ƒé€»è¾‘è¿ç®—ç¬¦åºåˆ—ï¼ˆsequences of binary logical operatorsï¼‰</li>
<li>é€’å½’å¾ªç¯ä¸­çš„æ¯ä¸ªæ–¹æ³•ï¼ˆeach method in a recursion cycleï¼‰</li>
</ul>
<h3 id="B2-åµŒå¥—çº§åˆ«"><a href="#B2-åµŒå¥—çº§åˆ«" class="headerlink" title="B2. åµŒå¥—çº§åˆ«"></a>B2. åµŒå¥—çº§åˆ«</h3><p>ä»¥ä¸‹ç»“æ„å¢åŠ åµŒå¥—çº§åˆ«ï¼š</p>
<ul>
<li><code>if</code>, <code>else if</code>, <code>else</code>, <code>ä¸‰å…ƒè¿ç®—ç¬¦</code></li>
<li><code>switch</code></li>
<li><code>for</code>, <code>foreach</code></li>
<li><code>while</code>, <code>do while</code></li>
<li><code>catch</code></li>
<li>åµŒå¥—æ–¹æ³•å’Œç±»ä¼¼æ–¹æ³•çš„ç»“æ„ï¼Œä¾‹å¦‚<code>lambda</code>ï¼ˆnested methods and method-like structures such as lambdasï¼‰</li>
</ul>
<h3 id="B3-åµŒå¥—å¢é‡"><a href="#B3-åµŒå¥—å¢é‡" class="headerlink" title="B3. åµŒå¥—å¢é‡"></a>B3. åµŒå¥—å¢é‡</h3><p>ä»¥ä¸‹ç»“æ„æ¥æ”¶ä¸å®ƒä»¬åœ¨ B2 ç»“æ„å†…çš„åµŒå¥—æ·±åº¦ç›¸ç§°çš„åµŒå¥—å¢é‡ï¼š</p>
<ul>
<li><code>if</code>, <code>ä¸‰å…ƒè¿ç®—ç¬¦</code></li>
<li><code>switch</code></li>
<li><code>for</code>, <code>foreach</code></li>
<li><code>while</code>, <code>do while</code></li>
<li><code>catch</code></li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://cleam.github.io/2021/09/10/Gitlab-CI-CDä¹‹-gitlab-ci-ymlå¤ç”¨ç±»é…ç½®/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Cleam Lee">
      <meta itemprop="description" content="å‰ç«¯ç”Ÿæ¶¯è®°å½•æ€»ç»“">
      <meta itemprop="image" content="/uploads/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è€æ">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2021/09/10/Gitlab-CI-CDä¹‹-gitlab-ci-ymlå¤ç”¨ç±»é…ç½®/" class="post-title-link" itemprop="https://cleam.github.io/index.html">Gitlab CI/CDä¹‹.gitlab-ci.ymlå¤ç”¨ç±»é…ç½®</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              
                
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-09-10 16:56:44" itemprop="dateCreated datePublished" datetime="2021-09-10T16:56:44+08:00">2021-09-10</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">æ›´æ–°äº</span>
                
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-09-28 20:13:21" itemprop="dateModified" datetime="2021-09-28T20:13:21+08:00">2021-09-28</time>
              
            
          </span>

          

          
            
              <span class="post-comments-count">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              
                <a href="/2021/09/10/Gitlab-CI-CDä¹‹-gitlab-ci-ymlå¤ç”¨ç±»é…ç½®/#SOHUCS" itemprop="discussionUrl">
                  <span class="post-meta-item-text">è¯„è®ºæ•°ï¼š</span> <span id="url::https://cleam.github.io/2021/09/10/Gitlab-CI-CDä¹‹-gitlab-ci-ymlå¤ç”¨ç±»é…ç½®/" class="cy_cmt_count" data-xid="2021/09/10/Gitlab-CI-CDä¹‹-gitlab-ci-ymlå¤ç”¨ç±»é…ç½®/" itemprop="commentsCount"></span>
                </a>
              
            
          

          
          

          

          

          

        </span></div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>å¤ç”¨ç±»é…ç½®ï¼š</p>
<h2 id="é”šç‚¹-Anchors"><a href="#é”šç‚¹-Anchors" class="headerlink" title="é”šç‚¹ Anchors"></a>é”šç‚¹ Anchors</h2><p>YAML æœ‰ä¸€é¡¹åä¸ºâ€œé”šç‚¹â€çš„åŠŸèƒ½ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å®ƒåœ¨æ•´ä¸ªæ–‡æ¡£ä¸­å¤åˆ¶å†…å®¹ã€‚</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">cache:</span> <span class="meta">&amp;global_cache</span> <span class="comment"># å®šä¹‰ä¸€ä¸ªå…¨å±€ç¼“å­˜çš„é”šç‚¹ï¼šglobal_cache</span></span><br><span class="line"><span class="attr">  untracked:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">  key:</span> <span class="string">$CI_COMMIT_REF_SLUG</span></span><br><span class="line"><span class="attr">  paths:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">node_modules/</span></span><br><span class="line"><span class="attr">  policy:</span> <span class="string">pull-push</span></span><br><span class="line"></span><br><span class="line"><span class="attr">install:</span></span><br><span class="line"><span class="attr">  cache:</span></span><br><span class="line">    <span class="string">&lt;&lt;:</span> <span class="meta">*global_cache</span> <span class="comment"># å°†global_cacheåˆå¹¶åˆ°å½“å‰é…ç½®ä¸­</span></span><br><span class="line"><span class="attr">    policy:</span> <span class="string">push</span></span><br><span class="line"></span><br><span class="line"><span class="attr">lint:</span></span><br><span class="line"><span class="attr">  cache:</span></span><br><span class="line">    <span class="string">&lt;&lt;:</span> <span class="meta">*global_cache</span> <span class="comment"># å°†global_cacheåˆå¹¶åˆ°å½“å‰é…ç½®ä¸­</span></span><br></pre></td></tr></table></figure>
<p><code>&amp;</code>è®¾ç½®é”šç‚¹çš„åç§° (global_cache)ï¼Œ<code>&lt;&lt;</code>æ„æ€æ˜¯â€œå°†ç»™å®šçš„å“ˆå¸Œå¯¹è±¡åˆå¹¶åˆ°å½“å‰å“ˆå¸Œå¯¹è±¡ä¸­â€ï¼Œ<code>*</code>åŒ…å«å‘½åé”šç‚¹ï¼ˆå¦‚ï¼š<code>global_cache</code>ï¼‰ã€‚</p>
<p>è¿™ä¸ªä¾‹å­çš„ç»“æœæ˜¯ï¼š</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">cache:</span> <span class="meta">&amp;global_cache</span> <span class="comment"># å®šä¹‰ä¸€ä¸ªå…¨å±€ç¼“å­˜çš„é”šç‚¹ï¼šglobal_cache</span></span><br><span class="line"><span class="attr">  untracked:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">  key:</span> <span class="string">$CI_COMMIT_REF_SLUG</span></span><br><span class="line"><span class="attr">  paths:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">node_modules/</span></span><br><span class="line"><span class="attr">  policy:</span> <span class="string">pull-push</span></span><br><span class="line"></span><br><span class="line"><span class="attr">install:</span></span><br><span class="line"><span class="attr">  cache:</span></span><br><span class="line"><span class="attr">    untracked:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">  key:</span> <span class="string">$CI_COMMIT_REF_SLUG</span></span><br><span class="line"><span class="attr">  paths:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">node_modules/</span></span><br><span class="line"><span class="attr">  policy:</span> <span class="string">push</span></span><br><span class="line"></span><br><span class="line"><span class="attr">lint:</span></span><br><span class="line"><span class="attr">  cache:</span></span><br><span class="line"><span class="attr">    untracked:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">    key:</span> <span class="string">$CI_COMMIT_REF_SLUG</span></span><br><span class="line"><span class="attr">    paths:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">node_modules/</span></span><br><span class="line"><span class="attr">    policy:</span> <span class="string">pull-push</span></span><br></pre></td></tr></table></figure>
<p>ä½ è¿˜å¯ä»¥ä½¿ç”¨é”šç‚¹æ¥å®šä¹‰ä¸¤ä¸ªæœåŠ¡é›†åˆã€‚ä¾‹å¦‚ä»¥ä¸‹ç¤ºä¾‹ï¼ˆ<code>test:postgres</code>å’Œ<code>test:mysql</code>å…±äº«äº†<code>.job_template</code>çš„<code>script</code>ï¼Œä½†æ˜¯å´æœ‰è¿™ä¸åŒçš„<code>services</code>ï¼Œåˆ†åˆ«å®šä¹‰åœ¨äº†<code>.postgres_services</code>å’Œ<code>.mysql_services</code>ä¸­ï¼‰ï¼šã€‚</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">.job_template:</span> <span class="meta">&amp;job_configuration</span></span><br><span class="line"><span class="attr">  script:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">test</span> <span class="string">project</span></span><br><span class="line"><span class="attr">  tags:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">dev</span></span><br><span class="line"></span><br><span class="line"><span class="string">.postgres_services:</span></span><br><span class="line"><span class="attr">  services:</span> <span class="meta">&amp;postgres_configuration</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">postgres</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">ruby</span></span><br><span class="line"></span><br><span class="line"><span class="string">.mysql_services:</span></span><br><span class="line"><span class="attr">  services:</span> <span class="meta">&amp;mysql_configuration</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">mysql</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">ruby</span></span><br><span class="line"></span><br><span class="line"><span class="attr">test:</span><span class="attr">postgres:</span></span><br><span class="line">  <span class="string">&lt;&lt;:</span> <span class="meta">*job_configuration</span></span><br><span class="line"><span class="attr">  services:</span> <span class="meta">*postgres_configuration</span></span><br><span class="line"><span class="attr">  tags:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">postgres</span></span><br><span class="line"></span><br><span class="line"><span class="attr">test:</span><span class="attr">mysql:</span></span><br><span class="line">  <span class="string">&lt;&lt;:</span> <span class="meta">*job_configuration</span></span><br><span class="line"><span class="attr">  services:</span> <span class="meta">*mysql_configuration</span></span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°çš„ç»“æœå°†æ˜¯è¿™æ ·çš„ï¼š</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">.job_template:</span></span><br><span class="line"><span class="attr">  script:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">test</span> <span class="string">project</span></span><br><span class="line"><span class="attr">  tags:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">dev</span></span><br><span class="line"></span><br><span class="line"><span class="string">.postgres_services:</span></span><br><span class="line"><span class="attr">  services:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">postgres</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">ruby</span></span><br><span class="line"></span><br><span class="line"><span class="string">.mysql_services:</span></span><br><span class="line"><span class="attr">  services:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">mysql</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">ruby</span></span><br><span class="line"></span><br><span class="line"><span class="attr">test:</span><span class="attr">postgres:</span></span><br><span class="line"><span class="attr">  script:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">test</span> <span class="string">project</span></span><br><span class="line"><span class="attr">  services:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">postgres</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">ruby</span></span><br><span class="line"><span class="attr">  tags:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">postgres</span></span><br><span class="line"></span><br><span class="line"><span class="attr">test:</span><span class="attr">mysql:</span></span><br><span class="line"><span class="attr">  script:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">test</span> <span class="string">project</span></span><br><span class="line"><span class="attr">  services:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">mysql</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">ruby</span></span><br><span class="line"><span class="attr">  tags:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">dev</span></span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°éšè—çš„ä½œä¸šè¢«æ–¹ä¾¿åœ°ç”¨ä½œæ¨¡æ¿ï¼Œå¹¶ä¸”<code>tags: [postgres]</code> è¦†ç›–äº†<code>tags: [dev]</code>ã€‚</p>
<p><strong>æ›´å¤šé”šç‚¹çš„ä½¿ç”¨ç¤ºä¾‹</strong>ï¼š</p>
<ol>
<li>YAML é”šç‚¹ç”¨äºè„šæœ¬ï¼ˆscriptï¼‰ä¸­ï¼š</li>
</ol>
<p>æ‚¨å¯ä»¥å°† YAML é”šç‚¹ä¸ <code>script</code>ã€<code>before_script</code> å’Œ <code>after_script</code> ç»“åˆä½¿ç”¨ï¼Œä»¥ä¾¿åœ¨å¤šä¸ªä½œä¸šä¸­ä½¿ç”¨é¢„å®šä¹‰çš„å‘½ä»¤ï¼š</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">.some-script-before:</span> <span class="string">&amp;some-script-before</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">echo</span> <span class="string">"Execute this script first"</span></span><br><span class="line"></span><br><span class="line"><span class="string">.some-script:</span> <span class="string">&amp;some-script</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">echo</span> <span class="string">"Execute this script second"</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">echo</span> <span class="string">"Execute this script too"</span></span><br><span class="line"></span><br><span class="line"><span class="string">.some-script-after:</span> <span class="string">&amp;some-script-after</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">echo</span> <span class="string">"Execute this script last"</span></span><br><span class="line"></span><br><span class="line"><span class="attr">job1:</span></span><br><span class="line"><span class="attr">  before_script:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">*some-script-before</span></span><br><span class="line"><span class="attr">  script:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">*some-script</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">echo</span> <span class="string">"Execute something, for this job only"</span></span><br><span class="line"><span class="attr">  after_script:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">*some-script-after</span></span><br><span class="line"></span><br><span class="line"><span class="attr">job2:</span></span><br><span class="line"><span class="attr">  script:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">*some-script-before</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">*some-script</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">echo</span> <span class="string">"Execute something else, for this job only"</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">*some-script-after</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>YAML é”šç‚¹ç”¨äºç”¨äºå˜é‡ï¼ˆvariablesï¼‰ä¸­ï¼š</li>
</ol>
<p>ä½¿ç”¨å¸¦æœ‰å˜é‡çš„ YAML é”šç‚¹åœ¨å¤šä¸ªä½œä¸šä¸­é‡å¤åˆ†é…å˜é‡ã€‚å½“ä½œä¸šéœ€è¦ç‰¹å®šçš„å˜é‡å—æ—¶ï¼Œæ‚¨è¿˜å¯ä»¥ä½¿ç”¨ YAML é”šç‚¹ï¼Œå¦åˆ™ä¼š<strong>è¦†ç›–å…¨å±€å˜é‡</strong>ã€‚ä»¥ä¸‹ç¤ºä¾‹æ˜¾ç¤ºå¦‚ä½•è¦†ç›– <code>GIT_STRATEGY</code> å˜é‡è€Œä¸å½±å“ <code>SAMPLE_VARIABLE</code> å˜é‡çš„ä½¿ç”¨ï¼š</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># global variables</span></span><br><span class="line"><span class="attr">variables:</span> <span class="string">&amp;global-variables</span></span><br><span class="line"><span class="attr">  SAMPLE_VARIABLE:</span> <span class="string">sample_variable_value</span></span><br><span class="line"><span class="attr">  ANOTHER_SAMPLE_VARIABLE:</span> <span class="string">another_sample_variable_value</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># a job that must set the GIT_STRATEGY variable, yet depend on global variables</span></span><br><span class="line"><span class="attr">job_no_git_strategy:</span></span><br><span class="line"><span class="attr">  stage:</span> <span class="string">cleanup</span></span><br><span class="line"><span class="attr">  variables:</span></span><br><span class="line">    <span class="string">&lt;&lt;:</span> <span class="string">*global-variables</span></span><br><span class="line"><span class="attr">    GIT_STRATEGY:</span> <span class="string">none</span></span><br><span class="line"><span class="attr">  script:</span> <span class="string">echo</span> <span class="string">$SAMPLE_VARIABLE</span></span><br></pre></td></tr></table></figure>
<h2 id="å¼•ç”¨-reference"><a href="#å¼•ç”¨-reference" class="headerlink" title="å¼•ç”¨ !reference"></a>å¼•ç”¨ !reference</h2><p>ä½¿ç”¨ <code>!reference</code> è‡ªå®šä¹‰ YAML æ ‡ç­¾ä»å…¶ä»–ä½œä¸šéƒ¨åˆ†é€‰æ‹©å…³é”®å­—é…ç½®ï¼Œå¹¶åœ¨å½“å‰éƒ¨åˆ†ä¸­å¤ç”¨å®ƒã€‚ä¸é”šç‚¹ä¸åŒï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ <code>!reference</code> æ ‡ç­¾æ¥å¤ç”¨é€šè¿‡<code>include</code>å¼•ç”¨çš„é…ç½®æ–‡ä»¶ä¸­çš„é…ç½®ã€‚</p>
<p>åœ¨ä»¥ä¸‹ç¤ºä¾‹ä¸­ï¼Œ<code>test</code>ä½œä¸šä¸­é‡å¤ä½¿ç”¨äº†æ¥è‡ªä¸¤ä¸ªä¸åŒä½ç½®çš„<code>script</code>å’Œ<code>after_script</code>ï¼š</p>
<ul>
<li><code>setup.yml</code>:</li>
</ul>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">.setup:</span></span><br><span class="line"><span class="attr">  script:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">echo</span> <span class="string">creating</span> <span class="string">environment</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>.gitlab-ci.yml</code>:</li>
</ul>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">include:</span></span><br><span class="line"><span class="attr">  - local:</span> <span class="string">setup.yml</span></span><br><span class="line"></span><br><span class="line"><span class="string">.teardown:</span></span><br><span class="line"><span class="attr">  after_script:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">echo</span> <span class="string">deleting</span> <span class="string">environment</span></span><br><span class="line"></span><br><span class="line"><span class="attr">test:</span></span><br><span class="line"><span class="attr">  script:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="type">!reference</span> <span class="string">[.setup,</span> <span class="string">script]</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">echo</span> <span class="string">running</span> <span class="string">my</span> <span class="string">own</span> <span class="string">command</span></span><br><span class="line"><span class="attr">  after_script:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="type">!reference</span> <span class="string">[.teardown,</span> <span class="string">after_script]</span></span><br></pre></td></tr></table></figure>
<p>åœ¨ä»¥ä¸‹ç¤ºä¾‹ä¸­ï¼Œ<code>test-vars-1</code> å¤ç”¨ <code>.vars</code> ä¸­çš„æ‰€æœ‰å˜é‡ï¼Œè€Œ <code>test-vars-2</code> é€‰æ‹©ç‰¹å®šå˜é‡å¹¶å°†å…¶å¤ç”¨ä¸ºæ–°çš„ <code>MY_VAR</code> å˜é‡ã€‚</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">.vars:</span></span><br><span class="line"><span class="attr">  variables:</span></span><br><span class="line"><span class="attr">    URL:</span> <span class="string">'http://my-url.internal'</span></span><br><span class="line"><span class="attr">    IMPORTANT_VAR:</span> <span class="string">'the details'</span></span><br><span class="line"></span><br><span class="line"><span class="attr">test-vars-1:</span></span><br><span class="line"><span class="attr">  variables:</span> <span class="type">!reference</span> <span class="string">[.vars,</span> <span class="string">variables]</span></span><br><span class="line"><span class="attr">  script:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">printenv</span></span><br><span class="line"></span><br><span class="line"><span class="attr">test-vars-2:</span></span><br><span class="line"><span class="attr">  variables:</span></span><br><span class="line"><span class="attr">    MY_VAR:</span> <span class="type">!reference</span> <span class="string">[.vars,</span> <span class="string">variables,</span> <span class="string">IMPORTANT_VAR]</span></span><br><span class="line"><span class="attr">  script:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">printenv</span></span><br></pre></td></tr></table></figure>
<p>æ‚¨ä¸èƒ½é‡å¤ä½¿ç”¨å·²ç»åŒ…å« <code>!reference</code> æ ‡ç­¾çš„éƒ¨åˆ†ã€‚ä»…æ”¯æŒä¸€å±‚åµŒå¥—ã€‚</p>
<h2 id="ç»§æ‰¿-extend"><a href="#ç»§æ‰¿-extend" class="headerlink" title="ç»§æ‰¿ extend"></a>ç»§æ‰¿ extend</h2><p>ä½¿ç”¨<code>extends</code>æ¥å¤ç”¨é…ç½®å—ã€‚å®ƒæ˜¯é”šç‚¹ï¼ˆAnchorï¼‰çš„æ›¿ä»£å“ï¼Œå¹¶ä¸”æ›´åŠ çµæ´»å’Œå¯è¯»ã€‚æ‚¨å¯ä»¥ä½¿ç”¨<code>extends</code>æ¥å¤ç”¨é€šè¿‡<code>include</code>å¼•ç”¨çš„é…ç½®æ–‡ä»¶ä¸­çš„é…ç½®ã€‚</p>
<p>åœ¨ä»¥ä¸‹ç¤ºä¾‹ä¸­ï¼Œ<code>rspec</code> ä½œä¸šä½¿ç”¨ <code>.tests</code> æ¨¡æ¿ä½œä¸šä¸­çš„é…ç½®ã€‚GitLabï¼š</p>
<ul>
<li>æ ¹æ®é”®æ‰§è¡Œåå‘æ·±åº¦åˆå¹¶ã€‚</li>
<li>å°† <code>.tests</code> å†…å®¹ä¸ <code>rspec</code> ä½œä¸šåˆå¹¶ã€‚</li>
<li>ä¸åˆå¹¶é”®çš„å€¼ã€‚</li>
</ul>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">.tests:</span></span><br><span class="line"><span class="attr">  script:</span> <span class="string">rake</span> <span class="string">test</span></span><br><span class="line"><span class="attr">  stage:</span> <span class="string">test</span></span><br><span class="line"><span class="attr">  only:</span></span><br><span class="line"><span class="attr">    refs:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">branches</span></span><br><span class="line"></span><br><span class="line"><span class="attr">rspec:</span></span><br><span class="line"><span class="attr">  extends:</span> <span class="string">.tests</span></span><br><span class="line"><span class="attr">  script:</span> <span class="string">rake</span> <span class="string">rspec</span></span><br><span class="line"><span class="attr">  only:</span></span><br><span class="line"><span class="attr">    variables:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">$RSPEC</span></span><br></pre></td></tr></table></figure>
<p><code>rspec</code>ä½œä¸šçš„ç»“æœæ˜¯ï¼š</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">rspec:</span></span><br><span class="line"><span class="attr">  script:</span> <span class="string">rake</span> <span class="string">rspec</span></span><br><span class="line"><span class="attr">  stage:</span> <span class="string">test</span></span><br><span class="line"><span class="attr">  only:</span></span><br><span class="line"><span class="attr">    refs:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">branches</span></span><br><span class="line"><span class="attr">    variables:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">$RSPEC</span></span><br></pre></td></tr></table></figure>
<p>æœ¬ä¾‹ä¸­çš„ <code>.tests</code> æ˜¯ä¸€ä¸ª<a href="https://docs.gitlab.com/ee/ci/yaml/#hide-jobs" target="_blank" rel="noopener">éšè—ä½œä¸š</a>ï¼Œä½†ä¹Ÿå¯ä»¥ä»å¸¸è§„ä½œä¸šä¸­<code>extends</code>é…ç½®ã€‚</p>
<p><code>extends</code> æ”¯æŒå¤šçº§ç»§æ‰¿ã€‚ è™½ç„¶æ‚¨å¯ä»¥ä½¿ç”¨å¤šè¾¾ 11 ä¸ªçº§åˆ«ï¼Œä½†æ˜¯æ‚¨åº”è¯¥é¿å…ä½¿ç”¨ 3 ä¸ªä»¥ä¸Šçš„çº§åˆ«ã€‚ä»¥ä¸‹ç¤ºä¾‹å…·æœ‰ä¸¤ä¸ªç»§æ‰¿çº§åˆ«ï¼š</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">.tests:</span></span><br><span class="line"><span class="attr">  rules:</span></span><br><span class="line"><span class="attr">    - if:</span> <span class="string">$CI_PIPELINE_SOURCE</span> <span class="string">==</span> <span class="string">"push"</span></span><br><span class="line"></span><br><span class="line"><span class="string">.rspec:</span></span><br><span class="line"><span class="attr">  extends:</span> <span class="string">.tests</span></span><br><span class="line"><span class="attr">  script:</span> <span class="string">rake</span> <span class="string">rspec</span></span><br><span class="line"></span><br><span class="line"><span class="string">rspec</span> <span class="number">1</span><span class="string">:</span></span><br><span class="line"><span class="attr">  variables:</span></span><br><span class="line"><span class="attr">    RSPEC_SUITE:</span> <span class="string">'1'</span></span><br><span class="line"><span class="attr">  extends:</span> <span class="string">.rspec</span></span><br><span class="line"></span><br><span class="line"><span class="string">rspec</span> <span class="number">2</span><span class="string">:</span></span><br><span class="line"><span class="attr">  variables:</span></span><br><span class="line"><span class="attr">    RSPEC_SUITE:</span> <span class="string">'2'</span></span><br><span class="line"><span class="attr">  extends:</span> <span class="string">.rspec</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spinach:</span></span><br><span class="line"><span class="attr">  extends:</span> <span class="string">.tests</span></span><br><span class="line"><span class="attr">  script:</span> <span class="string">rake</span> <span class="string">spinach</span></span><br></pre></td></tr></table></figure>
<p>åœ¨ GitLab 12.0 åŠæ›´é«˜ç‰ˆæœ¬ä¸­ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å¤šä¸ªçˆ¶é¡¹è¿›è¡Œæ‰©å±•ï¼ˆextendsï¼‰ã€‚</p>
<p>æ‚¨å¯ä»¥ç”¨<code>extends</code>æ¥åˆå¹¶å“ˆå¸Œå¯¹è±¡ä½†æ˜¯ä¸èƒ½ç”¨æ¥åˆå¹¶æ•°ç»„ã€‚ç”¨äºåˆå¹¶çš„ç®—æ³•æ˜¯â€œå°±è¿‘ä¼˜å…ˆåŸåˆ™ï¼ˆclosest scope winsï¼‰â€ï¼Œå› æ­¤æ¥è‡ªæœ€åä¸€ä¸ªæˆå‘˜çš„é”®æ€»æ˜¯è¦†ç›–å…¶ä»–çº§åˆ«ä¸Šå®šä¹‰çš„ä»»ä½•å†…å®¹ã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">.only-important:</span></span><br><span class="line"><span class="attr">  variables:</span></span><br><span class="line"><span class="attr">    URL:</span> <span class="string">'http://my-url.internal'</span></span><br><span class="line"><span class="attr">    IMPORTANT_VAR:</span> <span class="string">'the details'</span></span><br><span class="line"><span class="attr">  rules:</span></span><br><span class="line"><span class="attr">    - if:</span> <span class="string">$CI_COMMIT_BRANCH</span> <span class="string">==</span> <span class="string">$CI_DEFAULT_BRANCH</span></span><br><span class="line"><span class="attr">    - if:</span> <span class="string">$CI_COMMIT_BRANCH</span> <span class="string">==</span> <span class="string">"stable"</span></span><br><span class="line"><span class="attr">  tags:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">production</span></span><br><span class="line"><span class="attr">  script:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">echo</span> <span class="string">"Hello world!"</span></span><br><span class="line"></span><br><span class="line"><span class="string">.in-docker:</span></span><br><span class="line"><span class="attr">  variables:</span></span><br><span class="line"><span class="attr">    URL:</span> <span class="string">'http://docker-url.internal'</span></span><br><span class="line"><span class="attr">  tags:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">docker</span></span><br><span class="line"><span class="attr">  image:</span> <span class="string">alpine</span></span><br><span class="line"></span><br><span class="line"><span class="attr">rspec:</span></span><br><span class="line"><span class="attr">  variables:</span></span><br><span class="line"><span class="attr">    GITLAB:</span> <span class="string">'is-awesome'</span></span><br><span class="line"><span class="attr">  extends:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">.only-important</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">.in-docker</span></span><br><span class="line"><span class="attr">  script:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">rake</span> <span class="string">rspec</span></span><br></pre></td></tr></table></figure>
<p>ç»“æœæ˜¯ï¼š</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">rspec:</span></span><br><span class="line"><span class="attr">  variables:</span></span><br><span class="line"><span class="attr">    URL:</span> <span class="string">'http://docker-url.internal'</span></span><br><span class="line"><span class="attr">    IMPORTANT_VAR:</span> <span class="string">'the details'</span></span><br><span class="line"><span class="attr">    GITLAB:</span> <span class="string">'is-awesome'</span></span><br><span class="line"><span class="attr">  rules:</span></span><br><span class="line"><span class="attr">    - if:</span> <span class="string">$CI_COMMIT_BRANCH</span> <span class="string">==</span> <span class="string">$CI_DEFAULT_BRANCH</span></span><br><span class="line"><span class="attr">    - if:</span> <span class="string">$CI_COMMIT_BRANCH</span> <span class="string">==</span> <span class="string">"stable"</span></span><br><span class="line"><span class="attr">  tags:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">docker</span></span><br><span class="line"><span class="attr">  image:</span> <span class="string">alpine</span></span><br><span class="line"><span class="attr">  script:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">rake</span> <span class="string">rspec</span></span><br></pre></td></tr></table></figure>
<p>åœ¨ä¸Šé¢ç¤ºä¾‹ä¸­ï¼š</p>
<ul>
<li><code>variables</code>åˆå¹¶ï¼Œä½† <code>URLï¼š&quot;http://docker-url.internal&quot;</code> è¦†ç›– <code>URLï¼š&quot;http://my-url.internal&quot;</code>ã€‚</li>
<li><code>tagsï¼š[&#39;docker&#39;]</code> è¦†ç›–<code>tagsï¼š[&#39;production&#39;]</code>ã€‚</li>
<li><code>script</code>ä¸ä¼šåˆå¹¶ï¼Œä½† <code>script: [&#39;rake rspec&#39;]</code> ä¼šè¦†ç›– <code>script: [&#39;echo &quot;Hello world!&quot;&#39;]</code>ã€‚ æ‚¨å¯ä»¥ä½¿ç”¨é”šç‚¹æ¥åˆå¹¶æ•°ç»„ã€‚</li>
</ul>
<p><strong><code>extends</code> å’Œ <code>include</code>ä¸€èµ·ä½¿ç”¨</strong>ï¼šè¦å¤ç”¨æ¥è‡ªä¸åŒé…ç½®æ–‡ä»¶çš„é…ç½®ï¼Œè¯·ç»“åˆ<code>extends</code> å’Œ <code>include</code>ã€‚</p>
<p>åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œåœ¨ <code>included.yml</code> æ–‡ä»¶ä¸­å®šä¹‰äº†ä¸€ä¸ªè„šæœ¬<code>script</code>ã€‚ç„¶åï¼Œåœ¨ <code>.gitlab-ci.yml</code> æ–‡ä»¶ä¸­ï¼Œä½¿ç”¨<code>extends</code>ç»§æ‰¿äº†é‚£éƒ¨åˆ†è„šæœ¬å†…å®¹ï¼š</p>
<ul>
<li><code>included.yml</code>:</li>
</ul>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">.template:</span></span><br><span class="line"><span class="attr">  script:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">echo</span> <span class="string">Hello!</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>.gitlab-ci.yml</code>:</li>
</ul>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">include:</span> <span class="string">included.yml</span></span><br><span class="line"></span><br><span class="line"><span class="attr">useTemplate:</span></span><br><span class="line"><span class="attr">  image:</span> <span class="string">alpine</span></span><br><span class="line"><span class="attr">  extends:</span> <span class="string">.template</span></span><br></pre></td></tr></table></figure>
<h2 id="åŒ…å«-include"><a href="#åŒ…å«-include" class="headerlink" title="åŒ…å« include"></a>åŒ…å« include</h2><blockquote>
<p>TODOâ€¦</p>
</blockquote>
<h2 id="æ€»ç»“-amp-æ³¨æ„"><a href="#æ€»ç»“-amp-æ³¨æ„" class="headerlink" title="æ€»ç»“&amp;æ³¨æ„"></a>æ€»ç»“&amp;æ³¨æ„</h2><p>ä½¿ç”¨<code>include</code>å…³é”®å­—æ—¶ï¼Œæ‚¨ä¸èƒ½è·¨å¤šä¸ªæ–‡ä»¶ä½¿ç”¨ YAML é”šç‚¹ã€‚é”šç‚¹åªåœ¨å®šä¹‰å®ƒä»¬çš„æ–‡ä»¶ä¸­æœ‰æ•ˆã€‚è¦å¤ç”¨æ¥è‡ªä¸åŒ YAML æ–‡ä»¶çš„é…ç½®ï¼Œè¯·ä½¿ç”¨<code>å¼•ç”¨ï¼ˆ!referenceï¼‰</code>æˆ–<code>ç»§æ‰¿ï¼ˆextendsï¼‰</code>ã€‚</p>
<blockquote>
<p>è‹±æ–‡åŸæ–‡ï¼š<br>é”šç‚¹ Anchorsï¼š<a href="https://docs.gitlab.com/ee/ci/yaml/#anchors" target="_blank" rel="noopener">https://docs.gitlab.com/ee/ci/yaml/#anchors</a><br>å¼•ç”¨ !referenceï¼š<a href="https://docs.gitlab.com/ee/ci/yaml/#reference-tags" target="_blank" rel="noopener">https://docs.gitlab.com/ee/ci/yaml/#reference-tags</a><br>ç»§æ‰¿ extendï¼š<a href="https://docs.gitlab.com/ee/ci/yaml/#extends" target="_blank" rel="noopener">https://docs.gitlab.com/ee/ci/yaml/#extends</a><br>åŒ…å« includeï¼š<a href="https://docs.gitlab.com/ee/ci/yaml/#include" target="_blank" rel="noopener">https://docs.gitlab.com/ee/ci/yaml/#include</a></p>
</blockquote>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="ä¸‹ä¸€é¡µ"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/uploads/avatar.png" alt="Cleam Lee">
            
              <p class="site-author-name" itemprop="name">Cleam Lee</p>
              <p class="site-description motion-element" itemprop="description">å‰ç«¯ç”Ÿæ¶¯è®°å½•æ€»ç»“</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">29</span>
                    <span class="site-state-item-name">æ—¥å¿—</span>
                  </a>
                </div>
              

              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">18</span>
                    <span class="site-state-item-name">æ ‡ç­¾</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/cleam" title="GitHub &rarr; https://github.com/cleam" rel="noopener" target="_blank"><i class="fa fa-fw fa-globe"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://twitter.com/Cleam_Lee" title="Twitter &rarr; https://twitter.com/Cleam_Lee" rel="noopener" target="_blank"><i class="fa fa-fw fa-globe"></i>Twitter</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://weibo.com/lzg2049" title="å¾®åš &rarr; https://weibo.com/lzg2049" rel="noopener" target="_blank"><i class="fa fa-fw fa-globe"></i>å¾®åš</a>
                </span>
              
            </div>
          

          

          
          

          
            
          
          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2021</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Cleam Lee</span>

  

  
</div>









        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    
	
    

    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.5.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.5.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.5.0"></script>



  



  




  
    <script id="cy_cmt_num" src="https://changyan.sohu.com/upload/plugins/plugins.list.count.js?clientId=cyv4uru5Q"></script>
  







  





  

  

  

  

  

  
  

  

  

  

  

  

  

</body>
</html>
